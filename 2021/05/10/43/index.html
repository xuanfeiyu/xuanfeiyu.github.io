<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="JavaScipt," />










<meta name="description" content="作者：FY引用请标明出处  Part 4 · React 框架原理与实战模块六 · Angular 企业实战开发任务一：Angular 基础1.Angular 框架介绍 Angular 是一个使用 HTML、CSS、TypeScript 构建客户端应用的框架，用来构建单页应用程序。 Angular 是一个重量级的框架，内部集成了大量开箱即用的功能模块。 Angular 为大型应用开发而设计，提供">
<meta property="og:type" content="article">
<meta property="og:title" content="学习笔记 ----- 【React 框架原理与实战】Angular 企业实战开发">
<meta property="og:url" content="http://yoursite.com/2021/05/10/43/index.html">
<meta property="og:site_name" content="旋の飞羽">
<meta property="og:description" content="作者：FY引用请标明出处  Part 4 · React 框架原理与实战模块六 · Angular 企业实战开发任务一：Angular 基础1.Angular 框架介绍 Angular 是一个使用 HTML、CSS、TypeScript 构建客户端应用的框架，用来构建单页应用程序。 Angular 是一个重量级的框架，内部集成了大量开箱即用的功能模块。 Angular 为大型应用开发而设计，提供">
<meta property="og:image" content="http://yoursite.com/2021/05/10/43/images/65.png">
<meta property="og:image" content="http://yoursite.com/2021/05/10/43/images/64.png">
<meta property="og:image" content="http://yoursite.com/2021/05/10/43/images/14.png">
<meta property="og:image" content="http://yoursite.com/2021/05/10/43/images/15.png">
<meta property="og:image" content="http://yoursite.com/2021/05/10/43/images/16.png">
<meta property="og:image" content="http://yoursite.com/2021/05/10/43/images/17.png">
<meta property="og:image" content="http://yoursite.com/2021/05/10/43/images/20.png">
<meta property="og:image" content="http://yoursite.com/2021/05/10/43/images/22.png">
<meta property="og:image" content="http://yoursite.com/2021/05/10/43/images/23.png">
<meta property="og:image" content="http://yoursite.com/2021/05/10/43/images/31.png">
<meta property="article:published_time" content="2021-05-09T16:00:00.000Z">
<meta property="article:modified_time" content="2021-05-12T12:51:26.128Z">
<meta property="article:author" content="FY">
<meta property="article:tag" content="JavaScipt">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2021/05/10/43/images/65.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2021/05/10/43/"/>





  <title>学习笔记 ----- 【React 框架原理与实战】Angular 企业实战开发 | 旋の飞羽</title>
  








<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">旋の飞羽</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">人间值得，未来可期。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/05/10/43/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FY">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="旋の飞羽">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">学习笔记 ----- 【React 框架原理与实战】Angular 企业实战开发</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-10T00:00:00+08:00">
                2021-05-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>作者：FY<br>引用请标明出处</p>
</blockquote>
<h1 id="Part-4-·-React-框架原理与实战"><a href="#Part-4-·-React-框架原理与实战" class="headerlink" title="Part 4 · React 框架原理与实战"></a>Part 4 · React 框架原理与实战</h1><h2 id="模块六-·-Angular-企业实战开发"><a href="#模块六-·-Angular-企业实战开发" class="headerlink" title="模块六 · Angular 企业实战开发"></a>模块六 · Angular 企业实战开发</h2><h2 id="任务一：Angular-基础"><a href="#任务一：Angular-基础" class="headerlink" title="任务一：Angular 基础"></a>任务一：Angular 基础</h2><h3 id="1-Angular-框架介绍"><a href="#1-Angular-框架介绍" class="headerlink" title="1.Angular 框架介绍"></a>1.Angular 框架介绍</h3><ul>
<li>Angular 是一个使用 HTML、CSS、TypeScript 构建客户端应用的框架，用来构建单页应用程序。</li>
<li>Angular 是一个重量级的框架，内部集成了大量开箱即用的功能模块。</li>
<li>Angular 为大型应用开发而设计，提供了干净且松耦合的代码组织方式，使应用程序整洁更易于维护。</li>
</ul>
<h3 id="2-Angular架构-模块"><a href="#2-Angular架构-模块" class="headerlink" title="2.Angular架构-模块"></a>2.Angular架构-模块</h3><p>Angular 应用是由一个个模块组成的，此模块指的不是ESModule，而是 NgModule 即 Angular 模块。</p>
<p>NgModule 是一组相关功能的集合，专注于某个应用领域，可以将组件和一组相关代码关联起来，是应用组织代码结构的一种方式。</p>
<p>在 Angular 应用中至少要有一个根模块，用于启动应用程序。</p>
<p>NgModule 可以从其它 NgModule 中导入功能，前提是目标 NgModule 导出了该功能。</p>
<p>NgModule 是由 NgModule 装饰器函数装饰的类。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BrowserModule &#125; <span class="keyword">from</span> <span class="string">'@angular/platform-browser'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  imports: [</span><br><span class="line">    BrowserModule</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123; &#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-Angular架构-组件"><a href="#3-Angular架构-组件" class="headerlink" title="3.Angular架构-组件"></a>3.Angular架构-组件</h3><p>组件用来描述用户界面，它由三部分组成，组件类、组件模板、组件样式，它们可以被集成在组件类文件中，也可以是三个不同的文件。</p>
<ul>
<li>组件类用来编写和组件直接相关的界面逻辑，在组件类中要关联该组件的组件模板和组件样式。</li>
<li>组件模板用来编写组件的 HTML 结构，通过数据绑定标记将应用中数据和 DOM 进行关联。</li>
<li>组件样式用来编写组件的组件的外观，组件样式可以采用 CSS、LESS、SCSS、Stylus</li>
</ul>
<p>在 Angular 应用中至少要有一个根组件，用于应用程序的启动。</p>
<p>组件类是由 Component 装饰器函数装饰的类。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-root"</span>,</span><br><span class="line">  templateUrl: <span class="string">"./app.component.html"</span>,</span><br><span class="line">  styleUrls: [<span class="string">"./app.component.css"</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  title = <span class="string">"angular-test"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>NgModule 为组件提供了编译的上下文环境。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; AppComponent &#125; <span class="keyword">from</span> <span class="string">'./app.component'</span>;</span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  declarations: [</span><br><span class="line">    AppComponent</span><br><span class="line">  ],</span><br><span class="line">  bootstrap: [AppComponent]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123; &#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-Angular架构-服务"><a href="#4-Angular架构-服务" class="headerlink" title="4.Angular架构-服务"></a>4.Angular架构-服务</h3><ul>
<li>服务用于放置和特定组件无关并希望跨组件共享的数据或逻辑。</li>
<li>服务出现的目的在于解耦组件类中的代码，是组件类中的代码干净整洁。</li>
<li>服务是由 Injectable 装饰器装饰的类。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Injectable &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line">@Injectable(&#123;&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppService</span> </span>&#123; &#125;</span><br></pre></td></tr></table></figure>

<p>在使用服务时不需要在组件类中通过 new 的方式创建服务实例对象获取服务中提供的方法，以下写法错误，切记切记！！！</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; AppService &#125; <span class="keyword">from</span> <span class="string">"./AppService"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> appService = <span class="keyword">new</span> AppService()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务的实例对象由 Angular 框架中内置的依赖注入系统创建和维护。服务是依赖需要被注入到组件中。</p>
<p>在组件中需要通过 constructor 构造函数的参数来获取服务的实例对象。</p>
<p>涉及参数就需要考虑参数的顺序问题，因为在 Angular 应用中会有很多服务，一个组件又不可能会使用到所有服务，如果组件要使用到最后一个服务实例对象，难道要将前面的所有参数都写上吗 ? 这显然不合理。</p>
<p>在组件中获取服务实例对象要结合 TypeScript 类型，写法如下。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; AppService &#125; <span class="keyword">from</span> <span class="string">"./AppService"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span> (</span><br><span class="line">  	private appService: AppService</span><br><span class="line">  ) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Angular 会根据你指定的服务的类型来传递你想要使用的服务实例对象，这样就解决了参数的顺序问题。</p>
<p>在 Angular 中服务被设计为单例模式，这也正是为什么服务可以被用来在组件之间共享数据和逻辑的原因。</p>
<h3 id="5-Angular架构-总结"><a href="#5-Angular架构-总结" class="headerlink" title="5.Angular架构-总结"></a>5.Angular架构-总结</h3><p>略</p>
<h3 id="6-使用AngularCLI创建应用"><a href="#6-使用AngularCLI创建应用" class="headerlink" title="6.使用AngularCLI创建应用"></a>6.使用AngularCLI创建应用</h3><ol>
<li><p>安装 angular-cli：<code>npm install @angular/cli -g</code></p>
</li>
<li><p>创建应用：<code>ng new angular-test --minimal --inlineTemplate false</code></p>
<ol>
<li>–skipGit=true</li>
<li>–minimal=true</li>
<li>–skip-install</li>
<li>–style=css</li>
<li>–routing=false</li>
<li>–inlineTemplate</li>
<li>–inlineStyle</li>
<li>–prefix</li>
</ol>
</li>
<li><p>运行应用：<code>ng serve</code></p>
<ol>
<li>–open=true 应用构建完成后在浏览器中运行</li>
<li>–hmr=true 开启热更新</li>
<li>hmrWarning=false 禁用热更新警告</li>
<li>–port 更改应用运行端口</li>
</ol>
</li>
<li><p>访问应用：<code>localhost:4200</code></p>
</li>
</ol>
<h3 id="7-Angular应用默认代码解析及应用启动过程"><a href="#7-Angular应用默认代码解析及应用启动过程" class="headerlink" title="7.Angular应用默认代码解析及应用启动过程"></a>7.Angular应用默认代码解析及应用启动过程</h3><blockquote>
<p>main.ts</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// enableProdMode 方法调用后将会开启生产模式</span></span><br><span class="line"><span class="keyword">import</span> &#123; enableProdMode &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"><span class="comment">// Angular 应用程序的启动在不同的平台上是不一样的</span></span><br><span class="line"><span class="comment">// 在浏览器中启动时需要用到 platformBrowserDynamic 方法, 该方法返回平台实例对象</span></span><br><span class="line"><span class="keyword">import</span> &#123; platformBrowserDynamic &#125; <span class="keyword">from</span> <span class="string">"@angular/platform-browser-dynamic"</span></span><br><span class="line"><span class="comment">// 引入根模块 用于启动应用程序</span></span><br><span class="line"><span class="keyword">import</span> &#123; AppModule &#125; <span class="keyword">from</span> <span class="string">"./app/app.module"</span></span><br><span class="line"><span class="comment">// 引入环境变量对象 &#123; production: false &#125;</span></span><br><span class="line"><span class="keyword">import</span> &#123; environment &#125; <span class="keyword">from</span> <span class="string">"./environments/environment"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果当前为生产环境</span></span><br><span class="line"><span class="keyword">if</span> (environment.production) &#123;</span><br><span class="line">  <span class="comment">// 开启生产模式</span></span><br><span class="line">  enableProdMode()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 启动应用程序</span></span><br><span class="line">platformBrowserDynamic()</span><br><span class="line">  .bootstrapModule(AppModule)</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.error(err))</span><br></pre></td></tr></table></figure>

<h3 id="8-共享模块"><a href="#8-共享模块" class="headerlink" title="8.共享模块"></a>8.共享模块</h3><p>共享模块当中放置的是 Angular 应用中模块级别的需要共享的组件或逻辑。</p>
<ol>
<li><p>创建共享模块： <code>ng g m shared</code> </p>
</li>
<li><p>创建共享组件：<code>ng g c shared/components/Layout</code></p>
</li>
<li><p>在共享模块中导出共享组件 </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@NgModule(&#123;</span><br><span class="line">  declarations: [LayoutComponent],</span><br><span class="line">  exports: [LayoutComponent]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">SharedModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在根模块中导入共享模块</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@NgModule(&#123;</span><br><span class="line">  declarations: [AppComponent],</span><br><span class="line">  imports: [SharedModule],</span><br><span class="line">  bootstrap: [AppComponent]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在根组件中使用 Layout 组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-root"</span>,</span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;App works&lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;app-layout&gt;&lt;/app-layout&gt;</span></span><br><span class="line"><span class="string">  `</span>,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123; &#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="9-数据绑定"><a href="#9-数据绑定" class="headerlink" title="9.数据绑定"></a>9.数据绑定</h3><p>数据绑定就是将组件类中的数据显示在组件模板中，当组件类中的数据发生变化时会自动被同步到组件模板中（数据驱动 DOM ）。</p>
<p>在 Angular 中使用差值表达式进行数据绑定，即大胡子语法。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;getInfo()&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;a == b ? '相等': '不等'&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;'Hello Angular'&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> [<span class="attr">innerHTML</span>]=<span class="string">"htmlSnippet"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> <span class="comment">&lt;!-- 对数据中的代码进行转义 --&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="10-DOM对象的属性绑定和HTML标记的属性绑定"><a href="#10-DOM对象的属性绑定和HTML标记的属性绑定" class="headerlink" title="10.DOM对象的属性绑定和HTML标记的属性绑定"></a>10.DOM对象的属性绑定和HTML标记的属性绑定</h3><p>属性绑定分为两种情况，绑定 DOM 对象属性和绑定HTML标记属性。</p>
<ol>
<li>使用 [属性名称] 为元素绑定 DOM 对象属性。</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> [<span class="attr">src</span>]=<span class="string">"imgUrl"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>使用 [attr.属性名称] 为元素绑定 HTML 标记属性</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">td</span> [<span class="attr">attr.colspan</span>]=<span class="string">"colSpan"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在大多数情况下，DOM 对象属性和 HTML 标记属性是对应的关系，所以使用第一种情况。但是某些属性只有 HTML 标记存在，DOM 对象中不存在，此时需要使用第二种情况，比如 colspan 属性，在 DOM 对象中就没有，或者自定义 HTML 属性也需要使用第二种情况。</p>
<h3 id="11-动态为元素添加类名及行内样式"><a href="#11-动态为元素添加类名及行内样式" class="headerlink" title="11.动态为元素添加类名及行内样式"></a>11.动态为元素添加类名及行内样式</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> [<span class="attr">class.active</span>]=<span class="string">"isActive"</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">ngClass</span>]=<span class="string">"&#123;'active': true, 'error': true&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> [<span class="attr">style.backgroundColor</span>]=<span class="string">"isActive ? 'blue': 'red'"</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> [<span class="attr">ngStyle</span>]=<span class="string">"&#123;'backgroundColor': 'red'&#125;"</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="12-事件绑定"><a href="#12-事件绑定" class="headerlink" title="12.事件绑定"></a>12.事件绑定</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"onSave($event)"</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 当按下回车键抬起的时候执行函数 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> (<span class="attr">keyup.enter</span>)=<span class="string">"onKeyUp()"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  title = <span class="string">"test"</span></span><br><span class="line">  onSave(event: Event) &#123;</span><br><span class="line">    <span class="comment">// this 指向组件类的实例对象</span></span><br><span class="line">    <span class="keyword">this</span>.title <span class="comment">// "test"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="13-获取原生-DOM-对象"><a href="#13-获取原生-DOM-对象" class="headerlink" title="13.获取原生 DOM 对象"></a>13.获取原生 DOM 对象</h3><blockquote>
<p>在组件模板中获取</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> (<span class="attr">keyup.enter</span>)=<span class="string">"onKeyUp(username.value)"</span> #<span class="attr">username</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>在组件类中获取</p>
</blockquote>
<p>使用 ViewChild 装饰器获取一个元素</p>
 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> #<span class="attr">paragraph</span>&gt;</span>home works!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; AfterViewInit, ElementRef, ViewChild &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeComponent</span> <span class="title">implements</span> <span class="title">AfterViewInit</span> </span>&#123;</span><br><span class="line">  @ViewChild(<span class="string">"paragraph"</span>) paragraph: ElementRef&lt;HTMLParagraphElement&gt; | <span class="literal">undefined</span></span><br><span class="line">  ngAfterViewInit() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.paragraph?.nativeElement)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用 ViewChildren 获取一组元素</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> #<span class="attr">items</span>&gt;</span>a<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> #<span class="attr">items</span>&gt;</span>b<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> #<span class="attr">items</span>&gt;</span>c<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; AfterViewInit, QueryList, ViewChildren &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-home"</span>,</span><br><span class="line">  templateUrl: <span class="string">"./home.component.html"</span>,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeComponent</span> <span class="title">implements</span> <span class="title">AfterViewInit</span> </span>&#123;</span><br><span class="line">  @ViewChildren(<span class="string">"items"</span>) items: QueryList&lt;HTMLLIElement&gt; | <span class="literal">undefined</span></span><br><span class="line">  ngAfterViewInit() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.items?.toArray())</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="14-双向数据绑定"><a href="#14-双向数据绑定" class="headerlink" title="14.双向数据绑定"></a>14.双向数据绑定</h3><p>数据在组件类和组件模板中双向同步。</p>
<p>Angular 将双向数据绑定功能放在了 @angular/forms 模块中，所以要实现双向数据绑定需要依赖该模块。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; FormsModule &#125; <span class="keyword">from</span> <span class="string">"@angular/forms"</span></span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  imports: [FormsModule],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> [(<span class="attr">ngModel</span>)]=<span class="string">"username"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"change()"</span>&gt;</span>在组件类中更改 username<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>username: &#123;&#123; username &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  username: string = <span class="string">""</span></span><br><span class="line">  change() &#123;</span><br><span class="line">    <span class="keyword">this</span>.username = <span class="string">"hello Angular"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="15-内容投影"><a href="#15-内容投影" class="headerlink" title="15.内容投影"></a>15.内容投影</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- app.component.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bootstrap-panel</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"heading"</span>&gt;</span></span><br><span class="line">        Heading</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"body"</span>&gt;</span></span><br><span class="line">        Body</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bootstrap-panel</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- panel.component.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-default"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-heading"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ng-content</span> <span class="attr">select</span>=<span class="string">".heading"</span>&gt;</span><span class="tag">&lt;/<span class="name">ng-content</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ng-content</span> <span class="attr">select</span>=<span class="string">".body"</span>&gt;</span><span class="tag">&lt;/<span class="name">ng-content</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果只有一个ng-content，不需要select属性。</p>
<p>ng-content在浏览器中会被 &lt;div class=”heading”&gt;&lt;/div&gt; 替代，如果不想要这个额外的div，可以使用ng-container替代这个div。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- app.component.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bootstrap-panel</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">ng-container</span> <span class="attr">class</span>=<span class="string">"heading"</span>&gt;</span></span><br><span class="line">        Heading</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ng-container</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ng-container</span> <span class="attr">class</span>=<span class="string">"body"</span>&gt;</span></span><br><span class="line">        Body</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ng-container</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bootstrap-panel</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="16-数据绑定的容错处理"><a href="#16-数据绑定的容错处理" class="headerlink" title="16.数据绑定的容错处理"></a>16.数据绑定的容错处理</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.component.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">    task = &#123;</span><br><span class="line">        person: &#123;</span><br><span class="line">            name: <span class="string">'张三'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 方式一 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> *<span class="attr">ngIf</span>=<span class="string">"task.person"</span>&gt;</span>&#123;&#123; task.person.name &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 方式二 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; task.person?.name &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="17-引入全局样式的三种方式"><a href="#17-引入全局样式的三种方式" class="headerlink" title="17.引入全局样式的三种方式"></a>17.引入全局样式的三种方式</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 第一种方式 在 styles.css 文件中 */</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">"~bootstrap/dist/css/bootstrap.css"</span>;</span><br><span class="line"><span class="comment">/* ~ 相对node_modules文件夹 */</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 第二种方式 在 index.html 文件中  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第三种方式 在 angular.json 文件中</span></span><br><span class="line"><span class="string">"styles"</span>: [</span><br><span class="line">  <span class="string">"./node_modules/bootstrap/dist/css/bootstrap.min.css"</span>,</span><br><span class="line">  <span class="string">"src/styles.css"</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="18-指令介绍及结构指令ngIf的两种使用方式"><a href="#18-指令介绍及结构指令ngIf的两种使用方式" class="headerlink" title="18.指令介绍及结构指令ngIf的两种使用方式"></a>18.指令介绍及结构指令ngIf的两种使用方式</h3><p>指令是 Angular 提供的操作 DOM 的途径。指令分为属性指令和结构指令。</p>
<p>属性指令：修改现有元素的外观或行为，使用 [] 包裹。</p>
<p>结构指令：增加、删除 DOM 节点以修改布局，使用*作为指令前缀</p>
<blockquote>
<p>内置指令</p>
</blockquote>
<ul>
<li>*ngIf </li>
</ul>
<p>根据条件渲染 DOM 节点或移除 DOM 节点。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">"data.length == 0"</span>&gt;</span>没有更多数据<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">"data.length &gt; 0; then dataList else noData"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ng-template</span> #<span class="attr">dataList</span>&gt;</span>课程列表<span class="tag">&lt;/<span class="name">ng-template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ng-template</span> #<span class="attr">noData</span>&gt;</span>没有更多数据<span class="tag">&lt;/<span class="name">ng-template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="19-属性指令hidden"><a href="#19-属性指令hidden" class="headerlink" title="19.属性指令hidden"></a>19.属性指令hidden</h3><p>根据条件显示 DOM 节点或隐藏 DOM 节点 (display)。 </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">hidden</span>]=<span class="string">"data.length == 0"</span>&gt;</span>课程列表<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">hidden</span>]=<span class="string">"data.length &gt; 0"</span>&gt;</span>没有更多数据<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="20-结构指令ngFor的使用方式"><a href="#20-结构指令ngFor的使用方式" class="headerlink" title="20.结构指令ngFor的使用方式"></a>20.结构指令ngFor的使用方式</h3><p>遍历数据生成HTML结构</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">interface List &#123;</span><br><span class="line">  id: number</span><br><span class="line">  name: string</span><br><span class="line">  age: number</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">list: List[] = [</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">"张三"</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">"李四"</span>, <span class="attr">age</span>: <span class="number">30</span> &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span></span></span><br><span class="line"><span class="tag">    *<span class="attr">ngFor</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">      let item of list;</span></span></span><br><span class="line"><span class="tag"><span class="string">      let i = index;</span></span></span><br><span class="line"><span class="tag"><span class="string">      let isEven = even;</span></span></span><br><span class="line"><span class="tag"><span class="string">      let isOdd = odd;</span></span></span><br><span class="line"><span class="tag"><span class="string">      let isFirst = first;</span></span></span><br><span class="line"><span class="tag"><span class="string">      let isLast = last;</span></span></span><br><span class="line"><span class="tag"><span class="string">    "</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> *<span class="attr">ngFor</span>=<span class="string">"let item of list; trackBy: identify"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">identify(index, item)&#123;</span><br><span class="line">  <span class="keyword">return</span> item.id; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="21-自定义指令用法"><a href="#21-自定义指令用法" class="headerlink" title="21.自定义指令用法"></a>21.自定义指令用法</h3><p>需求：为元素设置默认背景颜色，鼠标移入时的背景颜色以及移出时的背景颜色。</p>
 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">appHover</span>]=<span class="string">"&#123; bgColor: 'skyblue' &#125;"</span>&gt;</span>Hello Angular<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; AfterViewInit, Directive, ElementRef, HostListener, Input &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 接收参的数类型</span></span><br><span class="line">interface Options &#123;</span><br><span class="line">  bgColor?: string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Directive(&#123;</span><br><span class="line">  selector: <span class="string">"[appHover]"</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">HoverDirective</span> <span class="title">implements</span> <span class="title">AfterViewInit</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 接收参数</span></span><br><span class="line">  @Input(<span class="string">"appHover"</span>) appHover: Options = &#123;&#125;</span><br><span class="line">  <span class="comment">// 要操作的 DOM 节点</span></span><br><span class="line">  element: HTMLElement</span><br><span class="line">	<span class="comment">// 获取要操作的 DOM 节点</span></span><br><span class="line">  <span class="keyword">constructor</span>(private elementRef: ElementRef) &#123;</span><br><span class="line">    <span class="keyword">this</span>.element = <span class="keyword">this</span>.elementRef.nativeElement</span><br><span class="line">  &#125;</span><br><span class="line">	<span class="comment">// 组件模板初始完成后设置元素的背景颜色</span></span><br><span class="line">  ngAfterViewInit() &#123;</span><br><span class="line">    <span class="keyword">this</span>.element.style.backgroundColor = <span class="keyword">this</span>.appHover.bgColor || <span class="string">"skyblue"</span></span><br><span class="line">  &#125;</span><br><span class="line">	<span class="comment">// 为元素添加鼠标移入事件</span></span><br><span class="line">  @HostListener(<span class="string">"mouseenter"</span>) enter() &#123;</span><br><span class="line">    <span class="keyword">this</span>.element.style.backgroundColor = <span class="string">"pink"</span></span><br><span class="line">  &#125;</span><br><span class="line">	<span class="comment">// 为元素添加鼠标移出事件</span></span><br><span class="line">  @HostListener(<span class="string">"mouseleave"</span>) leave() &#123;</span><br><span class="line">    <span class="keyword">this</span>.element.style.backgroundColor = <span class="string">"skyblue"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="任务二：Angular-深入学习"><a href="#任务二：Angular-深入学习" class="headerlink" title="任务二：Angular 深入学习"></a>任务二：Angular 深入学习</h2><h3 id="1-管道"><a href="#1-管道" class="headerlink" title="1.管道"></a>1.管道</h3><p>管道的作用是格式化组件模板数据。</p>
<blockquote>
<p>内置管道</p>
</blockquote>
<ol>
<li>date 日期格式化</li>
<li>currency 货币格式化</li>
<li>uppercase 转大写</li>
<li>lowercase 转小写</li>
<li>json 格式化json 数据</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; date | date: "yyyy-MM-dd" &#125;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-自定义管道"><a href="#2-自定义管道" class="headerlink" title="2.自定义管道"></a>2.自定义管道</h3><p>需求：指定字符串不能超过规定的长度</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// summary.pipe.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Pipe, PipeTransform &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line">@Pipe(&#123;</span><br><span class="line">   name: <span class="string">'summary'</span> </span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">SummaryPipe</span> <span class="title">implements</span> <span class="title">PipeTransform</span> </span>&#123;</span><br><span class="line">    transform (value: string, limit?: number) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!value) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">let</span> actualLimit = (limit) ? limit : <span class="number">50</span>;</span><br><span class="line">        <span class="keyword">return</span> value.substr(<span class="number">0</span>, actualLimit) + <span class="string">'...'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.module.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; SummaryPipe &#125; <span class="keyword">from</span> <span class="string">'./summary.pipe'</span></span><br><span class="line"><span class="meta">@NgModule</span>(&#123;</span><br><span class="line">    declarations: [</span><br><span class="line">      SummaryPipe</span><br><span class="line">    ] </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="3-组件通讯之向组件内部传递数据"><a href="#3-组件通讯之向组件内部传递数据" class="headerlink" title="3.组件通讯之向组件内部传递数据"></a>3.组件通讯之向组件内部传递数据</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">app-favorite</span> [<span class="attr">isFavorite</span>]=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-favorite</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// favorite.component.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Input &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">FavoriteComponent</span> </span>&#123;</span><br><span class="line">    @Input() isFavorite: boolean = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意：在属性的外面加 [] 表示绑定动态值，在组件内接收后是布尔类型，不加 [] 表示绑定普通值，在组件内接收后是字符串类型。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">app-favorite</span> [<span class="attr">is-Favorite</span>]=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-favorite</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Input &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">FavoriteComponent</span> </span>&#123;</span><br><span class="line">  @Input(<span class="string">"is-Favorite"</span>) isFavorite: boolean = <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="4-组件通讯之组件向外部传递数据"><a href="#4-组件通讯之组件向外部传递数据" class="headerlink" title="4.组件通讯之组件向外部传递数据"></a>4.组件通讯之组件向外部传递数据</h3><p>需求：在子组件中通过点击按钮将数据传递给父组件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 子组件模板 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"onClick()"</span>&gt;</span>click<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 子组件类</span></span><br><span class="line"><span class="keyword">import</span> &#123; EventEmitter, Output &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">FavoriteComponent</span> </span>&#123;</span><br><span class="line">  @Output() change = <span class="keyword">new</span> EventEmitter()</span><br><span class="line">  onClick() &#123;</span><br><span class="line">    <span class="keyword">this</span>.change.emit(&#123; <span class="attr">name</span>: <span class="string">"张三"</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 父组件模板 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">app-favorite</span> (<span class="attr">change</span>)=<span class="string">"onChange($event)"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-favorite</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件类</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  onChange(event: &#123; <span class="attr">name</span>: string &#125;) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-生命周期函数之挂载阶段"><a href="#5-生命周期函数之挂载阶段" class="headerlink" title="5.生命周期函数之挂载阶段"></a>5.生命周期函数之挂载阶段</h3><blockquote>
<p>挂载阶段</p>
</blockquote>
<p>挂载阶段的生命周期函数只在挂载阶段执行一次，数据更新时不再执行。</p>
<ol>
<li><p>constructor</p>
<p>Angular 在实例化组件类时执行,  可以用来接收 Angular 注入的服务实例对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">ChildComponent</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span> (private test: TestService) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.test) <span class="comment">// "test"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ngOnInit</p>
<p>在首次接收到输入属性值后执行，在此处可以执行请求操作。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">app-child</span> <span class="attr">name</span>=<span class="string">"张三"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-child</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">ChildComponent</span> <span class="title">implements</span> <span class="title">OnInit</span> </span>&#123;</span><br><span class="line">  @Input(<span class="string">"name"</span>) name: string = <span class="string">""</span></span><br><span class="line">  ngOnInit() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name) <span class="comment">// "张三"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ngAfterContentInit</p>
<p>当内容投影初始渲染完成后调用。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">app-child</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> #<span class="attr">box</span>&gt;</span>Hello Angular<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">app-child</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">ChildComponent</span> <span class="title">implements</span> <span class="title">AfterContentInit</span> </span>&#123;</span><br><span class="line">  @ContentChild(<span class="string">"box"</span>) box: ElementRef&lt;HTMLDivElement&gt; | <span class="literal">undefined</span></span><br><span class="line"></span><br><span class="line">  ngAfterContentInit() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.box) <span class="comment">// &lt;div&gt;Hello Angular&lt;/div&gt;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ngAfterViewInit</p>
<p>当组件视图渲染完成后调用。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- app-child 组件模板 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> #<span class="attr">p</span>&gt;</span>app-child works<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">ChildComponent</span> <span class="title">implements</span> <span class="title">AfterViewInit</span> </span>&#123;</span><br><span class="line">  @ViewChild(<span class="string">"p"</span>) p: ElementRef&lt;HTMLParagraphElement&gt; | <span class="literal">undefined</span></span><br><span class="line">  ngAfterViewInit () &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.p) <span class="comment">// &lt;p&gt;app-child works&lt;/p&gt;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="6-生命周期函数之更新阶段"><a href="#6-生命周期函数之更新阶段" class="headerlink" title="6.生命周期函数之更新阶段"></a>6.生命周期函数之更新阶段</h3><ol>
<li><p>ngOnChanges</p>
<ol>
<li>当输入属性值发生变化时执行，初始设置时也会执行一次，顺序优于 ngOnInit</li>
<li>不论多少输入属性同时变化，钩子函数只会执行一次，变化的值会同时存储在参数中</li>
<li>参数类型为 SimpleChanges，子属性类型为 SimpleChange</li>
<li>对于基本数据类型来说, 只要值发生变化就可以被检测到</li>
<li>对于引用数据类型来说, 可以检测从一个对象变成另一个对象, 但是检测不到同一个对象中属性值的变化，但是不影响组件模板更新数据。</li>
</ol>
<p><strong>基本数据类型值变化</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">app-child</span> [<span class="attr">name</span>]=<span class="string">"name"</span> [<span class="attr">age</span>]=<span class="string">"age"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-child</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"change()"</span>&gt;</span>change<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  name: string = <span class="string">"张三"</span>;</span><br><span class="line">	age: number = <span class="number">20</span></span><br><span class="line">  change() &#123;</span><br><span class="line">    <span class="keyword">this</span>.name = <span class="string">"李四"</span></span><br><span class="line">    <span class="keyword">this</span>.age = <span class="number">30</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">ChildComponent</span> <span class="title">implements</span> <span class="title">OnChanges</span> </span>&#123;</span><br><span class="line">  @Input(<span class="string">"name"</span>) name: string = <span class="string">""</span></span><br><span class="line">	@Input(<span class="string">"age"</span>) age: number = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  ngOnChanges(changes: SimpleChanges) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"基本数据类型值变化可以被检测到"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>引用数据类型变化</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">app-child</span> [<span class="attr">person</span>]=<span class="string">"person"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-child</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"change()"</span>&gt;</span>change<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  person = &#123; <span class="attr">name</span>: <span class="string">"张三"</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;</span><br><span class="line">  change() &#123;</span><br><span class="line">    <span class="keyword">this</span>.person = &#123; <span class="attr">name</span>: <span class="string">"李四"</span>, <span class="attr">age</span>: <span class="number">30</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">ChildComponent</span> <span class="title">implements</span> <span class="title">OnChanges</span> </span>&#123;</span><br><span class="line">  @Input(<span class="string">"person"</span>) person = &#123; <span class="attr">name</span>: <span class="string">""</span>, <span class="attr">age</span>: <span class="number">0</span> &#125;</span><br><span class="line"></span><br><span class="line">  ngOnChanges(changes: SimpleChanges) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"对于引用数据类型, 只能检测到引用地址发生变化, 对象属性变化不能被检测到"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ngDoCheck：主要用于调试，只要输入属性发生变化，不论是基本数据类型还是引用数据类型还是引用数据类型中的属性变化，都会执行。</p>
</li>
<li><p>ngAfterContentChecked：内容投影更新完成后执行。</p>
</li>
<li><p>ngAfterViewChecked：组件视图更新完成后执行。</p>
</li>
</ol>
<h3 id="7-组件生命周期函数之卸载阶段"><a href="#7-组件生命周期函数之卸载阶段" class="headerlink" title="7.组件生命周期函数之卸载阶段"></a>7.组件生命周期函数之卸载阶段</h3><ol>
<li><p>ngOnDestroy</p>
<p>当组件被销毁之前调用, 用于清理操作。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeComponent</span> <span class="title">implements</span> <span class="title">OnDestroy</span> </span>&#123;</span><br><span class="line">  ngOnDestroy() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"组件被卸载"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="8-理解什么是依赖注入"><a href="#8-理解什么是依赖注入" class="headerlink" title="8.理解什么是依赖注入"></a>8.理解什么是依赖注入</h3><blockquote>
<p>概述</p>
</blockquote>
<p>依赖注入 ( Dependency Injection ) 简称DI，是面向对象编程中的一种设计原则，用来减少代码之间的<strong>耦合度</strong>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MailService</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(APIKEY) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EmailSender</span> </span>&#123;</span><br><span class="line">  mailService: MailService</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">this</span>.mailService = <span class="keyword">new</span> MailService(<span class="string">"APIKEY1234567890"</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  sendMail(mail) &#123;</span><br><span class="line">    <span class="keyword">this</span>.mailService.sendMail(mail)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> emailSender = <span class="keyword">new</span> EmailSender()</span><br><span class="line">emailSender.sendMail(mail)</span><br></pre></td></tr></table></figure>

<p>EmailSender 类运行时要使用 MailService 类，EmailSender 类依赖 MailService 类，MailService 类是 EmailSender 类的依赖项。</p>
<p>以上写法的耦合度太高，代码并不健壮。如果 MailService 类改变了参数的传递方式，在 EmailSender 类中的写法也要跟着改变。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EmailSender</span> </span>&#123;</span><br><span class="line">  mailService: MailService</span><br><span class="line">  <span class="keyword">constructor</span>(mailService: MailService) &#123;</span><br><span class="line">    <span class="keyword">this</span>.mailService = mailService;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> mailService = <span class="keyword">new</span> MailService(<span class="string">"APIKEY1234567890"</span>)</span><br><span class="line"><span class="keyword">const</span> emailSender = <span class="keyword">new</span> EmailSender(mailService)</span><br></pre></td></tr></table></figure>

<p>在实例化 EmailSender 类时将它的依赖项通过 constructor 构造函数参数的形式注入到类的内部，这种写法就是依赖注入。</p>
<p>通过依赖注入降了代码之间的耦合度，增加了代码的可维护性。MailService 类中代码的更改再也不会影响 EmailSender 类。</p>
<h3 id="9-Injector-的创建和使用"><a href="#9-Injector-的创建和使用" class="headerlink" title="9.Injector 的创建和使用"></a>9.Injector 的创建和使用</h3><blockquote>
<p>DI 框架</p>
</blockquote>
<p>Angular 有自己的 DI 框架，它将实现依赖注入的过程隐藏了，对于开发者来说只需使用很简单的代码就可以使用复杂的依赖注入功能。</p>
<p>在 Angular 的 DI 框架中有四个核心概念：</p>
<ol>
<li>Dependency：组件要依赖的实例对象，服务实例对象</li>
<li>Token：获取服务实例对象的标识</li>
<li>Injector：注入器，负责创建维护服务类的实例对象并向组件中注入服务实例对象。</li>
<li>Provider：配置注入器的对象，指定创建服务实例对象的服务类和获取实例对象的标识。</li>
</ol>
<blockquote>
<p>注入器 Injectors</p>
</blockquote>
<p>注入器负责创建服务类实例对象，并将服务类实例对象注入到需要的组件中。</p>
<ol>
<li><p>创建注入器</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ReflectiveInjector &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"><span class="comment">// 服务类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MailService</span> </span>&#123;&#125;</span><br><span class="line"><span class="comment">// 创建注入器并传入服务类</span></span><br><span class="line"><span class="keyword">const</span> injector = ReflectiveInjector.resolveAndCreate([MailService])</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取注入器中的服务类实例对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mailService = injector.get(MailService)</span><br></pre></td></tr></table></figure>
</li>
<li><p>服务实例对象为单例模式，注入器在创建服务实例后会对其进行缓存</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mailService1 = injector.get(MailService)</span><br><span class="line"><span class="keyword">const</span> mailService2 = injector.get(MailService)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(mailService1 === mailService2) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>不同的注入器返回不同的服务实例对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> injector = ReflectiveInjector.resolveAndCreate([MailService])</span><br><span class="line"><span class="keyword">const</span> childInjector = injector.resolveAndCreateChild([MailService])</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mailService1 = injector.get(MailService)</span><br><span class="line"><span class="keyword">const</span> mailService2 = childInjector.get(MailService)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(mailService1 === mailService2)</span><br></pre></td></tr></table></figure>
</li>
<li><p>服务实例的查找类似函数作用域链，当前级别可以找到就使用当前级别，当前级别找不到去父级中查找</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> injector = ReflectiveInjector.resolveAndCreate([MailService])</span><br><span class="line"><span class="keyword">const</span> childInjector = injector.resolveAndCreateChild([])</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mailService1 = injector.get(MailService)</span><br><span class="line"><span class="keyword">const</span> mailService2 = childInjector.get(MailService)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(mailService1 === mailService2)</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="10-Provider-的使用"><a href="#10-Provider-的使用" class="headerlink" title="10.Provider 的使用"></a>10.Provider 的使用</h3><ol>
<li><p>配置注入器的对象，指定了创建实例对象的服务类和访问服务实例对象的标识。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> injector = ReflectiveInjector.resolveAndCreate([</span><br><span class="line">  &#123; <span class="attr">provide</span>: MailService, <span class="attr">useClass</span>: MailService &#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
</li>
<li><p>访问依赖对象的标识也可以是字符串类型</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> injector = ReflectiveInjector.resolveAndCreate([</span><br><span class="line">  &#123; <span class="attr">provide</span>: <span class="string">"mail"</span>, <span class="attr">useClass</span>: MailService &#125;</span><br><span class="line">])</span><br><span class="line"><span class="keyword">const</span> mailService = injector.get(<span class="string">"mail"</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>useValue</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> injector = ReflectiveInjector.resolveAndCreate([</span><br><span class="line">  &#123;</span><br><span class="line">    provide: <span class="string">"Config"</span>,</span><br><span class="line">    useValue: <span class="built_in">Object</span>.freeze(&#123;</span><br><span class="line">      APIKEY: <span class="string">"API1234567890"</span>,</span><br><span class="line">      APISCRET: <span class="string">"500-400-300"</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">])</span><br><span class="line"><span class="keyword">const</span> Config = injector.get(<span class="string">"Config"</span>)</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>将实例对象和外部的引用建立了松耦合关系，外部通过标识获取实例对象，只要标识保持不变，内部代码怎么变都不会影响到外部。</p>
<h3 id="11-服务的创建与注入"><a href="#11-服务的创建与注入" class="headerlink" title="11.服务的创建与注入"></a>11.服务的创建与注入</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Injectable &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line">@Injectable(&#123;</span><br><span class="line">  providedIn: <span class="string">'root'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">TestService</span> </span>&#123; &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line"> 	<span class="keyword">constructor</span> (private testService: TestService) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="12-服务的作用域"><a href="#12-服务的作用域" class="headerlink" title="12.服务的作用域"></a>12.服务的作用域</h3><p>使用服务可以轻松实现跨模块跨组件共享数据，这取决于服务的作用域。</p>
<ol>
<li><p>在根注入器中注册服务，所有模块使用同一个服务实例对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Injectable &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line">@Injectable(&#123;</span><br><span class="line">  providedIn: <span class="string">'root'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">CarListService</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在模块级别注册服务，该模块中的所有组件使用同一个服务实例对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Injectable &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; CarModule &#125; <span class="keyword">from</span> <span class="string">'./car.module'</span>;</span><br><span class="line"></span><br><span class="line">@Injectable(&#123;</span><br><span class="line">  providedIn: CarModule,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">CarListService</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; CarListService &#125; <span class="keyword">from</span> <span class="string">'./car-list.service'</span>;</span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  providers: [CarListService],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">CarModule</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在组件级别注册服务，该组件及其子组件使用同一个服务实例对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; CarListService &#125; <span class="keyword">from</span> <span class="string">'../car-list.service.ts'</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector:    <span class="string">'app-car-list'</span>,</span><br><span class="line">  templateUrl: <span class="string">'./car-list.component.html'</span>,</span><br><span class="line">  providers:  [ CarListService ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="13-模板驱动表单用法-删-dirty"><a href="#13-模板驱动表单用法-删-dirty" class="headerlink" title="13.模板驱动表单用法 (删 dirty)"></a>13.模板驱动表单用法 (删 dirty)</h3><p>在 Angular 中，表单有两种类型，分别为模板驱动和模型驱动。</p>
<h4 id="11-1-模板驱动"><a href="#11-1-模板驱动" class="headerlink" title="11.1 模板驱动"></a>11.1 模板驱动</h4><h5 id="11-1-1-概述"><a href="#11-1-1-概述" class="headerlink" title="11.1.1 概述"></a>11.1.1 概述</h5><p>表单的控制逻辑写在组件模板中，适合简单的表单类型。</p>
<h5 id="11-1-2-快速上手"><a href="#11-1-2-快速上手" class="headerlink" title="11.1.2 快速上手"></a>11.1.2 快速上手</h5><ol>
<li><p>引入依赖模块 FormsModule </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; FormsModule &#125; <span class="keyword">from</span> <span class="string">"@angular/forms"</span></span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  imports: [FormsModule],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 DOM 表单转换为 ngForm</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> #<span class="attr">f</span>=<span class="string">"ngForm"</span> (<span class="attr">submit</span>)=<span class="string">"onSubmit(f)"</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>声明表单字段为 ngModel</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> #<span class="attr">f</span>=<span class="string">"ngForm"</span> (<span class="attr">submit</span>)=<span class="string">"onSubmit(f)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">ngModel</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>获取表单字段值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NgForm &#125; <span class="keyword">from</span> <span class="string">"@angular/forms"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  onSubmit(form: NgForm) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(form.value)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="14-模板驱动表单中的表单分组"><a href="#14-模板驱动表单中的表单分组" class="headerlink" title="14.模板驱动表单中的表单分组"></a>14.模板驱动表单中的表单分组</h3><ol start="5">
<li><p>表单分组</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> #<span class="attr">f</span>=<span class="string">"ngForm"</span> (<span class="attr">submit</span>)=<span class="string">"onSubmit(f)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">ngModelGroup</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">ngModel</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">ngModelGroup</span>=<span class="string">"contact"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"phone"</span> <span class="attr">ngModel</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="15-模板驱动型表单的验证方式"><a href="#15-模板驱动型表单的验证方式" class="headerlink" title="15.模板驱动型表单的验证方式"></a>15.模板驱动型表单的验证方式</h3><ul>
<li>required 必填字段</li>
<li>minlength 字段最小长度</li>
<li>maxlength 字段最大长度</li>
<li>pattern 验证正则 例如：pattern=”\d” 匹配一个数值</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> #<span class="attr">f</span>=<span class="string">"ngForm"</span> (<span class="attr">submit</span>)=<span class="string">"onSubmit(f)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">ngModel</span> <span class="attr">required</span> <span class="attr">pattern</span>=<span class="string">"\d"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  onSubmit(form: NgForm) &#123;</span><br><span class="line">    <span class="comment">// 查看表单整体是否验证通过</span></span><br><span class="line">    <span class="built_in">console</span>.log(form.valid)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 表单整体未通过验证时禁用提交表单 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> [<span class="attr">disabled</span>]=<span class="string">"f.invalid"</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在组件模板中显示表单项未通过时的错误信息。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> #<span class="attr">f</span>=<span class="string">"ngForm"</span> (<span class="attr">submit</span>)=<span class="string">"onSubmit(f)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> #<span class="attr">username</span>=<span class="string">"ngModel"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">"username.touched &amp;&amp; !username.valid &amp;&amp; username.errors"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">"username.errors.required"</span>&gt;</span>请填写用户名<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">"username.errors.pattern"</span>&gt;</span>不符合正则规则<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>指定表单项未通过验证时的样式。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">input</span><span class="selector-class">.ng-touched</span><span class="selector-class">.ng-invalid</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">2px</span> solid red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="16-模型驱动表单的基本用法"><a href="#16-模型驱动表单的基本用法" class="headerlink" title="16.模型驱动表单的基本用法"></a>16.模型驱动表单的基本用法</h3><p>表单的控制逻辑写在组件类中，对验证逻辑拥有更多的控制权，适合复杂的表单的类型。</p>
<p>在模型驱动表单中，表单字段需要是 FormControl 类的实例，实例对象可以验证表单字段中的值，值是否被修改过等等。</p>
<p>一组表单字段构成整个表单，整个表单需要是 FormGroup 类的实例，它可以对表单进行整体验证。</p>
<ol>
<li>FormControl：表单组中的一个表单项</li>
<li>FormGroup：表单组，表单至少是一个 FormGroup</li>
<li>FormArray：用于复杂表单，可以动态添加表单项或表单组，在表单验证时，FormArray 中有一项没通过，整体没通过。</li>
</ol>
<h5 id="11-2-2-快速上手"><a href="#11-2-2-快速上手" class="headerlink" title="11.2.2 快速上手"></a>11.2.2 快速上手</h5><ol>
<li><p>引入 ReactiveFormsModule</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ReactiveFormsModule &#125; <span class="keyword">from</span> <span class="string">"@angular/forms"</span></span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  imports: [ReactiveFormsModule]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在组件类中创建 FormGroup 表单控制对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; FormControl, FormGroup &#125; <span class="keyword">from</span> <span class="string">"@angular/forms"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  contactForm: FormGroup = <span class="keyword">new</span> FormGroup(&#123;</span><br><span class="line">    name: <span class="keyword">new</span> FormControl(),</span><br><span class="line">    phone: <span class="keyword">new</span> FormControl()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>关联组件模板中的表单</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> [<span class="attr">formGroup</span>]=<span class="string">"contactForm"</span> (<span class="attr">submit</span>)=<span class="string">"onSubmit()"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"phone"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>获取表单值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  onSubmit() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.contactForm.value)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置表单默认值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">   contactForm: FormGroup = <span class="keyword">new</span> FormGroup(&#123;</span><br><span class="line">     name: <span class="keyword">new</span> FormControl(<span class="string">"默认值"</span>),</span><br><span class="line">     phone: <span class="keyword">new</span> FormControl(<span class="number">15888888888</span>)</span><br><span class="line">   &#125;)</span><br><span class="line">   <span class="string">``</span></span><br><span class="line"></span><br><span class="line">### 17.模型驱动表单中实现表单分组</span><br><span class="line"></span><br><span class="line"><span class="number">6.</span> 表单分组</span><br><span class="line"></span><br><span class="line">   <span class="string">``</span><span class="string">`javascript</span></span><br><span class="line"><span class="string">   contactForm: FormGroup = new FormGroup(&#123;</span></span><br><span class="line"><span class="string">     fullName: new FormGroup(&#123;</span></span><br><span class="line"><span class="string">       firstName: new FormControl(),</span></span><br><span class="line"><span class="string">       lastName: new FormControl()</span></span><br><span class="line"><span class="string">     &#125;),</span></span><br><span class="line"><span class="string">     phone: new FormControl()</span></span><br><span class="line"><span class="string">   &#125;)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> [<span class="attr">formGroup</span>]=<span class="string">"contactForm"</span> (<span class="attr">submit</span>)=<span class="string">"onSubmit()"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">formGroupName</span>=<span class="string">"fullName"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"firstName"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"lastName"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"phone"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">onSubmit() &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.contactForm.value.name.username)</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.contactForm.get([<span class="string">"name"</span>, <span class="string">"username"</span>])?.value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="18-使用formArray动态创建表单"><a href="#18-使用formArray动态创建表单" class="headerlink" title="18.使用formArray动态创建表单"></a>18.使用formArray动态创建表单</h3><p>需求：在页面中默认显示一组联系方式，通过点击按钮可以添加更多联系方式组。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component, OnInit &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"><span class="keyword">import</span> &#123; FormArray, FormControl, FormGroup &#125; <span class="keyword">from</span> <span class="string">"@angular/forms"</span></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-root"</span>,</span><br><span class="line">  templateUrl: <span class="string">"./app.component.html"</span>,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> <span class="title">implements</span> <span class="title">OnInit</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 表单</span></span><br><span class="line">  contactForm: FormGroup = <span class="keyword">new</span> FormGroup(&#123;</span><br><span class="line">    contacts: <span class="keyword">new</span> FormArray([])</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> contacts() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.contactForm.get(<span class="string">"contacts"</span>) <span class="keyword">as</span> FormArray</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 添加联系方式</span></span><br><span class="line">  addContact() &#123;</span><br><span class="line">    <span class="comment">// 联系方式</span></span><br><span class="line">    <span class="keyword">const</span> myContact: FormGroup = <span class="keyword">new</span> FormGroup(&#123;</span><br><span class="line">      name: <span class="keyword">new</span> FormControl(),</span><br><span class="line">      address: <span class="keyword">new</span> FormControl(),</span><br><span class="line">      phone: <span class="keyword">new</span> FormControl()</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 向联系方式数组中添加联系方式</span></span><br><span class="line">    <span class="keyword">this</span>.contacts.push(myContact)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 删除联系方式</span></span><br><span class="line">  removeContact(i: number) &#123;</span><br><span class="line">    <span class="keyword">this</span>.contacts.removeAt(i)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ngOnInit() &#123;</span><br><span class="line">    <span class="comment">// 添加默认的联系方式</span></span><br><span class="line">    <span class="keyword">this</span>.addContact()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  onSubmit() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.contactForm.value)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> [<span class="attr">formGroup</span>]=<span class="string">"contactForm"</span> (<span class="attr">submit</span>)=<span class="string">"onSubmit()"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">formArrayName</span>=<span class="string">"contacts"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">      *<span class="attr">ngFor</span>=<span class="string">"let contact of contacts.controls; let i = index"</span></span></span><br><span class="line"><span class="tag">      [<span class="attr">formGroupName</span>]=<span class="string">"i"</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"address"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"phone"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"removeContact(i)"</span>&gt;</span>删除联系方式<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"addContact()"</span>&gt;</span>添加联系方式<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="19-模型驱动表单内置验证规则的使用"><a href="#19-模型驱动表单内置验证规则的使用" class="headerlink" title="19.模型驱动表单内置验证规则的使用"></a>19.模型驱动表单内置验证规则的使用</h3><ol>
<li><p>使用内置验证器提供的验证规则验证表单字段</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; FormControl, FormGroup, Validators &#125; <span class="keyword">from</span> <span class="string">"@angular/forms"</span></span><br><span class="line"></span><br><span class="line">contactForm: FormGroup = <span class="keyword">new</span> FormGroup(&#123;</span><br><span class="line">  name: <span class="keyword">new</span> FormControl(<span class="string">"默认值"</span>, [</span><br><span class="line">    Validators.required,</span><br><span class="line">    Validators.minLength(<span class="number">2</span>)</span><br><span class="line">  ])</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取整体表单是否验证通过</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">onSubmit() &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.contactForm.valid)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 表单整体未验证通过时禁用表单按钮 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> [<span class="attr">disabled</span>]=<span class="string">"contactForm.invalid"</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在组件模板中显示为验证通过时的错误信息</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">get</span> name() &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.contactForm.get(<span class="string">"name"</span>)!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> [<span class="attr">formGroup</span>]=<span class="string">"contactForm"</span> (<span class="attr">submit</span>)=<span class="string">"onSubmit()"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">"name.touched &amp;&amp; name.invalid &amp;&amp; name.errors"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">"name.errors.required"</span>&gt;</span>请填写姓名<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">"name.errors.maxlength"</span>&gt;</span></span><br><span class="line">      姓名长度不能大于</span><br><span class="line">      &#123;&#123; name.errors.maxlength.requiredLength &#125;&#125; 实际填写长度为</span><br><span class="line">      &#123;&#123; name.errors.maxlength.actualLength &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="20-模型驱动表单同步类型的自定义验证器（一）"><a href="#20-模型驱动表单同步类型的自定义验证器（一）" class="headerlink" title="20.模型驱动表单同步类型的自定义验证器（一）"></a>20.模型驱动表单同步类型的自定义验证器（一）</h3><ol>
<li>自定义验证器的类型是 TypeScript 类</li>
<li>类中包含具体的验证方法，验证方法必须为静态方法</li>
<li>验证方法有一个参数 control，类型为 AbstractControl。其实就是 FormControl 类的实例对象的类型</li>
<li>如果验证成功，返回 null</li>
<li>如果验证失败，返回对象，对象中的属性即为验证标识，值为 true，标识该项验证失败</li>
<li>验证方法的返回值为 ValidationErrors | null</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; AbstractControl, ValidationErrors &#125; <span class="keyword">from</span> <span class="string">"@angular/forms"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">NameValidators</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 字段值中不能包含空格</span></span><br><span class="line">  <span class="keyword">static</span> cannotContainSpace(control: AbstractControl): ValidationErrors | <span class="literal">null</span> &#123;</span><br><span class="line">    <span class="comment">// 验证未通过</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/\s/</span>.test(control.value)) <span class="keyword">return</span> &#123; <span class="attr">cannotContainSpace</span>: <span class="literal">true</span> &#125;</span><br><span class="line">    <span class="comment">// 验证通过</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NameValidators &#125; <span class="keyword">from</span> <span class="string">"./Name.validators"</span></span><br><span class="line"></span><br><span class="line">contactForm: FormGroup = <span class="keyword">new</span> FormGroup(&#123;</span><br><span class="line">  name: <span class="keyword">new</span> FormControl(<span class="string">""</span>, [</span><br><span class="line">    Validators.required,</span><br><span class="line">    NameValidators.cannotContainSpace</span><br><span class="line">  ])</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">"name.touched &amp;&amp; name.invalid &amp;&amp; name.errors"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">"name.errors.cannotContainSpace"</span>&gt;</span>姓名中不能包含空格<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="21-模型驱动表单异步类型的自定义验证器（二）"><a href="#21-模型驱动表单异步类型的自定义验证器（二）" class="headerlink" title="21.模型驱动表单异步类型的自定义验证器（二）"></a>21.模型驱动表单异步类型的自定义验证器（二）</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; AbstractControl, ValidationErrors &#125; <span class="keyword">from</span> <span class="string">"@angular/forms"</span></span><br><span class="line"><span class="keyword">import</span> &#123; Observable &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">NameValidators</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> shouldBeUnique(control: AbstractControl): <span class="built_in">Promise</span>&lt;ValidationErrors | <span class="literal">null</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (control.value == <span class="string">"admin"</span>) &#123;</span><br><span class="line">         resolve(&#123; <span class="attr">shouldBeUnique</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         resolve(<span class="literal">null</span>)</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">contactForm: FormGroup = <span class="keyword">new</span> FormGroup(&#123;</span><br><span class="line">    name: <span class="keyword">new</span> FormControl(</span><br><span class="line">      <span class="string">""</span>,</span><br><span class="line">      [</span><br><span class="line">        Validators.required</span><br><span class="line">      ],</span><br><span class="line">      NameValidators.shouldBeUnique</span><br><span class="line">    )</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">"name.touched &amp;&amp; name.invalid &amp;&amp; name.errors"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">"name.errors.shouldBeUnique"</span>&gt;</span>用户名重复<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">"name.pending"</span>&gt;</span>正在检测姓名是否重复<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="22-FormBuild-创建模型表单的快捷方式"><a href="#22-FormBuild-创建模型表单的快捷方式" class="headerlink" title="22.FormBuild 创建模型表单的快捷方式"></a>22.FormBuild 创建模型表单的快捷方式</h3><p>创建表单的快捷方式。</p>
<ol>
<li><code>this.fb.control</code>：表单项</li>
<li><code>this.fb.group</code>：表单组，表单至少是一个 FormGroup</li>
<li><code>this.fb.array</code>：用于复杂表单，可以动态添加表单项或表单组，在表单验证时，FormArray 中有一项没通过，整体没通过。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; FormBuilder, FormGroup, Validators &#125; <span class="keyword">from</span> <span class="string">"@angular/forms"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  contactForm: FormGroup</span><br><span class="line">  <span class="keyword">constructor</span>(private fb: FormBuilder) &#123;</span><br><span class="line">    <span class="keyword">this</span>.contactForm = <span class="keyword">this</span>.fb.group(&#123;</span><br><span class="line">      fullName: <span class="keyword">this</span>.fb.group(&#123;</span><br><span class="line">        firstName: [<span class="string">"😝"</span>, [Validators.required]],</span><br><span class="line">        lastName: [<span class="string">""</span>]</span><br><span class="line">      &#125;),</span><br><span class="line">      phone: []</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="23-模型驱动表单练习之复选框"><a href="#23-模型驱动表单练习之复选框" class="headerlink" title="23.模型驱动表单练习之复选框"></a>23.模型驱动表单练习之复选框</h3><ol>
<li><p>获取一组复选框中选中的值</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> [<span class="attr">formGroup</span>]=<span class="string">"form"</span> (<span class="attr">submit</span>)=<span class="string">"onSubmit()"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> *<span class="attr">ngFor</span>=<span class="string">"let item of Data"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> [<span class="attr">value</span>]=<span class="string">"item.value"</span> (<span class="attr">change</span>)=<span class="string">"onChange($event)"</span> /&gt;</span></span><br><span class="line">    &#123;&#123; item.name &#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"><span class="keyword">import</span> &#123; FormArray, FormBuilder, FormGroup &#125; <span class="keyword">from</span> <span class="string">"@angular/forms"</span></span><br><span class="line">interface Data &#123;</span><br><span class="line">  name: string</span><br><span class="line">  value: string</span><br><span class="line">&#125;</span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-checkbox"</span>,</span><br><span class="line">  templateUrl: <span class="string">"./checkbox.component.html"</span>,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">CheckboxComponent</span> </span>&#123;</span><br><span class="line">  Data: <span class="built_in">Array</span>&lt;Data&gt; = [</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">"Pear"</span>, <span class="attr">value</span>: <span class="string">"pear"</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">"Plum"</span>, <span class="attr">value</span>: <span class="string">"plum"</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">"Kiwi"</span>, <span class="attr">value</span>: <span class="string">"kiwi"</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">"Apple"</span>, <span class="attr">value</span>: <span class="string">"apple"</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">"Lime"</span>, <span class="attr">value</span>: <span class="string">"lime"</span> &#125;</span><br><span class="line">  ]</span><br><span class="line">  form: FormGroup</span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(private fb: FormBuilder) &#123;</span><br><span class="line">    <span class="keyword">this</span>.form = <span class="keyword">this</span>.fb.group(&#123;</span><br><span class="line">      checkArray: <span class="keyword">this</span>.fb.array([])</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  onChange(event: Event) &#123;</span><br><span class="line">    <span class="keyword">const</span> target = event.target <span class="keyword">as</span> HTMLInputElement</span><br><span class="line">    <span class="keyword">const</span> checked = target.checked</span><br><span class="line">    <span class="keyword">const</span> value = target.value</span><br><span class="line">    <span class="keyword">const</span> checkArray = <span class="keyword">this</span>.form.get(<span class="string">"checkArray"</span>) <span class="keyword">as</span> FormArray</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (checked) &#123;</span><br><span class="line">      checkArray.push(<span class="keyword">this</span>.fb.control(value))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> index = checkArray.controls.findIndex(</span><br><span class="line">        control =&gt; control.value === value</span><br><span class="line">      )</span><br><span class="line">      checkArray.removeAt(index)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  onSubmit() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.form.value)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="24-模型驱动表单练习之单选框"><a href="#24-模型驱动表单练习之单选框" class="headerlink" title="24.模型驱动表单练习之单选框"></a>24.模型驱动表单练习之单选框</h3><ol start="2">
<li><p>获取单选框中选中的值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  form: FormGroup</span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(public fb: FormBuilder) &#123;</span><br><span class="line">    <span class="keyword">this</span>.form = <span class="keyword">this</span>.fb.group(&#123; <span class="attr">gender</span>: <span class="string">""</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  onSubmit() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.form.value)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> [<span class="attr">formGroup</span>]=<span class="string">"form"</span> (<span class="attr">submit</span>)=<span class="string">"onSubmit()"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">value</span>=<span class="string">"male"</span> <span class="attr">formControlName</span>=<span class="string">"gender"</span> /&gt;</span> Male</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">value</span>=<span class="string">"female"</span> <span class="attr">formControlName</span>=<span class="string">"gender"</span> /&gt;</span> Female</span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="25-模型驱动表单常用方法介绍"><a href="#25-模型驱动表单常用方法介绍" class="headerlink" title="25.模型驱动表单常用方法介绍"></a>25.模型驱动表单常用方法介绍</h3></li>
<li><p>patchValue：设置表单控件的值（可以设置全部，也可以设置其中某一个，其他不受影响）</p>
</li>
<li><p>setValue：设置表单控件的值 (设置全部，不能排除任何一个)</p>
</li>
<li><p>valueChanges：当表单控件的值发生变化时被触发的事件</p>
</li>
<li><p>reset：表单内容置空</p>
</li>
</ol>
<h3 id="26-路由的基本使用"><a href="#26-路由的基本使用" class="headerlink" title="26.路由的基本使用"></a>26.路由的基本使用</h3><blockquote>
<p>概述</p>
</blockquote>
<p>在 Angular 中，路由是以模块为单位的，每个模块都可以有自己的路由。</p>
<blockquote>
<p>快速上手</p>
</blockquote>
<ol>
<li><p>创建页面组件、Layout 组件以及 Navigation 组件，供路由使用</p>
<ol>
<li>创建<strong>首页</strong>页面组件<code>ng g c pages/home</code></li>
<li>创建<strong>关于我们</strong>页面组件<code>ng g c pages/about</code></li>
<li>创建<strong>布局</strong>组件<code>ng g c pages/layout</code></li>
<li>创建<strong>导航</strong>组件<code>ng g c pages/navigation</code></li>
</ol>
</li>
<li><p>创建路由规则</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.module.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Routes &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"home"</span>,</span><br><span class="line">    component: HomeComponent</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>引入路由模块并启动</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.module.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; RouterModule, Routes &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  imports: [RouterModule.forRoot(routes, &#123; <span class="attr">useHash</span>: <span class="literal">true</span> &#125;)],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加路由插座</p>
 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 路由插座即占位组件 匹配到的路由组件将会显示在这个地方 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-outlet</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在导航组件中定义链接</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">routerLink</span>=<span class="string">"/home"</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">routerLink</span>=<span class="string">"/about"</span>&gt;</span>关于我们<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<blockquote>
<p>匹配规则</p>
</blockquote>
<ul>
<li>重定向</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"home"</span>,</span><br><span class="line">    component: HomeComponent</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    <span class="comment">// 重定向</span></span><br><span class="line">    redirectTo: <span class="string">"home"</span>,</span><br><span class="line">    <span class="comment">// 完全匹配</span></span><br><span class="line">    pathMatch: <span class="string">"full"</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<ul>
<li>404 页面</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"home"</span>,</span><br><span class="line">    component: HomeComponent</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"**"</span>,</span><br><span class="line">    component: NotFoundComponent</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="27-路由传递参数的两种方式"><a href="#27-路由传递参数的两种方式" class="headerlink" title="27.路由传递参数的两种方式"></a>27.路由传递参数的两种方式</h3><blockquote>
<p>查询参数</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">routerLink</span>=<span class="string">"/about"</span> [<span class="attr">queryParams</span>]=<span class="string">"&#123; name: 'kitty' &#125;"</span>&gt;</span>关于我们<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ActivatedRoute &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AboutComponent</span> <span class="title">implements</span> <span class="title">OnInit</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(private route: ActivatedRoute) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  ngOnInit(): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.route.queryParamMap.subscribe(<span class="function"><span class="params">query</span> =&gt;</span> &#123;</span><br><span class="line">      query.get(<span class="string">"name"</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>动态参数</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"home"</span>,</span><br><span class="line">    component: HomeComponent</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about/:name"</span>,</span><br><span class="line">    component: AboutComponent</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> [<span class="attr">routerLink</span>]=<span class="string">"['/about', 'zhangsan']"</span>&gt;</span>关于我们<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ActivatedRoute &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AboutComponent</span> <span class="title">implements</span> <span class="title">OnInit</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(private route: ActivatedRoute) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  ngOnInit(): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.route.paramMap.subscribe(<span class="function"><span class="params">params</span> =&gt;</span> &#123;</span><br><span class="line">      params.get(<span class="string">"name"</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="28-定义子孙级路由"><a href="#28-定义子孙级路由" class="headerlink" title="28.定义子孙级路由"></a>28.定义子孙级路由</h3><p>路由嵌套指的是如何定义子级路由。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    children: [</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">"introduce"</span>,</span><br><span class="line">        component: IntroduceComponent</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">"history"</span>,</span><br><span class="line">        component: HistoryComponent</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- about.component.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">app-layout</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>about works!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">routerLink</span>=<span class="string">"/about/introduce"</span>&gt;</span>公司简介<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">routerLink</span>=<span class="string">"/about/history"</span>&gt;</span>发展历史<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-outlet</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">app-layout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="29-路由命名插座"><a href="#29-路由命名插座" class="headerlink" title="29.路由命名插座"></a>29.路由命名插座</h3><p>将子级路由组件显示到不同的路由插座中。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  path: <span class="string">"about"</span>,</span><br><span class="line">  component: AboutComponent,</span><br><span class="line">  children: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">"introduce"</span>,</span><br><span class="line">      component: IntroduceComponent,</span><br><span class="line">      outlet: <span class="string">"left"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">"history"</span>,</span><br><span class="line">      component: HistoryComponent,</span><br><span class="line">      outlet: <span class="string">"right"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- about.component.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">app-layout</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>about works!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> <span class="attr">name</span>=<span class="string">"left"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> <span class="attr">name</span>=<span class="string">"right"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">app-layout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">    [<span class="attr">routerLink</span>]=<span class="string">"[</span></span></span><br><span class="line"><span class="tag"><span class="string">      '/about',</span></span></span><br><span class="line"><span class="tag"><span class="string">      &#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">        outlets: &#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">          left: ['introduce'],</span></span></span><br><span class="line"><span class="tag"><span class="string">          right: ['history']</span></span></span><br><span class="line"><span class="tag"><span class="string">        &#125;</span></span></span><br><span class="line"><span class="tag"><span class="string">      &#125;</span></span></span><br><span class="line"><span class="tag"><span class="string">    ]"</span></span></span><br><span class="line"><span class="tag">    &gt;</span>关于我们</span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="30-导航路由"><a href="#30-导航路由" class="headerlink" title="30.导航路由"></a>30.导航路由</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- app.component.html --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"jump()"</span>&gt;</span>跳转到发展历史<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.component.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Router &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeComponent</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(private router: Router) &#123;&#125;</span><br><span class="line">  jump() &#123;</span><br><span class="line">    <span class="keyword">this</span>.router.navigate([<span class="string">"/about/history"</span>], &#123;</span><br><span class="line">      queryParams: &#123;</span><br><span class="line">        name: <span class="string">"Kitty"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="31-创建路由模块独立路由规则"><a href="#31-创建路由模块独立路由规则" class="headerlink" title="31.创建路由模块独立路由规则"></a>31.创建路由模块独立路由规则</h3><p>将根模块中的路由配置抽象成一个单独的路由模块，称之为根路由模块，然后在根模块中引入根路由模块。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; HomeComponent &#125; <span class="keyword">from</span> <span class="string">"./pages/home/home.component"</span></span><br><span class="line"><span class="keyword">import</span> &#123; NotFoundComponent &#125; <span class="keyword">from</span> <span class="string">"./pages/not-found/not-found.component"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"**"</span>,</span><br><span class="line">    component: NotFoundComponent</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  declarations: [],</span><br><span class="line">  imports: [RouterModule.forRoot(routes, &#123; <span class="attr">useHash</span>: <span class="literal">true</span> &#125;)],</span><br><span class="line">  <span class="comment">// 导出 Angular 路由功能模块，因为在根模块的根组件中使用了 RouterModule 模块中提供的路由插座组件</span></span><br><span class="line">  exports: [RouterModule]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppRoutingModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BrowserModule &#125; <span class="keyword">from</span> <span class="string">"@angular/platform-browser"</span></span><br><span class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"><span class="keyword">import</span> &#123; AppComponent &#125; <span class="keyword">from</span> <span class="string">"./app.component"</span></span><br><span class="line"><span class="keyword">import</span> &#123; AppRoutingModule &#125; <span class="keyword">from</span> <span class="string">"./app-routing.module"</span></span><br><span class="line"><span class="keyword">import</span> &#123; HomeComponent &#125; <span class="keyword">from</span> <span class="string">"./pages/home/home.component"</span></span><br><span class="line"><span class="keyword">import</span> &#123; NotFoundComponent &#125; <span class="keyword">from</span> <span class="string">"./pages/not-found/not-found.component"</span></span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  declarations: [AppComponent，HomeComponent, NotFoundComponent],</span><br><span class="line">  imports: [BrowserModule, AppRoutingModule],</span><br><span class="line">  providers: [],</span><br><span class="line">  bootstrap: [AppComponent]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="32-实现路由模块懒加载"><a href="#32-实现路由模块懒加载" class="headerlink" title="32.实现路由模块懒加载"></a>32.实现路由模块懒加载</h3><p>路由懒加载是以模块为单位的。</p>
<ol>
<li><p>创建用户模块 <code>ng g m user --routing=true</code> 一并创建该模块的路由模块</p>
</li>
<li><p>创建登录页面组件 <code>ng g c user/pages/login</code></p>
</li>
<li><p>创建注册页面组件 <code>ng g c user/pages/register</code></p>
</li>
<li><p>配置用户模块的路由规则</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"><span class="keyword">import</span> &#123; Routes, RouterModule &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"><span class="keyword">import</span> &#123; LoginComponent &#125; <span class="keyword">from</span> <span class="string">"./pages/login/login.component"</span></span><br><span class="line"><span class="keyword">import</span> &#123; RegisterComponent &#125; <span class="keyword">from</span> <span class="string">"./pages/register/register.component"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"login"</span>,</span><br><span class="line">    component: LoginComponent</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"register"</span>,</span><br><span class="line">    component: RegisterComponent</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  imports: [RouterModule.forChild(routes)],</span><br><span class="line">  exports: [RouterModule]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserRoutingModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将用户路由模块关联到主路由模块</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app-routing.module.ts</span></span><br><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"user"</span>,</span><br><span class="line">    loadChildren: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">"./user/user.module"</span>).then(<span class="function"><span class="params">m</span> =&gt;</span> m.UserModule)</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>在导航组件中添加访问链接</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">routerLink</span>=<span class="string">"/user/login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">routerLink</span>=<span class="string">"/user/register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="33-路由守卫-CanActivate"><a href="#33-路由守卫-CanActivate" class="headerlink" title="33.路由守卫 CanActivate"></a>33.路由守卫 CanActivate</h3><p>路由守卫会告诉路由是否允许导航到请求的路由。</p>
<p>路由守方法可以返回 boolean 或 Observable &lt;boolean&gt; 或 Promise &lt;boolean&gt;，它们在将来的某个时间点解析为布尔值。</p>
<blockquote>
<p>CanActivate</p>
</blockquote>
<p>检查用户是否可以访问某一个路由。</p>
<p>CanActivate 为接口，路由守卫类要实现该接口，该接口规定类中需要有 canActivate 方法，方法决定是否允许访问目标路由。</p>
<p>路由可以应用多个守卫，所有守卫方法都允许，路由才被允许访问，有一个守卫方法不允许，则路由不允许被访问。</p>
<p>创建路由守卫：<code>ng g guard guards/auth</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Injectable &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"><span class="keyword">import</span> &#123; CanActivate, ActivatedRouteSnapshot, RouterStateSnapshot, UrlTree, Router &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"><span class="keyword">import</span> &#123; Observable &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line">@Injectable(&#123;</span><br><span class="line">  providedIn: <span class="string">"root"</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthGuard</span> <span class="title">implements</span> <span class="title">CanActivate</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(private router: Router) &#123;&#125;</span><br><span class="line">  canActivate(): boolean | UrlTree &#123;</span><br><span class="line">    <span class="comment">// 用于实现跳转</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.router.createUrlTree([<span class="string">"/user/login"</span>])</span><br><span class="line">    <span class="comment">// 禁止访问目标路由</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment">// 允许访问目标路由</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  path: <span class="string">"about"</span>,</span><br><span class="line">  component: AboutComponent,</span><br><span class="line">  canActivate: [AuthGuard]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="34-路由守卫-CanActiveChild"><a href="#34-路由守卫-CanActiveChild" class="headerlink" title="34.路由守卫 CanActiveChild"></a>34.路由守卫 CanActiveChild</h3><p>检查用户是否方可访问某个子路由。</p>
<p>创建路由守卫：<code>ng g guard guards/admin</code> 注意：选择 CanActivateChild，需要将箭头移动到这个选项并且敲击空格确认选择。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Injectable &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"><span class="keyword">import</span> &#123; CanActivateChild, ActivatedRouteSnapshot, RouterStateSnapshot, UrlTree &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"><span class="keyword">import</span> &#123; Observable &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line">@Injectable(&#123;</span><br><span class="line">  providedIn: <span class="string">"root"</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AdminGuard</span> <span class="title">implements</span> <span class="title">CanActivateChild</span> </span>&#123;</span><br><span class="line">  canActivateChild(): boolean | UrlTree &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  path: <span class="string">"about"</span>,</span><br><span class="line">  component: AboutComponent,</span><br><span class="line">  canActivateChild: [AdminGuard],</span><br><span class="line">  children: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">"introduce"</span>,</span><br><span class="line">      component: IntroduceComponent</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="35-路由守卫-CanDeactivate"><a href="#35-路由守卫-CanDeactivate" class="headerlink" title="35.路由守卫 CanDeactivate"></a>35.路由守卫 CanDeactivate</h3><p>检查用户是否可以退出路由。比如用户在表单中输入的内容没有保存，用户又要离开路由，此时可以调用该守卫提示用户。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Injectable &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  CanDeactivate,</span><br><span class="line">  ActivatedRouteSnapshot,</span><br><span class="line">  RouterStateSnapshot,</span><br><span class="line">  UrlTree</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"><span class="keyword">import</span> &#123; Observable &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> interface CanComponentLeave &#123;</span><br><span class="line">  canLeave: <span class="function"><span class="params">()</span> =&gt;</span> boolean</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Injectable(&#123;</span><br><span class="line">  providedIn: <span class="string">"root"</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UnsaveGuard</span> <span class="title">implements</span> <span class="title">CanDeactivate</span>&lt;<span class="title">CanComponentLeave</span>&gt; </span>&#123;</span><br><span class="line">  canDeactivate(component: CanComponentLeave): boolean &#123;</span><br><span class="line">    <span class="keyword">if</span> (component.canLeave()) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  path: <span class="string">""</span>,</span><br><span class="line">  component: HomeComponent,</span><br><span class="line">  canDeactivate: [UnsaveGuard]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; CanComponentLeave &#125; <span class="keyword">from</span> <span class="string">"src/app/guards/unsave.guard"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeComponent</span> <span class="title">implements</span> <span class="title">CanComponentLeave</span> </span>&#123;</span><br><span class="line">  myForm: FormGroup = <span class="keyword">new</span> FormGroup(&#123;</span><br><span class="line">    username: <span class="keyword">new</span> FormControl()</span><br><span class="line">  &#125;)</span><br><span class="line">  canLeave(): boolean &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.myForm.dirty) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">window</span>.confirm(<span class="string">"有数据未保存, 确定要离开吗"</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="36-路由守卫-Resolve"><a href="#36-路由守卫-Resolve" class="headerlink" title="36.路由守卫 Resolve"></a>36.路由守卫 Resolve</h3><p>允许在进入路由之前先获取数据，待数据获取完成之后再进入路由。</p>
<p><code>ng g resolver &lt;name&gt;</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Injectable &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"><span class="keyword">import</span> &#123; Resolve &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line">type returnType = <span class="built_in">Promise</span>&lt;&#123; <span class="attr">name</span>: string &#125;&gt;</span><br><span class="line"></span><br><span class="line">@Injectable(&#123;</span><br><span class="line">  providedIn: <span class="string">"root"</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">ResolveGuard</span> <span class="title">implements</span> <span class="title">Resolve</span>&lt;<span class="title">returnType</span>&gt; </span>&#123;</span><br><span class="line">  resolve(): returnType &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">      setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        resolve(&#123; <span class="attr">name</span>: <span class="string">"张三"</span> &#125;)</span><br><span class="line">      &#125;, <span class="number">2000</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   path: <span class="string">""</span>,</span><br><span class="line">   component: HomeComponent,</span><br><span class="line">   resolve: &#123;</span><br><span class="line">     user: ResolveGuard</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeComponent</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(private route: ActivatedRoute) &#123;&#125;</span><br><span class="line">  ngOnInit(): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.route.snapshot.data.user)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="任务三：Angular-高级"><a href="#任务三：Angular-高级" class="headerlink" title="任务三：Angular 高级"></a>任务三：Angular 高级</h2><h3 id="1-RxJS快速入门"><a href="#1-RxJS快速入门" class="headerlink" title="1.RxJS快速入门"></a>1.RxJS快速入门</h3><blockquote>
<p>概述</p>
</blockquote>
<img src="./images/65.png" align="left" width="120"/>

<blockquote>
<p>什么是 RxJS ?</p>
</blockquote>
<p>RxJS 是一个用于处理异步编程的  JavaScript 库，目标是使编写异步和基于回调的代码更容易。</p>
<blockquote>
<p>为什么要学习 RxJS ?</p>
</blockquote>
<p>就像 Angular 深度集成 TypeScript 一样，Angular 也深度集成了 RxJS。</p>
<p>服务、表单、事件、全局状态管理、异步请求 …</p>
<blockquote>
<p>快速入门</p>
</blockquote>
<ol>
<li><p>可观察对象  ( Observable ) ：类比 Promise 对象，内部可以用于执行异步代码，通过调用内部提供的方法将异步代码执行的结果传递到可观察对象外部。</p>
</li>
<li><p>观察者 ( Observer )：类比 then 方法中的回调函数，用于接收可观察对象中传递出来数据。</p>
</li>
<li><p>订阅 ( subscribe )：类比 then 方法，通过订阅将可观察对象和观察者连接起来，当可观察对象发出数据时，订阅者可以接收到数据。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Observable &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> observable = <span class="keyword">new</span> Observable(<span class="function"><span class="keyword">function</span> (<span class="params">observer</span>) </span>&#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    observer.next(&#123;</span><br><span class="line">      name: <span class="string">"张三"</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, <span class="number">2000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> observer = &#123;</span><br><span class="line">  next: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">observable.subscribe(observer)</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="2-可观察对象特性介绍"><a href="#2-可观察对象特性介绍" class="headerlink" title="2.可观察对象特性介绍"></a>2.可观察对象特性介绍</h3><ol>
<li><p>在 Observable 对象内部可以多次调用 next 方法向外发送数据。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> observable = <span class="keyword">new</span> Observable(<span class="function"><span class="keyword">function</span> (<span class="params">observer</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> index = <span class="number">0</span></span><br><span class="line">  setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    observer.next(index++)</span><br><span class="line">  &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> observer = &#123;</span><br><span class="line">  next: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">observable.subscribe(observer)</span><br></pre></td></tr></table></figure>
</li>
<li><p>当所有数据发送完成以后，可以调用 complete 方法终止数据发送。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> observable = <span class="keyword">new</span> Observable(<span class="function"><span class="keyword">function</span> (<span class="params">observer</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> index = <span class="number">0</span></span><br><span class="line">  <span class="keyword">let</span> timer = setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    observer.next(index++)</span><br><span class="line">    <span class="keyword">if</span> (index === <span class="number">3</span>) &#123;</span><br><span class="line">      observer.complete()</span><br><span class="line">      clearInterval(timer)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> observer = &#123;</span><br><span class="line">  next: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">  &#125;,</span><br><span class="line">  complete: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"数据发送完成"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">observable.subscribe(observer)</span><br></pre></td></tr></table></figure>
</li>
<li><p>当 Observable 内部逻辑发生错误时，可以调用 error 方法将失败信息发送给订阅者，Observable 终止。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Observable &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> observable = <span class="keyword">new</span> Observable(<span class="function"><span class="keyword">function</span> (<span class="params">observer</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> index = <span class="number">0</span></span><br><span class="line">  <span class="keyword">let</span> timer = setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    observer.next(index++)</span><br><span class="line">    <span class="keyword">if</span> (index === <span class="number">3</span>) &#123;</span><br><span class="line">      observer.error(<span class="string">"发生错误"</span>)</span><br><span class="line">      clearInterval(timer)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> observer = &#123;</span><br><span class="line">  next: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value)</span><br><span class="line">  &#125;,</span><br><span class="line">  error: <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">observable.subscribe(observer)</span><br></pre></td></tr></table></figure>
</li>
<li><p>可观察对象是惰性的，只有被订阅后才会执行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> observable = <span class="keyword">new</span> Observable(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"Hello RxJS"</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// observable.subscribe()</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>可观察对象可以有 n 多订阅者，每次被订阅时都会得到执行</p>
<img src="./images/64.png" align="left"/>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> observable = <span class="keyword">new</span> Observable(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"Hello RxJS"</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">observable.subscribe()</span><br><span class="line">observable.subscribe()</span><br><span class="line">observable.subscribe()</span><br><span class="line">observable.subscribe()</span><br><span class="line">observable.subscribe()</span><br></pre></td></tr></table></figure>
</li>
<li><p>取消订阅</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obs = interval(<span class="number">1000</span>)</span><br><span class="line"><span class="keyword">const</span> subscription = obs.subscribe(<span class="built_in">console</span>.log)</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  subscription.unsubscribe()</span><br><span class="line">&#125;, <span class="number">2000</span>)</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="3-使用Subject构造函数创建可观察对象"><a href="#3-使用Subject构造函数创建可观察对象" class="headerlink" title="3.使用Subject构造函数创建可观察对象"></a>3.使用Subject构造函数创建可观察对象</h3><ol>
<li><p>用于创建空的可观察对象，在订阅后不会立即执行，next 方法可以在可观察对象外部调用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Subject &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> demoSubject = <span class="keyword">new</span> Subject()</span><br><span class="line"></span><br><span class="line">demoSubject.subscribe(&#123;<span class="attr">next</span>: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;<span class="built_in">console</span>.log(value)&#125;&#125;)</span><br><span class="line">demoSubject.subscribe(&#123;<span class="attr">next</span>: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;<span class="built_in">console</span>.log(value)&#125;&#125;)</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  demoSubject.next(<span class="string">"hahaha"</span>)</span><br><span class="line">&#125;, <span class="number">3000</span>)</span><br></pre></td></tr></table></figure>
<h3 id="4-使用BehaviorSubject创建可观察对象"><a href="#4-使用BehaviorSubject创建可观察对象" class="headerlink" title="4.使用BehaviorSubject创建可观察对象"></a>4.使用BehaviorSubject创建可观察对象</h3></li>
</ol>
<p>拥有 Subject 全部功能，但是在创建 Obervable 对象时可以传入默认值，观察者订阅后可以直接拿到默认值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BehaviorSubject &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> demoBehavior = <span class="keyword">new</span> BehaviorSubject(<span class="string">"默认值"</span>)</span><br><span class="line">demoBehavior.subscribe(&#123;<span class="attr">next</span>: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;<span class="built_in">console</span>.log(value)&#125;&#125;)</span><br><span class="line">demoBehavior.next(<span class="string">"Hello"</span>)</span><br></pre></td></tr></table></figure>

<h3 id="5-使用ReplaySubject创建可观察对象"><a href="#5-使用ReplaySubject创建可观察对象" class="headerlink" title="5.使用ReplaySubject创建可观察对象"></a>5.使用ReplaySubject创建可观察对象</h3><p>功能类似 Subject，但有新订阅者时两者处理方式不同，Subject 不会广播历史结果，而 ReplaySubject 会广播所有历史结果。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ReplaySubject &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rSubject = <span class="keyword">new</span> ReplaySubject()</span><br><span class="line"></span><br><span class="line">rSubject.subscribe(<span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">rSubject.next(<span class="string">"Hello 1"</span>)</span><br><span class="line">rSubject.next(<span class="string">"Hello 2"</span>)</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  rSubject.subscribe(&#123;<span class="attr">next</span>: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;<span class="built_in">console</span>.log(value)&#125;&#125;)</span><br><span class="line">&#125;, <span class="number">3000</span>)</span><br></pre></td></tr></table></figure>

<h3 id="6-数据流、操作符介绍"><a href="#6-数据流、操作符介绍" class="headerlink" title="6.数据流、操作符介绍"></a>6.数据流、操作符介绍</h3><blockquote>
<p>操作符</p>
</blockquote>
<ul>
<li>数据流：从可观察对象内部输出的数据就是数据流，可观察对象内部可以向外部源源不断的输出数据。</li>
<li>操作符：用于操作数据流，可以对象数据流进行转换，过滤等等操作。</li>
</ul>
<ol>
<li>map、mapTo</li>
</ol>
<p><strong>map：</strong>对数据流进行转换，基于原有值进行转换。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; map &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">interval(<span class="number">1000</span>)</span><br><span class="line">  .pipe(map(<span class="function"><span class="params">n</span> =&gt;</span> n * <span class="number">2</span>))</span><br><span class="line">  .subscribe(<span class="function"><span class="params">n</span> =&gt;</span> <span class="built_in">console</span>.log(n))</span><br></pre></td></tr></table></figure>

<p><strong>mapTo：</strong>对数据流进行转换，不关心原有值，可以直接传入要转换后的值。</p>
<img src="./images/14.png" width="80%" align="left"/>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; mapTo &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">interval(<span class="number">1000</span>)</span><br><span class="line">  .pipe(mapTo(&#123; <span class="attr">msg</span>: <span class="string">"接收到了数据流"</span> &#125;))</span><br><span class="line">  .subscribe(<span class="function"><span class="params">msg</span> =&gt;</span> <span class="built_in">console</span>.log(msg))</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>filter</li>
</ol>
<p>对数据流进行过滤。</p>
<img src="./images/15.png" width="80%" align="left"/>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; range &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; filter &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">range(<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line">  .pipe(filter(<span class="function"><span class="params">n</span> =&gt;</span> n % <span class="number">2</span> === <span class="number">0</span>))</span><br><span class="line">  .subscribe(<span class="function"><span class="params">even</span> =&gt;</span> <span class="built_in">console</span>.log(even))</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>pluck</li>
</ol>
<p>获取数据流对象中的属性值。</p>
<img src="./images/16.png" width="80%" align="left"/>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; pluck, mapTo &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">interval(<span class="number">1000</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">  	mapTo(&#123; <span class="attr">name</span>: <span class="string">"张三"</span>, <span class="attr">a</span>: &#123; <span class="attr">b</span>: <span class="string">"c"</span> &#125; &#125;), </span><br><span class="line">  	pluck(<span class="string">"a"</span>, <span class="string">"b"</span>)</span><br><span class="line">	)</span><br><span class="line">  .subscribe(<span class="function"><span class="params">n</span> =&gt;</span> <span class="built_in">console</span>.log(n))</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>first</li>
</ol>
<p>获取数据流中的第一个值或者查找数据流中第一个符合条件的值，类似数组中的 find 方法。获取到值以后终止行为。</p>
<img src="./images/17.png" width="80%" align="left"/>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; first &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">interval(<span class="number">1000</span>)</span><br><span class="line">  .pipe(first())</span><br><span class="line">  .subscribe(<span class="function"><span class="params">n</span> =&gt;</span> <span class="built_in">console</span>.log(n))</span><br><span class="line"></span><br><span class="line">interval(<span class="number">1000</span>)</span><br><span class="line">  .pipe(first(<span class="function"><span class="params">n</span> =&gt;</span> n === <span class="number">3</span>))</span><br><span class="line">  .subscribe(<span class="function"><span class="params">n</span> =&gt;</span> <span class="built_in">console</span>.log(n))</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>startWith</li>
</ol>
<p>创建一个新的 observable 对象并将参数值发送出去，然后再发送源 observable 对象发出的值。</p>
<p>在异步编程中提供默认值的时候非常有用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; map, startWith &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">interval(<span class="number">1000</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    map(<span class="function"><span class="params">n</span> =&gt;</span> n + <span class="number">100</span>),</span><br><span class="line">    startWith(<span class="number">505</span>)</span><br><span class="line">  )</span><br><span class="line">  .subscribe(<span class="function"><span class="params">n</span> =&gt;</span> <span class="built_in">console</span>.log(n))</span><br><span class="line"><span class="comment">// 505</span></span><br><span class="line"><span class="comment">// 100</span></span><br><span class="line"><span class="comment">// 101</span></span><br><span class="line"><span class="comment">// 102</span></span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>

<ol start="6">
<li>every</li>
</ol>
<p>查看数据流中的每个值是否都符合条件，返回布尔值。类似数组中的 every 方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; range &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; every, map &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">range(<span class="number">1</span>, <span class="number">9</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    map(<span class="function"><span class="params">n</span> =&gt;</span> n * <span class="number">2</span>),</span><br><span class="line">    every(<span class="function"><span class="params">n</span> =&gt;</span> n % <span class="number">2</span> === <span class="number">0</span>)</span><br><span class="line">  )</span><br><span class="line">  .subscribe(<span class="function"><span class="params">b</span> =&gt;</span> <span class="built_in">console</span>.log(b))</span><br></pre></td></tr></table></figure>

<ol start="7">
<li>delay、delayWhen</li>
</ol>
<p><strong>delay：</strong>对上一环节的操作整体进行延迟，只执行一次。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">from</span> &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; delay, map, tap &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">  .pipe(</span><br><span class="line">    delay(<span class="number">1000</span>),</span><br><span class="line">    tap(<span class="function"><span class="params">n</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"已经延迟 1s"</span>, n)),</span><br><span class="line">    map(<span class="function"><span class="params">n</span> =&gt;</span> n * <span class="number">2</span>),</span><br><span class="line">    delay(<span class="number">1000</span>),</span><br><span class="line">    tap(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"又延迟了 1s"</span>))</span><br><span class="line">  )</span><br><span class="line">  .subscribe(<span class="built_in">console</span>.log)</span><br><span class="line"></span><br><span class="line"><span class="comment">// tap 操作符不会对数据流造成影响, 它被用来执行简单的副作用, 比如输出, 但是复杂的副作用不要在这执行, 比如 Ajax</span></span><br></pre></td></tr></table></figure>

<p><strong>delayWhen：</strong>对上一环节的操作进行延迟，上一环节发出多少数据流，传入的回调函数就会执行多次。</p>
<img src="./images/20.png" width="80%" align="left"/>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; range, timer &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; delayWhen &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">range(<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    delayWhen(<span class="function"><span class="params">n</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(n)</span><br><span class="line">      <span class="keyword">return</span> timer(n * <span class="number">1000</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">  .subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<ol start="8">
<li>take、takeWhile、takeUtil</li>
</ol>
<p><strong>take</strong>：获取数据流中的前几个</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; range &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; take &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">range(<span class="number">1</span>, <span class="number">10</span>).pipe(take(<span class="number">5</span>)).subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<p><strong>takeWhile：</strong>根据条件从数据源前面开始获取。</p>
<img src="./images/22.png" width="80%" align="left"/>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; range &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; takeWhile &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">range(<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line">  .pipe(takeWhile(<span class="function"><span class="params">n</span> =&gt;</span> n &lt; <span class="number">8</span>))</span><br><span class="line">  .subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<p><strong>takeUntil：</strong>接收可观察对象，当可观察对象发出值时，终止主数据源。</p>
<img src="./images/23.png" width="80%" align="left"/>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; interval, timer &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; takeUntil &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">interval(<span class="number">100</span>)</span><br><span class="line">  .pipe(takeUntil(timer(<span class="number">2000</span>)))</span><br><span class="line">  .subscribe(<span class="built_in">console</span>.log)</span><br><span class="line"><span class="comment">// 结果少两个数据流的原因：第一次和最后一次，都需要延迟 100 毫秒。</span></span><br></pre></td></tr></table></figure>

<ol start="9">
<li>skip、skipWhile、skipUntil</li>
</ol>
<p><strong>skip：</strong>跳过前几个数据流。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; range &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; skip &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">range(<span class="number">1</span>, <span class="number">10</span>).pipe(skip(<span class="number">5</span>)).subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<p><strong>skipWhile：</strong>根据条件进行数据流的跳过。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; range &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; skipWhile &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">range(<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line">  .pipe(skipWhile(<span class="function"><span class="params">n</span> =&gt;</span> n &lt; <span class="number">5</span>))</span><br><span class="line">  .subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<p><strong>skipUntil：</strong>跳过数据源中前多少时间发出的数据流，发送从这个时间以后数据源中发送的数据流。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; timer, interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; skipUntil &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">interval(<span class="number">100</span>)</span><br><span class="line">  .pipe(skipUntil(timer(<span class="number">2000</span>)))</span><br><span class="line">  .subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<ol start="10">
<li>last</li>
</ol>
<p>获取数据流中的最后一个。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; range &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; last &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">range(<span class="number">1</span>, <span class="number">10</span>).pipe(last()).subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<p>如果数据源不变成完成状态，则没有最后一个。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; last, take &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">interval(<span class="number">1000</span>).pipe(take(<span class="number">5</span>), last()).subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<ol start="11">
<li>concatAll、concatMap</li>
</ol>
<p><strong>concatAll：</strong>有时 Observable 发出的又是一个 Obervable，concatAll 的作用就是将新的可观察对象和数据源进行合并。</p>
<p>Observable =&gt; [1, 2, 3]</p>
<p>Observable =&gt; [Observable, Observable]</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fromEvent, interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; map, take, concatAll &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">fromEvent(<span class="built_in">document</span>, <span class="string">"click"</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    map(<span class="function"><span class="params">event</span> =&gt;</span> interval(<span class="number">1000</span>).pipe(take(<span class="number">2</span>))),</span><br><span class="line">    concatAll()</span><br><span class="line">  )</span><br><span class="line">  .subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; map, concatAll &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">of</span>, interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line">interval(<span class="number">1000</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    map(<span class="function"><span class="params">val</span> =&gt;</span> <span class="keyword">of</span>(val + <span class="number">10</span>)),</span><br><span class="line">    concatAll()</span><br><span class="line">  )</span><br><span class="line">  .subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<p><strong>concatMap：</strong>合并可观察对象并处理其发出的数据流。</p>
<ol start="12">
<li>reduce、scan</li>
</ol>
<p><strong>reduce</strong>: 类似 JavaScript 数组中的 reduce，对数数据进行累计操作。reduce 会等待数据源中的数据流发送完成后再执行，执行时 reduce 内部遍历每一个数据流进行累计操作，操作完成得到结果将结果作为数据流发出。</p>
<img src="./images/31.png" width="80%" align="left"/>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; take, reduce &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">interval(<span class="number">500</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    take(<span class="number">5</span>),</span><br><span class="line">    reduce(<span class="function">(<span class="params">acc, value</span>) =&gt;</span> acc += value, <span class="number">0</span>)</span><br><span class="line">  )</span><br><span class="line">  .subscribe(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log())</span><br></pre></td></tr></table></figure>

<p><strong>scan</strong>：类似 reduce，进行累计操作，但执行时机不同，数据源每次发出数据流 scan 都会执行。reduce 是发送出最终计算的结果，而 scan 是发出每次计算的结果。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; take, scan &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">interval(<span class="number">500</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    take(<span class="number">5</span>),</span><br><span class="line">    scan(<span class="function">(<span class="params">acc, value</span>) =&gt;</span> acc += value, <span class="number">0</span>)</span><br><span class="line">  )</span><br><span class="line">  .subscribe(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log())</span><br></pre></td></tr></table></figure>

<ol start="13">
<li>mergeAll、mergeMap</li>
</ol>
<p><strong>mergeAll：</strong>交叉合并可观察对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fromEvent, interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; map, mergeAll &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">fromEvent(<span class="built_in">document</span>, <span class="string">"click"</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    map(<span class="function"><span class="params">()</span> =&gt;</span> interval(<span class="number">1000</span>)),</span><br><span class="line">    mergeAll()</span><br><span class="line">  )</span><br><span class="line">  .subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<p><strong>mergeMap</strong>：交叉合并可观察对象以后对可观察对象发出的数据流进行转换。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">of</span>, interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; mergeMap, map &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">of</span>(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>)</span><br><span class="line">  .pipe(mergeMap(<span class="function"><span class="params">x</span> =&gt;</span> interval(<span class="number">1000</span>).pipe(map(<span class="function"><span class="params">i</span> =&gt;</span> x + i))))</span><br><span class="line">  .subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x))</span><br></pre></td></tr></table></figure>

<ol start="14">
<li>throttleTime</li>
</ol>
<p>节流，可观察对象高频次向外部发出数据流，通过 throttleTime 限制在规定时间内每次只向订阅者传递一次数据流。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fromEvent &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; throttleTime &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">fromEvent(<span class="built_in">document</span>, <span class="string">"click"</span>)</span><br><span class="line">  .pipe(throttleTime(<span class="number">2000</span>))</span><br><span class="line">  .subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x))</span><br></pre></td></tr></table></figure>

<ol start="15">
<li>debounceTime</li>
</ol>
<p>防抖，触发高频事件，只响应最后一次。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fromEvent &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; debounceTime &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">fromEvent(<span class="built_in">document</span>, <span class="string">"click"</span>)</span><br><span class="line">  .pipe(debounceTime(<span class="number">1000</span>))</span><br><span class="line">  .subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x))</span><br></pre></td></tr></table></figure>

<ol start="16">
<li>distinctUntilChanged</li>
</ol>
<p>检测数据源当前发出的数据流是否和上次发出的相同，如相同，跳过，不相同，发出。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">of</span> &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; distinctUntilChanged &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">of</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">  .pipe(distinctUntilChanged())</span><br><span class="line">  .subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x)) <span class="comment">// 1, 2, 1, 2, 3, 4</span></span><br></pre></td></tr></table></figure>

<ol start="17">
<li>groupBy</li>
</ol>
<p>对数据流进行分组。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">of</span> &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; mergeMap, groupBy, toArray &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">of</span>(</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Sue"</span>, <span class="attr">age</span>: <span class="number">25</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Joe"</span>, <span class="attr">age</span>: <span class="number">30</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Frank"</span>, <span class="attr">age</span>: <span class="number">25</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">"Sarah"</span>, <span class="attr">age</span>: <span class="number">35</span> &#125;</span><br><span class="line">)</span><br><span class="line">  .pipe(</span><br><span class="line">    groupBy(<span class="function"><span class="params">person</span> =&gt;</span> person.age),</span><br><span class="line">    mergeMap(<span class="function"><span class="params">group</span> =&gt;</span> group.pipe(toArray()))</span><br><span class="line">  )</span><br><span class="line">  .subscribe(<span class="built_in">console</span>.log)</span><br><span class="line"></span><br><span class="line"><span class="comment">// [&#123;name: "Sue", age: 25&#125;, &#123; name: "Frank", age: 25 &#125;]</span></span><br><span class="line"><span class="comment">// [&#123; name: "Joe", age: 30 &#125;]</span></span><br><span class="line"><span class="comment">// [&#123; name: "Sarah", age: 35 &#125;]</span></span><br></pre></td></tr></table></figure>

<ol start="18">
<li>withLatestFrom</li>
</ol>
<p>主数据源发出的数据流总是和支数据源中的最新数据流进行结合，返回数组。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fromEvent, interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; withLatestFrom &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> clicks = fromEvent(<span class="built_in">document</span>, <span class="string">"click"</span>)</span><br><span class="line"><span class="keyword">const</span> timer = interval(<span class="number">1000</span>)</span><br><span class="line">clicks.pipe(withLatestFrom(timer)).subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<ol start="19">
<li>switchMap</li>
</ol>
<p>切换可观察对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fromEvent, interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; switchMap &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">fromEvent(<span class="built_in">document</span>, <span class="string">"click"</span>)</span><br><span class="line">  .pipe(switchMap(<span class="function"><span class="params">ev</span> =&gt;</span> interval(<span class="number">1000</span>)))</span><br><span class="line">  .subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x))</span><br></pre></td></tr></table></figure>

<h3 id="7-辅助方法from"><a href="#7-辅助方法from" class="headerlink" title="7.辅助方法from"></a>7.辅助方法from</h3><blockquote>
<p>辅助方法</p>
</blockquote>
<ol>
<li>range</li>
</ol>
<p>range(start, length)，调用方法后返回 observable 对象，被订阅后会发出指定范围的数值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; range &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line">range(<span class="number">0</span>, <span class="number">5</span>).subscribe(<span class="function"><span class="params">n</span> =&gt;</span> <span class="built_in">console</span>.log(n))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 0</span></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="comment">// 4</span></span><br></pre></td></tr></table></figure>

<p>方法内部并不是一次发出 length 个数值，而是发送了 length 次，每次发送一个数值，就是说内部调用了 length 次 next 方法。</p>
<ol start="2">
<li>of</li>
</ol>
<p>将参数列表作为数据流返回。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">of</span>(<span class="string">"a"</span>, <span class="string">"b"</span>, [], &#123;&#125;, <span class="literal">true</span>, <span class="number">20</span>).subscribe(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v))</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>from</li>
</ol>
<p>将 Array，Promise, Iterator 转换为 observable 对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span>([<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>]).subscribe(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v))</span><br><span class="line"><span class="comment">// a</span></span><br><span class="line"><span class="comment">// b</span></span><br><span class="line"><span class="comment">// c</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">from</span> &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">p</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">    resolve([<span class="number">100</span>, <span class="number">200</span>])</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span>(p()).subscribe(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v))</span><br><span class="line"><span class="comment">// [100, 200]</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>interval、timer</li>
</ol>
<p><strong>Interval：</strong>每隔一段时间发出一个数值，数值递增</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line">interval(<span class="number">1000</span>).subscribe(<span class="function"><span class="params">n</span> =&gt;</span> <span class="built_in">console</span>.log(n))</span><br></pre></td></tr></table></figure>

<p><strong>timer：</strong>间隔时间过去以后发出数值，行为终止，或间隔时间发出数值后，继续按第二个参数的时间间隔继续发出值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; timer &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line">timer(<span class="number">2000</span>).subscribe(<span class="function"><span class="params">n</span> =&gt;</span> <span class="built_in">console</span>.log(n))</span><br><span class="line">timer(<span class="number">0</span>, <span class="number">1000</span>).subscribe(<span class="function"><span class="params">n</span> =&gt;</span> <span class="built_in">console</span>.log(n))</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>concat</li>
</ol>
<p>合并数据流，先让第一个数据流发出值，结束后再让第二个数据流发出值，进行整体合并。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; concat, range &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line">concat(range(<span class="number">1</span>, <span class="number">5</span>), range(<span class="number">6</span>, <span class="number">5</span>)).subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>merge</li>
</ol>
<p>合并数据流，多个参数一起发出数据流，按照时间线进行交叉合并。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; merge, fromEvent, interval &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> clicks = fromEvent(<span class="built_in">document</span>, <span class="string">"click"</span>)</span><br><span class="line"><span class="keyword">const</span> timer = interval(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">merge(clicks, timer).subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<ol start="7">
<li>combineLatest</li>
</ol>
<p>将两个 Obserable 中最新发出的数据流进行组合成新的数据流，以数组的形式发出。和当前最新的进行组合。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; combineLatest, timer &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> firstTimer = timer(<span class="number">0</span>, <span class="number">1000</span>) <span class="comment">// emit 0, 1, 2... after every second, starting from now</span></span><br><span class="line"><span class="keyword">const</span> secondTimer = timer(<span class="number">500</span>, <span class="number">1000</span>) <span class="comment">// emit 0, 1, 2... after every second, starting 0,5s from now</span></span><br><span class="line">combineLatest(firstTimer, secondTimer).subscribe(<span class="built_in">console</span>.log)</span><br><span class="line"></span><br><span class="line"><span class="comment">// [0, 0] after 0.5s</span></span><br><span class="line"><span class="comment">// [1, 0] after 1s</span></span><br><span class="line"><span class="comment">// [1, 1] after 1.5s</span></span><br><span class="line"><span class="comment">// [2, 1] after 2s</span></span><br></pre></td></tr></table></figure>

<ol start="8">
<li>zip</li>
</ol>
<p>将多个 Observable 中的数据流进行组合。和将来最新的进行组合。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; zip, <span class="keyword">of</span> &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; map &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> age = <span class="keyword">of</span>(<span class="number">27</span>, <span class="number">25</span>, <span class="number">29</span>)</span><br><span class="line"><span class="keyword">let</span> name = <span class="keyword">of</span>(<span class="string">"Foo"</span>, <span class="string">"Bar"</span>, <span class="string">"Beer"</span>)</span><br><span class="line"><span class="keyword">let</span> isDev = <span class="keyword">of</span>(<span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">zip(name, age, isDev)</span><br><span class="line">  .pipe(map(<span class="function">(<span class="params">[name, age, isDev]</span>) =&gt;</span> (&#123; name, age, isDev &#125;)))</span><br><span class="line">  .subscribe(<span class="built_in">console</span>.log)</span><br><span class="line"></span><br><span class="line"><span class="comment">// &#123; name: 'Foo', age: 27, isDev: true &#125;</span></span><br><span class="line"><span class="comment">// &#123; name: 'Bar', age: 25, isDev: true &#125;</span></span><br><span class="line"><span class="comment">// &#123; name: 'Beer', age: 29, isDev: false &#125;</span></span><br></pre></td></tr></table></figure>

<ol start="9">
<li>forkJoin</li>
</ol>
<p>forkJoin 是 Rx 版本的 Promise.all()，即表示等到所有的 Observable 都完成后，才一次性返回值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">"axios"</span></span><br><span class="line"><span class="keyword">import</span> &#123; forkJoin, <span class="keyword">from</span> &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line">axios.interceptors.response.use(<span class="function"><span class="params">response</span> =&gt;</span> response.data)</span><br><span class="line"></span><br><span class="line">forkJoin(&#123;</span><br><span class="line">  goods: <span class="keyword">from</span>(axios.get(<span class="string">"http://localhost:3005/goods"</span>)),</span><br><span class="line">  category: <span class="keyword">from</span>(axios.get(<span class="string">"http://localhost:3005/category"</span>))</span><br><span class="line">&#125;).subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<ol start="10">
<li>throwError</li>
</ol>
<p>返回可观察对象并向订阅者抛出错误。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; throwError &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line">throwError(<span class="string">"发生了未知错误"</span>).subscribe(&#123; <span class="attr">error</span>: <span class="built_in">console</span>.log &#125;)</span><br></pre></td></tr></table></figure>

<ol start="11">
<li>retry</li>
</ol>
<p>如果 Observable 对象抛出错误，则该辅助方法会重新订阅 Observable 以获取数据流，参数为重新订阅次数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; interval, <span class="keyword">of</span>, throwError &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; mergeMap, retry &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line">interval(<span class="number">1000</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    mergeMap(<span class="function"><span class="params">val</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (val &gt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> throwError(<span class="string">"Error!"</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">of</span>(val)</span><br><span class="line">    &#125;),</span><br><span class="line">    retry(<span class="number">2</span>)</span><br><span class="line">  )</span><br><span class="line">  .subscribe(&#123;</span><br><span class="line">    next: <span class="built_in">console</span>.log,</span><br><span class="line">    error: <span class="built_in">console</span>.log</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<ol start="12">
<li>race</li>
</ol>
<p>接收并同时执行多个可观察对象，只将最快发出的数据流传递给订阅者。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; race, timer &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; mapTo &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obs1 = timer(<span class="number">1000</span>).pipe(mapTo(<span class="string">"fast one"</span>))</span><br><span class="line"><span class="keyword">const</span> obs2 = timer(<span class="number">3000</span>).pipe(mapTo(<span class="string">"medium one"</span>))</span><br><span class="line"><span class="keyword">const</span> obs3 = timer(<span class="number">5000</span>).pipe(mapTo(<span class="string">"slow one"</span>))</span><br><span class="line"></span><br><span class="line">race(obs3, obs1, obs2).subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<ol start="13">
<li>fromEvent</li>
</ol>
<p>将事件转换为 Observable。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fromEvent &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">"btn"</span>)</span><br><span class="line"><span class="comment">// 可以将 Observer 简写成一个函数，表示 next</span></span><br><span class="line">fromEvent(btn, <span class="string">"click"</span>).subscribe(<span class="function"><span class="params">e</span> =&gt;</span> <span class="built_in">console</span>.log(e))</span><br></pre></td></tr></table></figure>

<h3 id="8-辅助方法forkJoin"><a href="#8-辅助方法forkJoin" class="headerlink" title="8.辅助方法forkJoin"></a>8.辅助方法forkJoin</h3><p>见上</p>
<h3 id="9-辅助方法fromEvent和操作符pluck"><a href="#9-辅助方法fromEvent和操作符pluck" class="headerlink" title="9.辅助方法fromEvent和操作符pluck"></a>9.辅助方法fromEvent和操作符pluck</h3><p>见上</p>
<h3 id="10-辅助方法interval和操作符switchMap"><a href="#10-辅助方法interval和操作符switchMap" class="headerlink" title="10.辅助方法interval和操作符switchMap"></a>10.辅助方法interval和操作符switchMap</h3><p>见上</p>
<h3 id="11-操作符take、takeWhile、takeUntil"><a href="#11-操作符take、takeWhile、takeUntil" class="headerlink" title="11.操作符take、takeWhile、takeUntil"></a>11.操作符take、takeWhile、takeUntil</h3><p>见上</p>
<h3 id="12-操作符节流和防抖"><a href="#12-操作符节流和防抖" class="headerlink" title="12.操作符节流和防抖"></a>12.操作符节流和防抖</h3><p>见上</p>
<h3 id="13-辅助方法of和操作符distinctUntilChanged"><a href="#13-辅助方法of和操作符distinctUntilChanged" class="headerlink" title="13.辅助方法of和操作符distinctUntilChanged"></a>13.辅助方法of和操作符distinctUntilChanged</h3><p>见上</p>
<h3 id="14-RxJS案例之元素拖拽"><a href="#14-RxJS案例之元素拖拽" class="headerlink" title="14.RxJS案例之元素拖拽"></a>14.RxJS案例之元素拖拽</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="selector-id">#box</span> &#123;</span></span><br><span class="line">    width: 200px;</span><br><span class="line">    height: 200px;</span><br><span class="line">    background: skyblue;</span><br><span class="line">    position: absolute;</span><br><span class="line">    left: 0;</span><br><span class="line">    top: 0;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"box"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原生 JavaScript</span></span><br><span class="line">box.onmousedown = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> distanceX = event.clientX - event.target.offsetLeft</span><br><span class="line">  <span class="keyword">let</span> distanceY = event.clientY - event.target.offsetTop</span><br><span class="line">  <span class="built_in">document</span>.onmousemove = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> positionX = event.clientX - distanceX</span><br><span class="line">    <span class="keyword">let</span> positionY = event.clientY - distanceY</span><br><span class="line">    box.style.left = positionX + <span class="string">"px"</span></span><br><span class="line">    box.style.top = positionY + <span class="string">"px"</span></span><br><span class="line">  &#125;</span><br><span class="line">  box.onmouseup = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.onmousemove = <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// RxJS</span></span><br><span class="line"><span class="keyword">import</span> &#123; fromEvent &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; map, switchMap, takeUntil &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> box = <span class="built_in">document</span>.getElementById(<span class="string">"box"</span>)</span><br><span class="line"></span><br><span class="line">fromEvent(box, <span class="string">"mousedown"</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    map(<span class="function"><span class="params">event</span> =&gt;</span> (&#123;</span><br><span class="line">      distanceX: event.clientX - event.target.offsetLeft,</span><br><span class="line">      distanceY: event.clientY - event.target.offsetTop</span><br><span class="line">    &#125;)),</span><br><span class="line">    switchMap(<span class="function">(<span class="params">&#123; distanceX, distanceY &#125;</span>) =&gt;</span></span><br><span class="line">      fromEvent(<span class="built_in">document</span>, <span class="string">"mousemove"</span>).pipe(</span><br><span class="line">        map(<span class="function"><span class="params">event</span> =&gt;</span> (&#123;</span><br><span class="line">          positionX: event.clientX - distanceX,</span><br><span class="line">          positionY: event.clientY - distanceY</span><br><span class="line">        &#125;)),</span><br><span class="line">        takeUntil(fromEvent(<span class="built_in">document</span>, <span class="string">"mouseup"</span>))</span><br><span class="line">      )</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line">  .subscribe(<span class="function">(<span class="params">&#123; positionX, positionY &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    box.style.left = positionX + <span class="string">"px"</span></span><br><span class="line">    box.style.top = positionY + <span class="string">"px"</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="15-搜索案例"><a href="#15-搜索案例" class="headerlink" title="15.搜索案例"></a>15.搜索案例</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"search"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"请输入搜索内容..."</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fromEvent, <span class="keyword">from</span>, throwError &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; debounceTime, distinctUntilChanged, map, switchMap, catchError &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">"axios"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> search = <span class="built_in">document</span>.getElementById(<span class="string">"search"</span>)</span><br><span class="line"></span><br><span class="line">fromEvent(search, <span class="string">"keyup"</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    debounceTime(<span class="number">700</span>),</span><br><span class="line">    map(<span class="function"><span class="params">event</span> =&gt;</span> event.target.value),</span><br><span class="line">    distinctUntilChanged(),</span><br><span class="line">    switchMap(<span class="function"><span class="params">keyword</span> =&gt;</span></span><br><span class="line">      <span class="keyword">from</span>(</span><br><span class="line">        axios.get(<span class="string">`https://j1sonplaceholder.typicode.com/posts?q=<span class="subst">$&#123;keyword&#125;</span>`</span>)</span><br><span class="line">      ).pipe(</span><br><span class="line">        map(<span class="function"><span class="params">response</span> =&gt;</span> response.data),</span><br><span class="line">        catchError(<span class="function"><span class="params">error</span> =&gt;</span> throwError(<span class="string">`发生了错误: <span class="subst">$&#123;error.message&#125;</span>`</span>))</span><br><span class="line">      )</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line">  .subscribe(&#123;</span><br><span class="line">    next: <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(value)</span><br><span class="line">    &#125;,</span><br><span class="line">    error: <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(error)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="16-案例之串联请求的发送"><a href="#16-案例之串联请求的发送" class="headerlink" title="16.案例之串联请求的发送"></a>16.案例之串联请求的发送</h3><p>先获取token，再根据token获取用户信息</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"btn"</span>&gt;</span>获取用户信息<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">"axios"</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">from</span>, fromEvent &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; pluck, concatMap &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> button = <span class="built_in">document</span>.getElementById(<span class="string">"btn"</span>)</span><br><span class="line"></span><br><span class="line">fromEvent(button, <span class="string">"click"</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    concatMap(<span class="function"><span class="params">event</span> =&gt;</span></span><br><span class="line">      <span class="keyword">from</span>(axios.get(<span class="string">"http://localhost:3005/token"</span>)).pipe(</span><br><span class="line">        pluck(<span class="string">"data"</span>, <span class="string">"token"</span>)</span><br><span class="line">      )</span><br><span class="line">    ),</span><br><span class="line">    concatMap(<span class="function"><span class="params">token</span> =&gt;</span></span><br><span class="line">      <span class="keyword">from</span>(axios.get(<span class="string">"http://localhost:3005/userInfo"</span>)).pipe(pluck(<span class="string">"data"</span>))</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line">  .subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<h3 id="17-HttpClientModule的基本使用"><a href="#17-HttpClientModule的基本使用" class="headerlink" title="17.HttpClientModule的基本使用"></a>17.HttpClientModule的基本使用</h3><p>该模块用于发送 Http 请求，用于发送请求的方法都返回 Observable 对象。</p>
<h4 id="1-快速开始"><a href="#1-快速开始" class="headerlink" title="1. 快速开始"></a>1. 快速开始</h4><ol>
<li><p>引入 HttpClientModule 模块</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.module.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; httpClientModule &#125; <span class="keyword">from</span> <span class="string">'@angular/common/http'</span>;</span><br><span class="line">imports: [</span><br><span class="line">  httpClientModule</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>注入 HttpClient 服务实例对象，用于发送请求</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.component.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; HttpClient &#125; <span class="keyword">from</span> <span class="string">'@angular/common/http'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">	<span class="keyword">constructor</span>(private http: HttpClient) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>发送请求</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HttpClient &#125; <span class="keyword">from</span> <span class="string">"@angular/common/http"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> <span class="title">implements</span> <span class="title">OnInit</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(private http: HttpClient) &#123;&#125;</span><br><span class="line">  ngOnInit() &#123;</span><br><span class="line">    <span class="keyword">this</span>.getUsers().subscribe(<span class="built_in">console</span>.log)</span><br><span class="line">  &#125;</span><br><span class="line">  getUsers() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.http.get(<span class="string">"https://jsonplaceholder.typicode.com/users"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="2-请求方法"><a href="#2-请求方法" class="headerlink" title="2. 请求方法"></a>2. 请求方法</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.http.get(url [, options]);</span><br><span class="line"><span class="keyword">this</span>.http.post(url, data [, options]);</span><br><span class="line"><span class="keyword">this</span>.http.delete(url [, options]);</span><br><span class="line"><span class="keyword">this</span>.http.put(url, data [, options]);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.http.get&lt;Post[]&gt;(<span class="string">'/getAllPosts'</span>)</span><br><span class="line">  .subscribe(<span class="function"><span class="params">response</span> =&gt;</span> <span class="built_in">console</span>.log(response))</span><br></pre></td></tr></table></figure>

<h3 id="18-HttpParams类的使用"><a href="#18-HttpParams类的使用" class="headerlink" title="18.HttpParams类的使用"></a>18.HttpParams类的使用</h3><ol>
<li><p>HttpParams 类</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> declare <span class="class"><span class="keyword">class</span> <span class="title">HttpParams</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(options?: HttpParamsOptions);</span><br><span class="line">    has(param: string): boolean;</span><br><span class="line">    <span class="keyword">get</span>(param: string): string | null;</span><br><span class="line">    getAll(param: string): string[] | null;</span><br><span class="line">    keys(): string[];</span><br><span class="line">    append(param: string, value: string): HttpParams;</span><br><span class="line">    <span class="keyword">set</span>(param: string, value: string): HttpParams;</span><br><span class="line">    delete(param: string, value?: string): HttpParams;</span><br><span class="line">    toString(): string;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>HttpParamsOptions 接口</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">declare interface HttpParamsOptions &#123;</span><br><span class="line">    fromString?: string;</span><br><span class="line">    fromObject?: &#123;</span><br><span class="line">        [param: string]: string | ReadonlyArray&lt;string&gt;;</span><br><span class="line">    &#125;;</span><br><span class="line">    encoder?: HttpParameterCodec;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用示例</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HttpParams &#125; <span class="keyword">from</span> <span class="string">'@angular/common/http'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> params = <span class="keyword">new</span> HttpParams(&#123; <span class="attr">fromObject</span>: &#123;<span class="attr">name</span>: <span class="string">"zhangsan"</span>, <span class="attr">age</span>: <span class="string">"20"</span>&#125;&#125;)</span><br><span class="line">params = params.append(<span class="string">"sex"</span>, <span class="string">"male"</span>)</span><br><span class="line"><span class="keyword">let</span> params = <span class="keyword">new</span> HttpParams(&#123; <span class="attr">fromString</span>: <span class="string">"name=zhangsan&amp;age=20"</span>&#125;)</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="19-HttpHeaders类的使用"><a href="#19-HttpHeaders类的使用" class="headerlink" title="19.HttpHeaders类的使用"></a>19.HttpHeaders类的使用</h3><p>请求头字段的创建需要使用 HttpHeaders 类，在类实例对象下面有各种操作请求头的方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> declare <span class="class"><span class="keyword">class</span> <span class="title">HttpHeaders</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(headers?: string | &#123;</span><br><span class="line">        [name: string]: string | string[];</span><br><span class="line">    &#125;);</span><br><span class="line">    has(name: string): boolean;</span><br><span class="line">    <span class="keyword">get</span>(name: string): string | null;</span><br><span class="line">    keys(): string[];</span><br><span class="line">    getAll(name: string): string[] | null;</span><br><span class="line">    append(name: string, value: string | string[]): HttpHeaders;</span><br><span class="line">    <span class="keyword">set</span>(name: string, value: string | string[]): HttpHeaders;</span><br><span class="line">    delete(name: string, value?: string | string[]): HttpHeaders;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> headers = <span class="keyword">new</span> HttpHeaders(&#123; <span class="attr">test</span>: <span class="string">"Hello"</span> &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="20-设置响应体"><a href="#20-设置响应体" class="headerlink" title="20.设置响应体"></a>20.设置响应体</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">declare type HttpObserve = <span class="string">'body'</span> | <span class="string">'response'</span>;</span><br><span class="line"><span class="comment">// response 读取完整响应体</span></span><br><span class="line"><span class="comment">// body 读取服务器端返回的数据</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.http.get(</span><br><span class="line">  <span class="string">"https://jsonplaceholder.typicode.com/users"</span>, </span><br><span class="line">  &#123; <span class="attr">observe</span>: <span class="string">"body"</span> &#125;</span><br><span class="line">).subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<h3 id="21-拦截器的使用-一"><a href="#21-拦截器的使用-一" class="headerlink" title="21.拦截器的使用(一)"></a>21.拦截器的使用(一)</h3><p>拦截器是 Angular 应用中全局捕获和修改 HTTP 请求和响应的方式。（Token、Error）<br>拦截器将只拦截使用 HttpClientModule 模块发出的请求。</p>
<p><code>ng g interceptor &lt;name&gt;</code></p>
<ol>
<li>请求拦截</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">@Injectable()</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthInterceptor</span> <span class="title">implements</span> <span class="title">HttpInterceptor</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;&#125;</span><br><span class="line">	<span class="comment">// 拦截方法</span></span><br><span class="line">  intercept(</span><br><span class="line">  	<span class="comment">// unknown 指定请求体 (body) 的类型</span></span><br><span class="line">    request: HttpRequest&lt;unknown&gt;,</span><br><span class="line">    next: HttpHandler</span><br><span class="line">     <span class="comment">// unknown 指定响应内容 (body) 的类型</span></span><br><span class="line">  ): Observable&lt;HttpEvent&lt;unknown&gt;&gt; &#123;</span><br><span class="line">    <span class="comment">// 克隆并修改请求头</span></span><br><span class="line">    <span class="keyword">const</span> req = request.clone(&#123;</span><br><span class="line">      setHeaders: &#123;</span><br><span class="line">        Authorization: <span class="string">"Bearer xxxxxxx"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 通过回调函数将修改后的请求头回传给应用</span></span><br><span class="line">    <span class="keyword">return</span> next.handle(req)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>响应拦截</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@Injectable() </span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthInterceptor</span> <span class="title">implements</span> <span class="title">HttpInterceptor</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;&#125;</span><br><span class="line">	<span class="comment">// 拦截方法</span></span><br><span class="line">  intercept(</span><br><span class="line">    request: HttpRequest&lt;unknown&gt;,</span><br><span class="line">    next: HttpHandler</span><br><span class="line">  ): Observable&lt;any&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> next.handle(request).pipe(</span><br><span class="line">      retry(<span class="number">2</span>),</span><br><span class="line">      catchError(<span class="function">(<span class="params">error: HttpErrorResponse</span>) =&gt;</span> throwError(error))</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="22-拦截器的使用-二"><a href="#22-拦截器的使用-二" class="headerlink" title="22.拦截器的使用(二)"></a>22.拦截器的使用(二)</h3><blockquote>
<p>拦截器注入</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; AuthInterceptor &#125; <span class="keyword">from</span> <span class="string">"./auth.interceptor"</span></span><br><span class="line"><span class="keyword">import</span> &#123; HTTP_INTERCEPTORS &#125; <span class="keyword">from</span> <span class="string">"@angular/common/http"</span></span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  providers: [</span><br><span class="line">    &#123;</span><br><span class="line">      provide: HTTP_INTERCEPTORS,</span><br><span class="line">      useClass: AuthInterceptor,</span><br><span class="line">      multi: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="23-配置AngularProxy"><a href="#23-配置AngularProxy" class="headerlink" title="23.配置AngularProxy"></a>23.配置AngularProxy</h3><ol>
<li><p>在项目的根目录下创建  proxy.conf.json 文件并加入如下代码</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> 	<span class="attr">"/api/*"</span>: &#123;</span><br><span class="line">    <span class="attr">"target"</span>: <span class="string">"http://localhost:3070"</span>,</span><br><span class="line">    <span class="attr">"secure"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"changeOrigin"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>/api/*：在应用中发出的以 /api 开头的请求走此代理</li>
<li>target：服务器端 URL</li>
<li>secure：如果服务器端 URL 的协议是 https，此项需要为 true</li>
<li>changeOrigin：如果服务器端不是 localhost， 此项需要为 true</li>
</ol>
</li>
<li><p>指定 proxy 配置文件 (方式一) </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">  <span class="string">"start"</span>: <span class="string">"ng serve --proxy-config proxy.conf.json"</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定 proxy 配置文件 (方式二)</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">"serve": &#123;</span><br><span class="line">  "options": &#123;</span><br><span class="line">    "proxyConfig": "proxy.conf.json"</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="24-NgRx概述"><a href="#24-NgRx概述" class="headerlink" title="24.NgRx概述"></a>24.NgRx概述</h3><h3 id="25-NgRx基本使用"><a href="#25-NgRx基本使用" class="headerlink" title="25.NgRx基本使用"></a>25.NgRx基本使用</h3><h3 id="26-selector的用法"><a href="#26-selector的用法" class="headerlink" title="26.selector的用法"></a>26.selector的用法</h3><h3 id="27-Action传递参数"><a href="#27-Action传递参数" class="headerlink" title="27.Action传递参数"></a>27.Action传递参数</h3><h3 id="28-metaReducer机制介绍"><a href="#28-metaReducer机制介绍" class="headerlink" title="28.metaReducer机制介绍"></a>28.metaReducer机制介绍</h3><h3 id="29-使用Effect接收Action执行副作用"><a href="#29-使用Effect接收Action执行副作用" class="headerlink" title="29.使用Effect接收Action执行副作用"></a>29.使用Effect接收Action执行副作用</h3><h3 id="30-ngrx案例todo之添加任务"><a href="#30-ngrx案例todo之添加任务" class="headerlink" title="30.ngrx案例todo之添加任务"></a>30.ngrx案例todo之添加任务</h3><h3 id="31-案例todo之展示任务"><a href="#31-案例todo之展示任务" class="headerlink" title="31.案例todo之展示任务"></a>31.案例todo之展示任务</h3><h3 id="32-案例todo之删除任务"><a href="#32-案例todo之删除任务" class="headerlink" title="32.案例todo之删除任务"></a>32.案例todo之删除任务</h3><h3 id="33-在todo案例中加入Entity简化实体操作"><a href="#33-在todo案例中加入Entity简化实体操作" class="headerlink" title="33.在todo案例中加入Entity简化实体操作"></a>33.在todo案例中加入Entity简化实体操作</h3><p>Entity 译为实体，实体就是集合中的一条数据。</p>
<p>NgRx 中提供了实体适配器对象，在实体适配器对象下面提供了各种操作集合中实体的方法，目的就是提高开发者操作实体的效率。</p>
<blockquote>
<p>核心</p>
</blockquote>
<ol>
<li><p>EntityState：实体类型接口</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	&#123;</span></span><br><span class="line"><span class="comment">		ids: [1, 2],</span></span><br><span class="line"><span class="comment">		entities: &#123;</span></span><br><span class="line"><span class="comment">			1: &#123; id: 1, title: "Hello Angular" &#125;,</span></span><br><span class="line"><span class="comment">			2: &#123; id: 2, title: "Hello NgRx" &#125;</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">export</span> interface State extends EntityState&lt;Todo&gt; &#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>createEntityAdapter： 创建实体适配器对象</p>
</li>
<li><p>EntityAdapter：实体适配器对象类型接口</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> adapter: EntityAdapter&lt;Todo&gt; = createEntityAdapter&lt;Todo&gt;()</span><br><span class="line"><span class="comment">// 获取初始状态 可以传递对象参数 也可以不传</span></span><br><span class="line"><span class="comment">// &#123;ids: [], entities: &#123;&#125;&#125;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> initialState: State = adapter.getInitialState()</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h5 id="15-6-3-实例方法"><a href="#15-6-3-实例方法" class="headerlink" title="15.6.3 实例方法"></a>15.6.3 实例方法</h5><p><a href="https://ngrx.io/guide/entity/adapter#adapter-collection-methods" target="_blank" rel="noopener">https://ngrx.io/guide/entity/adapter#adapter-collection-methods</a></p>
<h5 id="15-6-4-选择器"><a href="#15-6-4-选择器" class="headerlink" title="15.6.4 选择器"></a>15.6.4 选择器</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// selectTotal 获取数据条数</span></span><br><span class="line"><span class="comment">// selectAll 获取所有数据 以数组形式呈现</span></span><br><span class="line"><span class="comment">// selectEntities 获取实体集合 以字典形式呈现</span></span><br><span class="line"><span class="comment">// selectIds 获取id集合, 以数组形式呈现</span></span><br><span class="line"><span class="keyword">const</span> &#123; selectIds, selectEntities, selectAll, selectTotal &#125; = adapter.getSelectors();</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> selectTodo = createFeatureSelector&lt;AppState, State&gt;(todoFeatureKey)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> selectTodos = createSelector(selectTodo, selectAll)</span><br></pre></td></tr></table></figure>

<h3 id="34-将路由状态同步到Store中"><a href="#34-将路由状态同步到Store中" class="headerlink" title="34.将路由状态同步到Store中"></a>34.将路由状态同步到Store中</h3><ol>
<li><p>引入模块</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; StoreRouterConnectingModule &#125; <span class="keyword">from</span> <span class="string">"@ngrx/router-store"</span></span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  imports: [</span><br><span class="line">    StoreRouterConnectingModule.forRoot()</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将路由状态集成到 Store</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> fromRouter <span class="keyword">from</span> <span class="string">"@ngrx/router-store"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> interface AppState &#123;</span><br><span class="line">  router: fromRouter.RouterReducerState</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> reducers: ActionReducerMap&lt;AppState&gt; = &#123;</span><br><span class="line">  router: fromRouter.routerReducer</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<blockquote>
<p>创建获取路由状态的 Selector</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// router.selectors.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; createFeatureSelector &#125; <span class="keyword">from</span> <span class="string">"@ngrx/store"</span></span><br><span class="line"><span class="keyword">import</span> &#123; AppState &#125; <span class="keyword">from</span> <span class="string">".."</span></span><br><span class="line"><span class="keyword">import</span> &#123; RouterReducerState, getSelectors &#125; <span class="keyword">from</span> <span class="string">"@ngrx/router-store"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> selectRouter = createFeatureSelector&lt;AppState, RouterReducerState&gt;(</span><br><span class="line">  <span class="string">"router"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123;</span><br><span class="line">  <span class="comment">// 获取和当前路由相关的信息 (路由参数、路由配置等)</span></span><br><span class="line">  selectCurrentRoute,</span><br><span class="line">  <span class="comment">// 获取地址栏中 # 号后面的内容</span></span><br><span class="line">  selectFragment,</span><br><span class="line">  <span class="comment">// 获取路由查询参数</span></span><br><span class="line">  selectQueryParams,</span><br><span class="line">  <span class="comment">// 获取具体的某一个查询参数 selectQueryParam('name')</span></span><br><span class="line">  selectQueryParam,</span><br><span class="line">  <span class="comment">// 获取动态路由参数</span></span><br><span class="line">  selectRouteParams,</span><br><span class="line"> 	<span class="comment">// 获取某一个具体的动态路由参数 selectRouteParam('name')</span></span><br><span class="line">  selectRouteParam,</span><br><span class="line">  <span class="comment">// 获取路由自定义数据</span></span><br><span class="line">  selectRouteData,</span><br><span class="line">  <span class="comment">// 获取路由的实际访问地址</span></span><br><span class="line">  selectUrl</span><br><span class="line">&#125; = getSelectors(selectRouter)</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// home.component.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; select, Store &#125; <span class="keyword">from</span> <span class="string">"@ngrx/store"</span></span><br><span class="line"><span class="keyword">import</span> &#123; AppState &#125; <span class="keyword">from</span> <span class="string">"src/app/store"</span></span><br><span class="line"><span class="keyword">import</span> &#123; selectQueryParams &#125; <span class="keyword">from</span> <span class="string">"src/app/store/selectors/router.selectors"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AboutComponent</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(private store: Store&lt;AppState&gt;) &#123;</span><br><span class="line">    <span class="keyword">this</span>.store.pipe(select(selectQueryParams)).subscribe(<span class="built_in">console</span>.log)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="35-和状态相关的概念"><a href="#35-和状态相关的概念" class="headerlink" title="35.和状态相关的概念"></a>35.和状态相关的概念</h3><blockquote>
<p>什么是状态</p>
</blockquote>
<p>状态表示的是要进行运动的元素在运动的不同时期所呈现的样式。</p>
<blockquote>
<p>状态的种类</p>
</blockquote>
<p>在 Angular 中，有三种类型的状态，分别为：<code>void</code>、<code>*</code>、<code>custom</code></p>
<p>void：当元素在内存中创建好但尚未被添加到 DOM 中或将元素从 DOM 中删除时会发生此状态</p>
<p>*：元素被插入到 DOM 树之后的状态，或者是已经在DOM树中的元素的状态，也叫默认状态</p>
<p>custom：自定义状态，元素默认就在页面之中，从一个状态运动到另一个状态，比如面板的折叠和展开。</p>
<blockquote>
<p>为todo案例添加进场动画和出场动画</p>
</blockquote>
<ul>
<li>进场动画是指元素被创建后以动画的形式出现在用户面前，进场动画的状态用 <code>void =&gt; *</code> 表示，别名为 <code>:enter</code></li>
<li>出场动画是指元素在被删除前执行的一段告别动画，出场动画的状态用 <code>* =&gt; void</code>，别名为 <code>:leave</code></li>
</ul>
<blockquote>
<p>快速上手</p>
</blockquote>
<ol>
<li><p>在使用动画功能之前，需要引入动画模块，即 <code>BrowserAnimationsModule</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BrowserAnimationsModule &#125; <span class="keyword">from</span> <span class="string">"@angular/platform-browser/animations"</span></span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  imports: [BrowserAnimationsModule],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>默认代码解析，todo 之删除任务和添加任务</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在 index.html 文件中引入 bootstrap.min.css --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Todos<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> (<span class="attr">keyup.enter</span>)=<span class="string">"addItem(input)"</span> #<span class="attr">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"add todos"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"list-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> (<span class="attr">click</span>)=<span class="string">"removeItem(i)"</span> *<span class="attr">ngFor</span>=<span class="string">"let item of todos; let i = index"</span> <span class="attr">class</span>=<span class="string">"list-group-item"</span>&gt;</span></span><br><span class="line">      &#123;&#123; item &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-root"</span>,</span><br><span class="line">  templateUrl: <span class="string">"./app.component.html"</span>,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  <span class="comment">// todo 列表</span></span><br><span class="line">  todos: string[] = [<span class="string">"Learn Angular"</span>, <span class="string">"Learn RxJS"</span>, <span class="string">"Learn NgRx"</span>]</span><br><span class="line">	<span class="comment">// 添加 todo</span></span><br><span class="line">  addItem(input: HTMLInputElement) &#123;</span><br><span class="line">    <span class="keyword">this</span>.todos.push(input.value)</span><br><span class="line">    input.value = <span class="string">""</span></span><br><span class="line">  &#125;</span><br><span class="line">	<span class="comment">// 删除 todo</span></span><br><span class="line">  removeItem(index: number) &#123;</span><br><span class="line">    <span class="keyword">this</span>.todos.splice(index, <span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<ol>
<li>trigger 方法用于创建动画，指定动画名称</li>
<li>transition 方法用于指定动画的运动状态，出场动画或者入场动画，或者自定义状态动画。</li>
<li>style 方法用于设置元素在不同的状态下所对应的样式</li>
<li>animate 方法用于设置运动参数，比如动画运动时间，延迟事件，运动形式</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@Component(&#123;</span><br><span class="line">  animations: [</span><br><span class="line">    <span class="comment">// 创建动画, 动画名称为 slide</span></span><br><span class="line">    trigger(<span class="string">"slide"</span>, [</span><br><span class="line">      <span class="comment">// 指定入场动画 注意: 字符串两边不能有空格, 箭头两边可以有也可以没有空格</span></span><br><span class="line">      <span class="comment">// void =&gt; * 可以替换为 :enter</span></span><br><span class="line">      transition(<span class="string">"void =&gt; *"</span>, [</span><br><span class="line">        <span class="comment">// 指定元素未入场前的样式</span></span><br><span class="line">        style(&#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">"translateY(40px)"</span> &#125;),</span><br><span class="line">        <span class="comment">// 指定元素入场后的样式及运动参数</span></span><br><span class="line">        animate(<span class="number">250</span>, style(&#123; <span class="attr">opacity</span>: <span class="number">1</span>, <span class="attr">transform</span>: <span class="string">"translateY(0)"</span> &#125;))</span><br><span class="line">      ]),</span><br><span class="line">      <span class="comment">// 指定出场动画</span></span><br><span class="line">      <span class="comment">// * =&gt; void 可以替换为 :leave</span></span><br><span class="line">      transition(<span class="string">"* =&gt; void"</span>, [</span><br><span class="line">        <span class="comment">// 指定元素出场后的样式和运动参数</span></span><br><span class="line">        animate(<span class="number">600</span>, style(&#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span> &#125;))</span><br><span class="line">      ])</span><br><span class="line">    ])</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> @<span class="attr">slide</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="37-创建动画时的两个注意事项"><a href="#37-创建动画时的两个注意事项" class="headerlink" title="37.创建动画时的两个注意事项"></a>37.创建动画时的两个注意事项</h3><p>   注意：入场动画中可以不指定元素的默认状态，Angular 会将 void 状态清空作为默认状态</p>
   <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">   trigger(<span class="string">"slide"</span>, [</span><br><span class="line">     transition(<span class="string">":enter"</span>, [</span><br><span class="line">       style(&#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">"translateY(40px)"</span> &#125;),</span><br><span class="line">       animate(<span class="number">250</span>)</span><br><span class="line">     ]),</span><br><span class="line">     transition(<span class="string">":leave"</span>, [</span><br><span class="line">    		animate(<span class="number">600</span>, style(&#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span> &#125;))</span><br><span class="line">     ])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<p>   注意：要设置动画的运动参数，需要将 animate 方法的一个参数更改为字符串类型</p>
   <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 动画执行总时间 延迟时间 (可选) 运动形式 (可选)</span></span><br><span class="line">animate(<span class="string">"600ms 1s ease-out"</span>, style(&#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span> &#125;))</span><br></pre></td></tr></table></figure>

<h3 id="38-定义关键帧动画"><a href="#38-定义关键帧动画" class="headerlink" title="38.定义关键帧动画"></a>38.定义关键帧动画</h3><p>关键帧动画使用 <code>keyframes</code> 方法定义</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">transition(<span class="string">":leave"</span>, [</span><br><span class="line">  animate(</span><br><span class="line">    <span class="number">600</span>,</span><br><span class="line">    keyframes([</span><br><span class="line">      style(&#123; <span class="attr">offset</span>: <span class="number">0.3</span>, <span class="attr">transform</span>: <span class="string">"translateX(-80px)"</span> &#125;),</span><br><span class="line">      style(&#123; <span class="attr">offset</span>: <span class="number">1</span>, <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span> &#125;)</span><br><span class="line">    ])</span><br><span class="line">  )</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<h3 id="39-指定动画的回调函数"><a href="#39-指定动画的回调函数" class="headerlink" title="39.指定动画的回调函数"></a>39.指定动画的回调函数</h3><p>Angular 提供了和动画相关的两个回调函数，分别为动画开始执行时和动画执行完成后</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> @<span class="attr">slide</span> (@<span class="attr">slide.start</span>)=<span class="string">"start($event)"</span> (@<span class="attr">slide.done</span>)=<span class="string">"done($event)"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; AnimationEvent &#125; <span class="keyword">from</span> <span class="string">"@angular/animations"</span></span><br><span class="line"></span><br><span class="line">start(event: AnimationEvent) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(event)</span><br><span class="line">&#125;</span><br><span class="line">done(event: AnimationEvent) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(event)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="40-创建可重用动画"><a href="#40-创建可重用动画" class="headerlink" title="40.创建可重用动画"></a>40.创建可重用动画</h3><ol>
<li><p>将动画的定义放置在单独的文件中，方便多组件调用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; animate, keyframes, style, transition, trigger &#125; <span class="keyword">from</span> <span class="string">"@angular/animations"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> slide = trigger(<span class="string">"slide"</span>, [</span><br><span class="line">  transition(<span class="string">":enter"</span>, [</span><br><span class="line">    style(&#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">"translateY(40px)"</span> &#125;),</span><br><span class="line">    animate(<span class="number">250</span>)</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">":leave"</span>, [</span><br><span class="line">    animate(</span><br><span class="line">      <span class="number">600</span>,</span><br><span class="line">      keyframes([</span><br><span class="line">        style(&#123; <span class="attr">offset</span>: <span class="number">0.3</span>, <span class="attr">transform</span>: <span class="string">"translateX(-80px)"</span> &#125;),</span><br><span class="line">        style(&#123; <span class="attr">offset</span>: <span class="number">1</span>, <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span> &#125;)</span><br><span class="line">      ])</span><br><span class="line">    )</span><br><span class="line">  ])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; slide &#125; <span class="keyword">from</span> <span class="string">"./animations"</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  animations: [slide]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>抽取具体的动画定义，方便多动画调用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;animate, animation, keyframes, style, transition, trigger, useAnimation&#125; <span class="keyword">from</span> <span class="string">"@angular/animations"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> slideInUp = animation([</span><br><span class="line">  style(&#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">"translateY(40px)"</span> &#125;),</span><br><span class="line">  animate(<span class="number">250</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> slideOutLeft = animation([</span><br><span class="line">  animate(</span><br><span class="line">    <span class="number">600</span>,</span><br><span class="line">    keyframes([</span><br><span class="line">      style(&#123; <span class="attr">offset</span>: <span class="number">0.3</span>, <span class="attr">transform</span>: <span class="string">"translateX(-80px)"</span> &#125;),</span><br><span class="line">      style(&#123; <span class="attr">offset</span>: <span class="number">1</span>, <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span> &#125;)</span><br><span class="line">    ])</span><br><span class="line">  )</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> slide = trigger(<span class="string">"slide"</span>, [</span><br><span class="line">  transition(<span class="string">":enter"</span>, useAnimation(slideInUp)),</span><br><span class="line">  transition(<span class="string">":leave"</span>, useAnimation(slideOutLeft))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
</li>
<li><p>调用动画时传递运动总时间，延迟时间，运动形式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> slideInUp = animation(</span><br><span class="line">  [</span><br><span class="line">    style(&#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">"translateY(40px)"</span> &#125;),</span><br><span class="line">    animate(<span class="string">"&#123;&#123; duration &#125;&#125; &#123;&#123; delay &#125;&#125; &#123;&#123; easing &#125;&#125;"</span>)</span><br><span class="line">  ],</span><br><span class="line">  &#123;</span><br><span class="line">    params: &#123;</span><br><span class="line">      duration: <span class="string">"400ms"</span>,</span><br><span class="line">      delay: <span class="string">"0s"</span>,</span><br><span class="line">      easing: <span class="string">"ease-out"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">transition(<span class="string">":enter"</span>, useAnimation(slideInUp, &#123;<span class="attr">params</span>: &#123;<span class="attr">delay</span>: <span class="string">"1s"</span>&#125;&#125;))</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="41-query方法的使用"><a href="#41-query方法的使用" class="headerlink" title="41.query方法的使用"></a>41.query方法的使用</h3><p>Angular 中提供了 <code>query</code> 方法查找元素并为元素创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; slide &#125; <span class="keyword">from</span> <span class="string">"./animations"</span></span><br><span class="line"></span><br><span class="line">animations: [</span><br><span class="line">  slide,</span><br><span class="line">  trigger(<span class="string">"todoAnimations"</span>, [</span><br><span class="line">    transition(<span class="string">":enter"</span>, [</span><br><span class="line">      query(<span class="string">"h2"</span>, [</span><br><span class="line">        style(&#123; <span class="attr">transform</span>: <span class="string">"translateY(-30px)"</span> &#125;),</span><br><span class="line">        animate(<span class="number">300</span>)</span><br><span class="line">      ]),</span><br><span class="line">      <span class="comment">// 查询子级动画 使其执行</span></span><br><span class="line">      query(<span class="string">"@slide"</span>, animateChild())</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span> @<span class="attr">todoAnimations</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Todos<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"list-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">slide</span></span></span><br><span class="line"><span class="tag">      (<span class="attr">click</span>)=<span class="string">"removeItem(i)"</span></span></span><br><span class="line"><span class="tag">      *<span class="attr">ngFor</span>=<span class="string">"let item of todos; let i = index"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"list-group-item"</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      &#123;&#123; item &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="42-group方法的使用"><a href="#42-group方法的使用" class="headerlink" title="42.group方法的使用"></a>42.group方法的使用</h3><p>默认情况下，父级动画和子级动画按照顺序执行，先执行父级动画，再执行子级动画，可以使用  <code>group</code> 方法让其并行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"todoAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">":enter"</span>, [</span><br><span class="line">    group([</span><br><span class="line">      query(<span class="string">"h2"</span>, [</span><br><span class="line">        style(&#123; <span class="attr">transform</span>: <span class="string">"translateY(-30px)"</span> &#125;),</span><br><span class="line">        animate(<span class="number">300</span>)</span><br><span class="line">      ]),</span><br><span class="line">      query(<span class="string">"@slide"</span>, animateChild())</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<h3 id="43-使用stagger方法实现交错动画"><a href="#43-使用stagger方法实现交错动画" class="headerlink" title="43.使用stagger方法实现交错动画"></a>43.使用stagger方法实现交错动画</h3><p>Angular 提供了 stagger 方法，在多个元素同时执行同一个动画时，让每个元素动画的执行依次延迟。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">transition(<span class="string">":enter"</span>, [</span><br><span class="line">  group([</span><br><span class="line">    query(<span class="string">"h2"</span>, [</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateY(-30px)"</span> &#125;),</span><br><span class="line">      animate(<span class="number">300</span>)</span><br><span class="line">    ]),</span><br><span class="line">    query(<span class="string">"@slide"</span>, stagger(<span class="number">200</span>, animateChild()))</span><br><span class="line">  ])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<p>注意：stagger 方法只能在 query 方法内部使用</p>
<h3 id="44-创建自定义状态动画"><a href="#44-创建自定义状态动画" class="headerlink" title="44.创建自定义状态动画"></a>44.创建自定义状态动画</h3><p>Angular 提供了 <code>state</code> 方法用于定义状态。</p>
<ol>
<li><p>默认代码解析</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-default"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-heading"</span> (<span class="attr">click</span>)=<span class="string">"toggle()"</span>&gt;</span></span><br><span class="line">      一套框架, 多种平台, 移动端 &amp; 桌面端</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        使用简单的声明式模板，快速实现各种特性。使用自定义组件和大量现有组件，扩展模板语言。在几乎所有的</span><br><span class="line">        IDE 中获得针对 Angular</span><br><span class="line">        的即时帮助和反馈。所有这一切，都是为了帮助你编写漂亮的应用，而不是绞尽脑汁的让代码“能用”。</span><br><span class="line">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        从原型到全球部署，Angular 都能带给你支撑 Google</span><br><span class="line">        大型应用的那些高延展性基础设施与技术。</span><br><span class="line">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        通过 Web Worker 和服务端渲染，达到在如今(以及未来）的 Web</span><br><span class="line">        平台上所能达到的最高速度。 Angular 让你有效掌控可伸缩性。基于</span><br><span class="line">        RxJS、Immutable.js 和其它推送模型，能适应海量数据需求。</span><br><span class="line">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        学会用 Angular</span><br><span class="line">        构建应用，然后把这些代码和能力复用在多种多种不同平台的应用上 ——</span><br><span class="line">        Web、移动 Web、移动应用、原生应用和桌面原生应用。</span><br><span class="line">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.container</span> &#123;</span></span><br><span class="line">    margin-top: 100px;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.panel-heading</span> &#123;</span></span><br><span class="line">    cursor: pointer;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-root"</span>,</span><br><span class="line">  templateUrl: <span class="string">"./app.component.html"</span>,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  isExpended: boolean = <span class="literal">false</span></span><br><span class="line">  toggle() &#123;</span><br><span class="line">    <span class="keyword">this</span>.isExpended = !<span class="keyword">this</span>.isExpended</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"expandCollapse"</span>, [</span><br><span class="line">  <span class="comment">// 使用 state 方法定义折叠状态元素对应的样式</span></span><br><span class="line">  state(</span><br><span class="line">    <span class="string">"collapsed"</span>,</span><br><span class="line">    style(&#123;</span><br><span class="line">      height: <span class="number">0</span>,</span><br><span class="line">      overflow: <span class="string">"hidden"</span>,</span><br><span class="line">      paddingTop: <span class="number">0</span>,</span><br><span class="line">      paddingBottom: <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// 使用 state 方法定义展开状态元素对应的样式</span></span><br><span class="line">  state(<span class="string">"expanded"</span>, style(&#123; <span class="attr">height</span>: <span class="string">"*"</span>, <span class="attr">overflow</span>: <span class="string">"auto"</span> &#125;)),</span><br><span class="line">  <span class="comment">// 定义展开动画</span></span><br><span class="line">  transition(<span class="string">"collapsed =&gt; expanded"</span>, animate(<span class="string">"400ms ease-out"</span>)),</span><br><span class="line">  <span class="comment">// 定义折叠动画</span></span><br><span class="line">  transition(<span class="string">"expanded =&gt; collapsed"</span>, animate(<span class="string">"400ms ease-in"</span>))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> [@<span class="attr">expandCollapse</span>]=<span class="string">"isExpended ? 'expanded' : 'collapsed'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="45-实现路由动画"><a href="#45-实现路由动画" class="headerlink" title="45.实现路由动画"></a>45.实现路由动画</h3><ol>
<li><p>为路由添加状态标识，此标识即为路由执行动画时的自定义状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    pathMatch: <span class="string">"full"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"one"</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"two"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"news"</span>,</span><br><span class="line">    component: NewsComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"three"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过路由插座对象获取路由状态标识，并将标识传递给动画的调用者，让动画执行当前要执行的状态是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"routerContainer"</span> [@<span class="attr">routerAnimations</span>]=<span class="string">"prepareRoute(outlet)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> #<span class="attr">outlet</span>=<span class="string">"outlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  prepareRoute(outlet: RouterOutlet) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      outlet &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData.animation</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 routerContainer 设置为相对定位，将它的直接一级子元素设置成绝对定位</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* styles.css */</span></span><br><span class="line"><span class="selector-class">.routerContainer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.routerContainer</span> &gt; * &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"routerAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">"one =&gt; two, one =&gt; three, two =&gt; three"</span>, [</span><br><span class="line">    query(<span class="string">":enter"</span>, style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(-100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">"three =&gt; two, three =&gt; one, two =&gt; one"</span>, [</span><br><span class="line">    query(</span><br><span class="line">      <span class="string">":enter"</span>,</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(-100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    ),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br><span class="line"><span class="string">``</span><span class="string">`     .container &#123;</span></span><br><span class="line"><span class="string">    margin-top: 100px;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  .panel-heading &#123;</span></span><br><span class="line"><span class="string">    cursor: pointer;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&lt;/style&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-root"</span>,</span><br><span class="line">  templateUrl: <span class="string">"./app.component.html"</span>,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  isExpended: boolean = <span class="literal">false</span></span><br><span class="line">  toggle() &#123;</span><br><span class="line">    <span class="keyword">this</span>.isExpended = !<span class="keyword">this</span>.isExpended</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"expandCollapse"</span>, [</span><br><span class="line">  <span class="comment">// 使用 state 方法定义折叠状态元素对应的样式</span></span><br><span class="line">  state(</span><br><span class="line">    <span class="string">"collapsed"</span>,</span><br><span class="line">    style(&#123;</span><br><span class="line">      height: <span class="number">0</span>,</span><br><span class="line">      overflow: <span class="string">"hidden"</span>,</span><br><span class="line">      paddingTop: <span class="number">0</span>,</span><br><span class="line">      paddingBottom: <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// 使用 state 方法定义展开状态元素对应的样式</span></span><br><span class="line">  state(<span class="string">"expanded"</span>, style(&#123; <span class="attr">height</span>: <span class="string">"*"</span>, <span class="attr">overflow</span>: <span class="string">"auto"</span> &#125;)),</span><br><span class="line">  <span class="comment">// 定义展开动画</span></span><br><span class="line">  transition(<span class="string">"collapsed =&gt; expanded"</span>, animate(<span class="string">"400ms ease-out"</span>)),</span><br><span class="line">  <span class="comment">// 定义折叠动画</span></span><br><span class="line">  transition(<span class="string">"expanded =&gt; collapsed"</span>, animate(<span class="string">"400ms ease-in"</span>))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> [@<span class="attr">expandCollapse</span>]=<span class="string">"isExpended ? 'expanded' : 'collapsed'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="45-实现路由动画-1"><a href="#45-实现路由动画-1" class="headerlink" title="45.实现路由动画"></a>45.实现路由动画</h3><ol>
<li><p>为路由添加状态标识，此标识即为路由执行动画时的自定义状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    pathMatch: <span class="string">"full"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"one"</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"two"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"news"</span>,</span><br><span class="line">    component: NewsComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"three"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过路由插座对象获取路由状态标识，并将标识传递给动画的调用者，让动画执行当前要执行的状态是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"routerContainer"</span> [@<span class="attr">routerAnimations</span>]=<span class="string">"prepareRoute(outlet)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> #<span class="attr">outlet</span>=<span class="string">"outlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  prepareRoute(outlet: RouterOutlet) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      outlet &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData.animation</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 routerContainer 设置为相对定位，将它的直接一级子元素设置成绝对定位</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* styles.css */</span></span><br><span class="line"><span class="selector-class">.routerContainer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.routerContainer</span> &gt; * &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"routerAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">"one =&gt; two, one =&gt; three, two =&gt; three"</span>, [</span><br><span class="line">    query(<span class="string">":enter"</span>, style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(-100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">"three =&gt; two, three =&gt; one, two =&gt; one"</span>, [</span><br><span class="line">    query(</span><br><span class="line">      <span class="string">":enter"</span>,</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(-100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    ),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<p>  .container {</p>
<pre><code>margin-top: 100px;</code></pre><p>  }<br>  .panel-heading {</p>
<pre><code>cursor: pointer;</code></pre><p>  }<br></style></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#96;&#96;&#96;javascript</span><br><span class="line">import &#123; Component &#125; from &quot;@angular&#x2F;core&quot;</span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: &quot;app-root&quot;,</span><br><span class="line">  templateUrl: &quot;.&#x2F;app.component.html&quot;,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line">export class AppComponent &#123;</span><br><span class="line">  isExpended: boolean &#x3D; false</span><br><span class="line">  toggle() &#123;</span><br><span class="line">    this.isExpended &#x3D; !this.isExpended</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"expandCollapse"</span>, [</span><br><span class="line">  <span class="comment">// 使用 state 方法定义折叠状态元素对应的样式</span></span><br><span class="line">  state(</span><br><span class="line">    <span class="string">"collapsed"</span>,</span><br><span class="line">    style(&#123;</span><br><span class="line">      height: <span class="number">0</span>,</span><br><span class="line">      overflow: <span class="string">"hidden"</span>,</span><br><span class="line">      paddingTop: <span class="number">0</span>,</span><br><span class="line">      paddingBottom: <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// 使用 state 方法定义展开状态元素对应的样式</span></span><br><span class="line">  state(<span class="string">"expanded"</span>, style(&#123; <span class="attr">height</span>: <span class="string">"*"</span>, <span class="attr">overflow</span>: <span class="string">"auto"</span> &#125;)),</span><br><span class="line">  <span class="comment">// 定义展开动画</span></span><br><span class="line">  transition(<span class="string">"collapsed =&gt; expanded"</span>, animate(<span class="string">"400ms ease-out"</span>)),</span><br><span class="line">  <span class="comment">// 定义折叠动画</span></span><br><span class="line">  transition(<span class="string">"expanded =&gt; collapsed"</span>, animate(<span class="string">"400ms ease-in"</span>))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> [@<span class="attr">expandCollapse</span>]=<span class="string">"isExpended ? 'expanded' : 'collapsed'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="45-实现路由动画-2"><a href="#45-实现路由动画-2" class="headerlink" title="45.实现路由动画"></a>45.实现路由动画</h3><ol>
<li><p>为路由添加状态标识，此标识即为路由执行动画时的自定义状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    pathMatch: <span class="string">"full"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"one"</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"two"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"news"</span>,</span><br><span class="line">    component: NewsComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"three"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过路由插座对象获取路由状态标识，并将标识传递给动画的调用者，让动画执行当前要执行的状态是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"routerContainer"</span> [@<span class="attr">routerAnimations</span>]=<span class="string">"prepareRoute(outlet)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> #<span class="attr">outlet</span>=<span class="string">"outlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  prepareRoute(outlet: RouterOutlet) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      outlet &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData.animation</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 routerContainer 设置为相对定位，将它的直接一级子元素设置成绝对定位</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* styles.css */</span></span><br><span class="line"><span class="selector-class">.routerContainer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.routerContainer</span> &gt; * &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"routerAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">"one =&gt; two, one =&gt; three, two =&gt; three"</span>, [</span><br><span class="line">    query(<span class="string">":enter"</span>, style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(-100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">"three =&gt; two, three =&gt; one, two =&gt; one"</span>, [</span><br><span class="line">    query(</span><br><span class="line">      <span class="string">":enter"</span>,</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(-100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    ),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br><span class="line"><span class="string">``</span><span class="string">`     .container &#123;</span></span><br><span class="line"><span class="string">    margin-top: 100px;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  .panel-heading &#123;</span></span><br><span class="line"><span class="string">    cursor: pointer;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&lt;/style&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-root"</span>,</span><br><span class="line">  templateUrl: <span class="string">"./app.component.html"</span>,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  isExpended: boolean = <span class="literal">false</span></span><br><span class="line">  toggle() &#123;</span><br><span class="line">    <span class="keyword">this</span>.isExpended = !<span class="keyword">this</span>.isExpended</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"expandCollapse"</span>, [</span><br><span class="line">  <span class="comment">// 使用 state 方法定义折叠状态元素对应的样式</span></span><br><span class="line">  state(</span><br><span class="line">    <span class="string">"collapsed"</span>,</span><br><span class="line">    style(&#123;</span><br><span class="line">      height: <span class="number">0</span>,</span><br><span class="line">      overflow: <span class="string">"hidden"</span>,</span><br><span class="line">      paddingTop: <span class="number">0</span>,</span><br><span class="line">      paddingBottom: <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// 使用 state 方法定义展开状态元素对应的样式</span></span><br><span class="line">  state(<span class="string">"expanded"</span>, style(&#123; <span class="attr">height</span>: <span class="string">"*"</span>, <span class="attr">overflow</span>: <span class="string">"auto"</span> &#125;)),</span><br><span class="line">  <span class="comment">// 定义展开动画</span></span><br><span class="line">  transition(<span class="string">"collapsed =&gt; expanded"</span>, animate(<span class="string">"400ms ease-out"</span>)),</span><br><span class="line">  <span class="comment">// 定义折叠动画</span></span><br><span class="line">  transition(<span class="string">"expanded =&gt; collapsed"</span>, animate(<span class="string">"400ms ease-in"</span>))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> [@<span class="attr">expandCollapse</span>]=<span class="string">"isExpended ? 'expanded' : 'collapsed'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="45-实现路由动画-3"><a href="#45-实现路由动画-3" class="headerlink" title="45.实现路由动画"></a>45.实现路由动画</h3><ol>
<li><p>为路由添加状态标识，此标识即为路由执行动画时的自定义状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    pathMatch: <span class="string">"full"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"one"</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"two"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"news"</span>,</span><br><span class="line">    component: NewsComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"three"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过路由插座对象获取路由状态标识，并将标识传递给动画的调用者，让动画执行当前要执行的状态是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"routerContainer"</span> [@<span class="attr">routerAnimations</span>]=<span class="string">"prepareRoute(outlet)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> #<span class="attr">outlet</span>=<span class="string">"outlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  prepareRoute(outlet: RouterOutlet) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      outlet &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData.animation</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 routerContainer 设置为相对定位，将它的直接一级子元素设置成绝对定位</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* styles.css */</span></span><br><span class="line"><span class="selector-class">.routerContainer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.routerContainer</span> &gt; * &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"routerAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">"one =&gt; two, one =&gt; three, two =&gt; three"</span>, [</span><br><span class="line">    query(<span class="string">":enter"</span>, style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(-100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">"three =&gt; two, three =&gt; one, two =&gt; one"</span>, [</span><br><span class="line">    query(</span><br><span class="line">      <span class="string">":enter"</span>,</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(-100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    ),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<p>  .container {</p>
<pre><code>margin-top: 100px;</code></pre><p>  }<br>  .panel-heading {</p>
<pre><code>cursor: pointer;</code></pre><p>  }<br></style></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#96;&#96;&#96;javascript</span><br><span class="line">import &#123; Component &#125; from &quot;@angular&#x2F;core&quot;</span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: &quot;app-root&quot;,</span><br><span class="line">  templateUrl: &quot;.&#x2F;app.component.html&quot;,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line">export class AppComponent &#123;</span><br><span class="line">  isExpended: boolean &#x3D; false</span><br><span class="line">  toggle() &#123;</span><br><span class="line">    this.isExpended &#x3D; !this.isExpended</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"expandCollapse"</span>, [</span><br><span class="line">  <span class="comment">// 使用 state 方法定义折叠状态元素对应的样式</span></span><br><span class="line">  state(</span><br><span class="line">    <span class="string">"collapsed"</span>,</span><br><span class="line">    style(&#123;</span><br><span class="line">      height: <span class="number">0</span>,</span><br><span class="line">      overflow: <span class="string">"hidden"</span>,</span><br><span class="line">      paddingTop: <span class="number">0</span>,</span><br><span class="line">      paddingBottom: <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// 使用 state 方法定义展开状态元素对应的样式</span></span><br><span class="line">  state(<span class="string">"expanded"</span>, style(&#123; <span class="attr">height</span>: <span class="string">"*"</span>, <span class="attr">overflow</span>: <span class="string">"auto"</span> &#125;)),</span><br><span class="line">  <span class="comment">// 定义展开动画</span></span><br><span class="line">  transition(<span class="string">"collapsed =&gt; expanded"</span>, animate(<span class="string">"400ms ease-out"</span>)),</span><br><span class="line">  <span class="comment">// 定义折叠动画</span></span><br><span class="line">  transition(<span class="string">"expanded =&gt; collapsed"</span>, animate(<span class="string">"400ms ease-in"</span>))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> [@<span class="attr">expandCollapse</span>]=<span class="string">"isExpended ? 'expanded' : 'collapsed'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="45-实现路由动画-4"><a href="#45-实现路由动画-4" class="headerlink" title="45.实现路由动画"></a>45.实现路由动画</h3><ol>
<li><p>为路由添加状态标识，此标识即为路由执行动画时的自定义状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    pathMatch: <span class="string">"full"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"one"</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"two"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"news"</span>,</span><br><span class="line">    component: NewsComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"three"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过路由插座对象获取路由状态标识，并将标识传递给动画的调用者，让动画执行当前要执行的状态是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"routerContainer"</span> [@<span class="attr">routerAnimations</span>]=<span class="string">"prepareRoute(outlet)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> #<span class="attr">outlet</span>=<span class="string">"outlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  prepareRoute(outlet: RouterOutlet) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      outlet &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData.animation</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 routerContainer 设置为相对定位，将它的直接一级子元素设置成绝对定位</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* styles.css */</span></span><br><span class="line"><span class="selector-class">.routerContainer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.routerContainer</span> &gt; * &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"routerAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">"one =&gt; two, one =&gt; three, two =&gt; three"</span>, [</span><br><span class="line">    query(<span class="string">":enter"</span>, style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(-100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">"three =&gt; two, three =&gt; one, two =&gt; one"</span>, [</span><br><span class="line">    query(</span><br><span class="line">      <span class="string">":enter"</span>,</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(-100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    ),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br><span class="line"><span class="string">``</span><span class="string">`     .container &#123;</span></span><br><span class="line"><span class="string">    margin-top: 100px;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  .panel-heading &#123;</span></span><br><span class="line"><span class="string">    cursor: pointer;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&lt;/style&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-root"</span>,</span><br><span class="line">  templateUrl: <span class="string">"./app.component.html"</span>,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  isExpended: boolean = <span class="literal">false</span></span><br><span class="line">  toggle() &#123;</span><br><span class="line">    <span class="keyword">this</span>.isExpended = !<span class="keyword">this</span>.isExpended</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"expandCollapse"</span>, [</span><br><span class="line">  <span class="comment">// 使用 state 方法定义折叠状态元素对应的样式</span></span><br><span class="line">  state(</span><br><span class="line">    <span class="string">"collapsed"</span>,</span><br><span class="line">    style(&#123;</span><br><span class="line">      height: <span class="number">0</span>,</span><br><span class="line">      overflow: <span class="string">"hidden"</span>,</span><br><span class="line">      paddingTop: <span class="number">0</span>,</span><br><span class="line">      paddingBottom: <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// 使用 state 方法定义展开状态元素对应的样式</span></span><br><span class="line">  state(<span class="string">"expanded"</span>, style(&#123; <span class="attr">height</span>: <span class="string">"*"</span>, <span class="attr">overflow</span>: <span class="string">"auto"</span> &#125;)),</span><br><span class="line">  <span class="comment">// 定义展开动画</span></span><br><span class="line">  transition(<span class="string">"collapsed =&gt; expanded"</span>, animate(<span class="string">"400ms ease-out"</span>)),</span><br><span class="line">  <span class="comment">// 定义折叠动画</span></span><br><span class="line">  transition(<span class="string">"expanded =&gt; collapsed"</span>, animate(<span class="string">"400ms ease-in"</span>))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> [@<span class="attr">expandCollapse</span>]=<span class="string">"isExpended ? 'expanded' : 'collapsed'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="45-实现路由动画-5"><a href="#45-实现路由动画-5" class="headerlink" title="45.实现路由动画"></a>45.实现路由动画</h3><ol>
<li><p>为路由添加状态标识，此标识即为路由执行动画时的自定义状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    pathMatch: <span class="string">"full"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"one"</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"two"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"news"</span>,</span><br><span class="line">    component: NewsComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"three"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过路由插座对象获取路由状态标识，并将标识传递给动画的调用者，让动画执行当前要执行的状态是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"routerContainer"</span> [@<span class="attr">routerAnimations</span>]=<span class="string">"prepareRoute(outlet)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> #<span class="attr">outlet</span>=<span class="string">"outlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  prepareRoute(outlet: RouterOutlet) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      outlet &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData.animation</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 routerContainer 设置为相对定位，将它的直接一级子元素设置成绝对定位</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* styles.css */</span></span><br><span class="line"><span class="selector-class">.routerContainer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.routerContainer</span> &gt; * &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"routerAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">"one =&gt; two, one =&gt; three, two =&gt; three"</span>, [</span><br><span class="line">    query(<span class="string">":enter"</span>, style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(-100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">"three =&gt; two, three =&gt; one, two =&gt; one"</span>, [</span><br><span class="line">    query(</span><br><span class="line">      <span class="string">":enter"</span>,</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(-100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    ),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<p>  .container {</p>
<pre><code>margin-top: 100px;</code></pre><p>  }<br>  .panel-heading {</p>
<pre><code>cursor: pointer;</code></pre><p>  }<br></style></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#96;&#96;&#96;javascript</span><br><span class="line">import &#123; Component &#125; from &quot;@angular&#x2F;core&quot;</span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: &quot;app-root&quot;,</span><br><span class="line">  templateUrl: &quot;.&#x2F;app.component.html&quot;,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line">export class AppComponent &#123;</span><br><span class="line">  isExpended: boolean &#x3D; false</span><br><span class="line">  toggle() &#123;</span><br><span class="line">    this.isExpended &#x3D; !this.isExpended</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"expandCollapse"</span>, [</span><br><span class="line">  <span class="comment">// 使用 state 方法定义折叠状态元素对应的样式</span></span><br><span class="line">  state(</span><br><span class="line">    <span class="string">"collapsed"</span>,</span><br><span class="line">    style(&#123;</span><br><span class="line">      height: <span class="number">0</span>,</span><br><span class="line">      overflow: <span class="string">"hidden"</span>,</span><br><span class="line">      paddingTop: <span class="number">0</span>,</span><br><span class="line">      paddingBottom: <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// 使用 state 方法定义展开状态元素对应的样式</span></span><br><span class="line">  state(<span class="string">"expanded"</span>, style(&#123; <span class="attr">height</span>: <span class="string">"*"</span>, <span class="attr">overflow</span>: <span class="string">"auto"</span> &#125;)),</span><br><span class="line">  <span class="comment">// 定义展开动画</span></span><br><span class="line">  transition(<span class="string">"collapsed =&gt; expanded"</span>, animate(<span class="string">"400ms ease-out"</span>)),</span><br><span class="line">  <span class="comment">// 定义折叠动画</span></span><br><span class="line">  transition(<span class="string">"expanded =&gt; collapsed"</span>, animate(<span class="string">"400ms ease-in"</span>))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> [@<span class="attr">expandCollapse</span>]=<span class="string">"isExpended ? 'expanded' : 'collapsed'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="45-实现路由动画-6"><a href="#45-实现路由动画-6" class="headerlink" title="45.实现路由动画"></a>45.实现路由动画</h3><ol>
<li><p>为路由添加状态标识，此标识即为路由执行动画时的自定义状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    pathMatch: <span class="string">"full"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"one"</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"two"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"news"</span>,</span><br><span class="line">    component: NewsComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"three"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过路由插座对象获取路由状态标识，并将标识传递给动画的调用者，让动画执行当前要执行的状态是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"routerContainer"</span> [@<span class="attr">routerAnimations</span>]=<span class="string">"prepareRoute(outlet)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> #<span class="attr">outlet</span>=<span class="string">"outlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  prepareRoute(outlet: RouterOutlet) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      outlet &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData.animation</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 routerContainer 设置为相对定位，将它的直接一级子元素设置成绝对定位</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* styles.css */</span></span><br><span class="line"><span class="selector-class">.routerContainer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.routerContainer</span> &gt; * &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"routerAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">"one =&gt; two, one =&gt; three, two =&gt; three"</span>, [</span><br><span class="line">    query(<span class="string">":enter"</span>, style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(-100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">"three =&gt; two, three =&gt; one, two =&gt; one"</span>, [</span><br><span class="line">    query(</span><br><span class="line">      <span class="string">":enter"</span>,</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(-100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    ),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br><span class="line"><span class="string">``</span><span class="string">`     .container &#123;</span></span><br><span class="line"><span class="string">    margin-top: 100px;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  .panel-heading &#123;</span></span><br><span class="line"><span class="string">    cursor: pointer;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&lt;/style&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-root"</span>,</span><br><span class="line">  templateUrl: <span class="string">"./app.component.html"</span>,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  isExpended: boolean = <span class="literal">false</span></span><br><span class="line">  toggle() &#123;</span><br><span class="line">    <span class="keyword">this</span>.isExpended = !<span class="keyword">this</span>.isExpended</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"expandCollapse"</span>, [</span><br><span class="line">  <span class="comment">// 使用 state 方法定义折叠状态元素对应的样式</span></span><br><span class="line">  state(</span><br><span class="line">    <span class="string">"collapsed"</span>,</span><br><span class="line">    style(&#123;</span><br><span class="line">      height: <span class="number">0</span>,</span><br><span class="line">      overflow: <span class="string">"hidden"</span>,</span><br><span class="line">      paddingTop: <span class="number">0</span>,</span><br><span class="line">      paddingBottom: <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// 使用 state 方法定义展开状态元素对应的样式</span></span><br><span class="line">  state(<span class="string">"expanded"</span>, style(&#123; <span class="attr">height</span>: <span class="string">"*"</span>, <span class="attr">overflow</span>: <span class="string">"auto"</span> &#125;)),</span><br><span class="line">  <span class="comment">// 定义展开动画</span></span><br><span class="line">  transition(<span class="string">"collapsed =&gt; expanded"</span>, animate(<span class="string">"400ms ease-out"</span>)),</span><br><span class="line">  <span class="comment">// 定义折叠动画</span></span><br><span class="line">  transition(<span class="string">"expanded =&gt; collapsed"</span>, animate(<span class="string">"400ms ease-in"</span>))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> [@<span class="attr">expandCollapse</span>]=<span class="string">"isExpended ? 'expanded' : 'collapsed'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="45-实现路由动画-7"><a href="#45-实现路由动画-7" class="headerlink" title="45.实现路由动画"></a>45.实现路由动画</h3><ol>
<li><p>为路由添加状态标识，此标识即为路由执行动画时的自定义状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    pathMatch: <span class="string">"full"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"one"</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"two"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"news"</span>,</span><br><span class="line">    component: NewsComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"three"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过路由插座对象获取路由状态标识，并将标识传递给动画的调用者，让动画执行当前要执行的状态是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"routerContainer"</span> [@<span class="attr">routerAnimations</span>]=<span class="string">"prepareRoute(outlet)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> #<span class="attr">outlet</span>=<span class="string">"outlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  prepareRoute(outlet: RouterOutlet) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      outlet &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData.animation</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 routerContainer 设置为相对定位，将它的直接一级子元素设置成绝对定位</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* styles.css */</span></span><br><span class="line"><span class="selector-class">.routerContainer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.routerContainer</span> &gt; * &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"routerAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">"one =&gt; two, one =&gt; three, two =&gt; three"</span>, [</span><br><span class="line">    query(<span class="string">":enter"</span>, style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(-100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">"three =&gt; two, three =&gt; one, two =&gt; one"</span>, [</span><br><span class="line">    query(</span><br><span class="line">      <span class="string">":enter"</span>,</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(-100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    ),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>


</li>
</ol>
<p>  #box {<br>    width: 200px;<br>    height: 200px;<br>    background: skyblue;<br>    position: absolute;<br>    left: 0;<br>    top: 0;<br>  }<br></style></p>
<div id="box"></div>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#96;&#96;&#96;javascript</span><br><span class="line">&#x2F;&#x2F; 原生 JavaScript</span><br><span class="line">box.onmousedown &#x3D; function (event) &#123;</span><br><span class="line">  let distanceX &#x3D; event.clientX - event.target.offsetLeft</span><br><span class="line">  let distanceY &#x3D; event.clientY - event.target.offsetTop</span><br><span class="line">  document.onmousemove &#x3D; function (event) &#123;</span><br><span class="line">    let positionX &#x3D; event.clientX - distanceX</span><br><span class="line">    let positionY &#x3D; event.clientY - distanceY</span><br><span class="line">    box.style.left &#x3D; positionX + &quot;px&quot;</span><br><span class="line">    box.style.top &#x3D; positionY + &quot;px&quot;</span><br><span class="line">  &#125;</span><br><span class="line">  box.onmouseup &#x3D; function () &#123;</span><br><span class="line">    document.onmousemove &#x3D; null</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// RxJS</span></span><br><span class="line"><span class="keyword">import</span> &#123; fromEvent &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; map, switchMap, takeUntil &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> box = <span class="built_in">document</span>.getElementById(<span class="string">"box"</span>)</span><br><span class="line"></span><br><span class="line">fromEvent(box, <span class="string">"mousedown"</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    map(<span class="function"><span class="params">event</span> =&gt;</span> (&#123;</span><br><span class="line">      distanceX: event.clientX - event.target.offsetLeft,</span><br><span class="line">      distanceY: event.clientY - event.target.offsetTop</span><br><span class="line">    &#125;)),</span><br><span class="line">    switchMap(<span class="function">(<span class="params">&#123; distanceX, distanceY &#125;</span>) =&gt;</span></span><br><span class="line">      fromEvent(<span class="built_in">document</span>, <span class="string">"mousemove"</span>).pipe(</span><br><span class="line">        map(<span class="function"><span class="params">event</span> =&gt;</span> (&#123;</span><br><span class="line">          positionX: event.clientX - distanceX,</span><br><span class="line">          positionY: event.clientY - distanceY</span><br><span class="line">        &#125;)),</span><br><span class="line">        takeUntil(fromEvent(<span class="built_in">document</span>, <span class="string">"mouseup"</span>))</span><br><span class="line">      )</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line">  .subscribe(<span class="function">(<span class="params">&#123; positionX, positionY &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    box.style.left = positionX + <span class="string">"px"</span></span><br><span class="line">    box.style.top = positionY + <span class="string">"px"</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="15-搜索案例-1"><a href="#15-搜索案例-1" class="headerlink" title="15.搜索案例"></a>15.搜索案例</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"search"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"请输入搜索内容..."</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fromEvent, <span class="keyword">from</span>, throwError &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; debounceTime, distinctUntilChanged, map, switchMap, catchError &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">"axios"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> search = <span class="built_in">document</span>.getElementById(<span class="string">"search"</span>)</span><br><span class="line"></span><br><span class="line">fromEvent(search, <span class="string">"keyup"</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    debounceTime(<span class="number">700</span>),</span><br><span class="line">    map(<span class="function"><span class="params">event</span> =&gt;</span> event.target.value),</span><br><span class="line">    distinctUntilChanged(),</span><br><span class="line">    switchMap(<span class="function"><span class="params">keyword</span> =&gt;</span></span><br><span class="line">      <span class="keyword">from</span>(</span><br><span class="line">        axios.get(<span class="string">`https://j1sonplaceholder.typicode.com/posts?q=<span class="subst">$&#123;keyword&#125;</span>`</span>)</span><br><span class="line">      ).pipe(</span><br><span class="line">        map(<span class="function"><span class="params">response</span> =&gt;</span> response.data),</span><br><span class="line">        catchError(<span class="function"><span class="params">error</span> =&gt;</span> throwError(<span class="string">`发生了错误: <span class="subst">$&#123;error.message&#125;</span>`</span>))</span><br><span class="line">      )</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line">  .subscribe(&#123;</span><br><span class="line">    next: <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(value)</span><br><span class="line">    &#125;,</span><br><span class="line">    error: <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(error)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="16-案例之串联请求的发送-1"><a href="#16-案例之串联请求的发送-1" class="headerlink" title="16.案例之串联请求的发送"></a>16.案例之串联请求的发送</h3><p>先获取token，再根据token获取用户信息</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"btn"</span>&gt;</span>获取用户信息<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">"axios"</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">from</span>, fromEvent &#125; <span class="keyword">from</span> <span class="string">"rxjs"</span></span><br><span class="line"><span class="keyword">import</span> &#123; pluck, concatMap &#125; <span class="keyword">from</span> <span class="string">"rxjs/operators"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> button = <span class="built_in">document</span>.getElementById(<span class="string">"btn"</span>)</span><br><span class="line"></span><br><span class="line">fromEvent(button, <span class="string">"click"</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    concatMap(<span class="function"><span class="params">event</span> =&gt;</span></span><br><span class="line">      <span class="keyword">from</span>(axios.get(<span class="string">"http://localhost:3005/token"</span>)).pipe(</span><br><span class="line">        pluck(<span class="string">"data"</span>, <span class="string">"token"</span>)</span><br><span class="line">      )</span><br><span class="line">    ),</span><br><span class="line">    concatMap(<span class="function"><span class="params">token</span> =&gt;</span></span><br><span class="line">      <span class="keyword">from</span>(axios.get(<span class="string">"http://localhost:3005/userInfo"</span>)).pipe(pluck(<span class="string">"data"</span>))</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line">  .subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<h3 id="17-HttpClientModule的基本使用-1"><a href="#17-HttpClientModule的基本使用-1" class="headerlink" title="17.HttpClientModule的基本使用"></a>17.HttpClientModule的基本使用</h3><p>该模块用于发送 Http 请求，用于发送请求的方法都返回 Observable 对象。</p>
<h4 id="1-快速开始-1"><a href="#1-快速开始-1" class="headerlink" title="1. 快速开始"></a>1. 快速开始</h4><ol>
<li><p>引入 HttpClientModule 模块</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.module.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; httpClientModule &#125; <span class="keyword">from</span> <span class="string">'@angular/common/http'</span>;</span><br><span class="line">imports: [</span><br><span class="line">  httpClientModule</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>注入 HttpClient 服务实例对象，用于发送请求</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.component.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; HttpClient &#125; <span class="keyword">from</span> <span class="string">'@angular/common/http'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">	<span class="keyword">constructor</span>(private http: HttpClient) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>发送请求</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HttpClient &#125; <span class="keyword">from</span> <span class="string">"@angular/common/http"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> <span class="title">implements</span> <span class="title">OnInit</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(private http: HttpClient) &#123;&#125;</span><br><span class="line">  ngOnInit() &#123;</span><br><span class="line">    <span class="keyword">this</span>.getUsers().subscribe(<span class="built_in">console</span>.log)</span><br><span class="line">  &#125;</span><br><span class="line">  getUsers() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.http.get(<span class="string">"https://jsonplaceholder.typicode.com/users"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="2-请求方法-1"><a href="#2-请求方法-1" class="headerlink" title="2. 请求方法"></a>2. 请求方法</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.http.get(url [, options]);</span><br><span class="line"><span class="keyword">this</span>.http.post(url, data [, options]);</span><br><span class="line"><span class="keyword">this</span>.http.delete(url [, options]);</span><br><span class="line"><span class="keyword">this</span>.http.put(url, data [, options]);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.http.get&lt;Post[]&gt;(<span class="string">'/getAllPosts'</span>)</span><br><span class="line">  .subscribe(<span class="function"><span class="params">response</span> =&gt;</span> <span class="built_in">console</span>.log(response))</span><br></pre></td></tr></table></figure>

<h3 id="18-HttpParams类的使用-1"><a href="#18-HttpParams类的使用-1" class="headerlink" title="18.HttpParams类的使用"></a>18.HttpParams类的使用</h3><ol>
<li><p>HttpParams 类</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> declare <span class="class"><span class="keyword">class</span> <span class="title">HttpParams</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(options?: HttpParamsOptions);</span><br><span class="line">    has(param: string): boolean;</span><br><span class="line">    <span class="keyword">get</span>(param: string): string | null;</span><br><span class="line">    getAll(param: string): string[] | null;</span><br><span class="line">    keys(): string[];</span><br><span class="line">    append(param: string, value: string): HttpParams;</span><br><span class="line">    <span class="keyword">set</span>(param: string, value: string): HttpParams;</span><br><span class="line">    delete(param: string, value?: string): HttpParams;</span><br><span class="line">    toString(): string;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>HttpParamsOptions 接口</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">declare interface HttpParamsOptions &#123;</span><br><span class="line">    fromString?: string;</span><br><span class="line">    fromObject?: &#123;</span><br><span class="line">        [param: string]: string | ReadonlyArray&lt;string&gt;;</span><br><span class="line">    &#125;;</span><br><span class="line">    encoder?: HttpParameterCodec;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用示例</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HttpParams &#125; <span class="keyword">from</span> <span class="string">'@angular/common/http'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> params = <span class="keyword">new</span> HttpParams(&#123; <span class="attr">fromObject</span>: &#123;<span class="attr">name</span>: <span class="string">"zhangsan"</span>, <span class="attr">age</span>: <span class="string">"20"</span>&#125;&#125;)</span><br><span class="line">params = params.append(<span class="string">"sex"</span>, <span class="string">"male"</span>)</span><br><span class="line"><span class="keyword">let</span> params = <span class="keyword">new</span> HttpParams(&#123; <span class="attr">fromString</span>: <span class="string">"name=zhangsan&amp;age=20"</span>&#125;)</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="19-HttpHeaders类的使用-1"><a href="#19-HttpHeaders类的使用-1" class="headerlink" title="19.HttpHeaders类的使用"></a>19.HttpHeaders类的使用</h3><p>请求头字段的创建需要使用 HttpHeaders 类，在类实例对象下面有各种操作请求头的方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> declare <span class="class"><span class="keyword">class</span> <span class="title">HttpHeaders</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(headers?: string | &#123;</span><br><span class="line">        [name: string]: string | string[];</span><br><span class="line">    &#125;);</span><br><span class="line">    has(name: string): boolean;</span><br><span class="line">    <span class="keyword">get</span>(name: string): string | null;</span><br><span class="line">    keys(): string[];</span><br><span class="line">    getAll(name: string): string[] | null;</span><br><span class="line">    append(name: string, value: string | string[]): HttpHeaders;</span><br><span class="line">    <span class="keyword">set</span>(name: string, value: string | string[]): HttpHeaders;</span><br><span class="line">    delete(name: string, value?: string | string[]): HttpHeaders;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> headers = <span class="keyword">new</span> HttpHeaders(&#123; <span class="attr">test</span>: <span class="string">"Hello"</span> &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="20-设置响应体-1"><a href="#20-设置响应体-1" class="headerlink" title="20.设置响应体"></a>20.设置响应体</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">declare type HttpObserve = <span class="string">'body'</span> | <span class="string">'response'</span>;</span><br><span class="line"><span class="comment">// response 读取完整响应体</span></span><br><span class="line"><span class="comment">// body 读取服务器端返回的数据</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.http.get(</span><br><span class="line">  <span class="string">"https://jsonplaceholder.typicode.com/users"</span>, </span><br><span class="line">  &#123; <span class="attr">observe</span>: <span class="string">"body"</span> &#125;</span><br><span class="line">).subscribe(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<h3 id="21-拦截器的使用-一-1"><a href="#21-拦截器的使用-一-1" class="headerlink" title="21.拦截器的使用(一)"></a>21.拦截器的使用(一)</h3><p>拦截器是 Angular 应用中全局捕获和修改 HTTP 请求和响应的方式。（Token、Error）<br>拦截器将只拦截使用 HttpClientModule 模块发出的请求。</p>
<p><code>ng g interceptor &lt;name&gt;</code></p>
<ol>
<li>请求拦截</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">@Injectable()</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthInterceptor</span> <span class="title">implements</span> <span class="title">HttpInterceptor</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;&#125;</span><br><span class="line">	<span class="comment">// 拦截方法</span></span><br><span class="line">  intercept(</span><br><span class="line">  	<span class="comment">// unknown 指定请求体 (body) 的类型</span></span><br><span class="line">    request: HttpRequest&lt;unknown&gt;,</span><br><span class="line">    next: HttpHandler</span><br><span class="line">     <span class="comment">// unknown 指定响应内容 (body) 的类型</span></span><br><span class="line">  ): Observable&lt;HttpEvent&lt;unknown&gt;&gt; &#123;</span><br><span class="line">    <span class="comment">// 克隆并修改请求头</span></span><br><span class="line">    <span class="keyword">const</span> req = request.clone(&#123;</span><br><span class="line">      setHeaders: &#123;</span><br><span class="line">        Authorization: <span class="string">"Bearer xxxxxxx"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 通过回调函数将修改后的请求头回传给应用</span></span><br><span class="line">    <span class="keyword">return</span> next.handle(req)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>响应拦截</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@Injectable() </span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthInterceptor</span> <span class="title">implements</span> <span class="title">HttpInterceptor</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;&#125;</span><br><span class="line">	<span class="comment">// 拦截方法</span></span><br><span class="line">  intercept(</span><br><span class="line">    request: HttpRequest&lt;unknown&gt;,</span><br><span class="line">    next: HttpHandler</span><br><span class="line">  ): Observable&lt;any&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> next.handle(request).pipe(</span><br><span class="line">      retry(<span class="number">2</span>),</span><br><span class="line">      catchError(<span class="function">(<span class="params">error: HttpErrorResponse</span>) =&gt;</span> throwError(error))</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="22-拦截器的使用-二-1"><a href="#22-拦截器的使用-二-1" class="headerlink" title="22.拦截器的使用(二)"></a>22.拦截器的使用(二)</h3><blockquote>
<p>拦截器注入</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; AuthInterceptor &#125; <span class="keyword">from</span> <span class="string">"./auth.interceptor"</span></span><br><span class="line"><span class="keyword">import</span> &#123; HTTP_INTERCEPTORS &#125; <span class="keyword">from</span> <span class="string">"@angular/common/http"</span></span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  providers: [</span><br><span class="line">    &#123;</span><br><span class="line">      provide: HTTP_INTERCEPTORS,</span><br><span class="line">      useClass: AuthInterceptor,</span><br><span class="line">      multi: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="23-配置AngularProxy-1"><a href="#23-配置AngularProxy-1" class="headerlink" title="23.配置AngularProxy"></a>23.配置AngularProxy</h3><ol>
<li><p>在项目的根目录下创建  proxy.conf.json 文件并加入如下代码</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> 	<span class="attr">"/api/*"</span>: &#123;</span><br><span class="line">    <span class="attr">"target"</span>: <span class="string">"http://localhost:3070"</span>,</span><br><span class="line">    <span class="attr">"secure"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"changeOrigin"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>/api/*：在应用中发出的以 /api 开头的请求走此代理</li>
<li>target：服务器端 URL</li>
<li>secure：如果服务器端 URL 的协议是 https，此项需要为 true</li>
<li>changeOrigin：如果服务器端不是 localhost， 此项需要为 true</li>
</ol>
</li>
<li><p>指定 proxy 配置文件 (方式一) </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">  <span class="string">"start"</span>: <span class="string">"ng serve --proxy-config proxy.conf.json"</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定 proxy 配置文件 (方式二)</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">"serve": &#123;</span><br><span class="line">  "options": &#123;</span><br><span class="line">    "proxyConfig": "proxy.conf.json"</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="24-NgRx概述-1"><a href="#24-NgRx概述-1" class="headerlink" title="24.NgRx概述"></a>24.NgRx概述</h3><h3 id="25-NgRx基本使用-1"><a href="#25-NgRx基本使用-1" class="headerlink" title="25.NgRx基本使用"></a>25.NgRx基本使用</h3><h3 id="26-selector的用法-1"><a href="#26-selector的用法-1" class="headerlink" title="26.selector的用法"></a>26.selector的用法</h3><h3 id="27-Action传递参数-1"><a href="#27-Action传递参数-1" class="headerlink" title="27.Action传递参数"></a>27.Action传递参数</h3><h3 id="28-metaReducer机制介绍-1"><a href="#28-metaReducer机制介绍-1" class="headerlink" title="28.metaReducer机制介绍"></a>28.metaReducer机制介绍</h3><h3 id="29-使用Effect接收Action执行副作用-1"><a href="#29-使用Effect接收Action执行副作用-1" class="headerlink" title="29.使用Effect接收Action执行副作用"></a>29.使用Effect接收Action执行副作用</h3><h3 id="30-ngrx案例todo之添加任务-1"><a href="#30-ngrx案例todo之添加任务-1" class="headerlink" title="30.ngrx案例todo之添加任务"></a>30.ngrx案例todo之添加任务</h3><h3 id="31-案例todo之展示任务-1"><a href="#31-案例todo之展示任务-1" class="headerlink" title="31.案例todo之展示任务"></a>31.案例todo之展示任务</h3><h3 id="32-案例todo之删除任务-1"><a href="#32-案例todo之删除任务-1" class="headerlink" title="32.案例todo之删除任务"></a>32.案例todo之删除任务</h3><h3 id="33-在todo案例中加入Entity简化实体操作-1"><a href="#33-在todo案例中加入Entity简化实体操作-1" class="headerlink" title="33.在todo案例中加入Entity简化实体操作"></a>33.在todo案例中加入Entity简化实体操作</h3><p>Entity 译为实体，实体就是集合中的一条数据。</p>
<p>NgRx 中提供了实体适配器对象，在实体适配器对象下面提供了各种操作集合中实体的方法，目的就是提高开发者操作实体的效率。</p>
<blockquote>
<p>核心</p>
</blockquote>
<ol>
<li><p>EntityState：实体类型接口</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	&#123;</span></span><br><span class="line"><span class="comment">		ids: [1, 2],</span></span><br><span class="line"><span class="comment">		entities: &#123;</span></span><br><span class="line"><span class="comment">			1: &#123; id: 1, title: "Hello Angular" &#125;,</span></span><br><span class="line"><span class="comment">			2: &#123; id: 2, title: "Hello NgRx" &#125;</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">export</span> interface State extends EntityState&lt;Todo&gt; &#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>createEntityAdapter： 创建实体适配器对象</p>
</li>
<li><p>EntityAdapter：实体适配器对象类型接口</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> adapter: EntityAdapter&lt;Todo&gt; = createEntityAdapter&lt;Todo&gt;()</span><br><span class="line"><span class="comment">// 获取初始状态 可以传递对象参数 也可以不传</span></span><br><span class="line"><span class="comment">// &#123;ids: [], entities: &#123;&#125;&#125;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> initialState: State = adapter.getInitialState()</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h5 id="15-6-3-实例方法-1"><a href="#15-6-3-实例方法-1" class="headerlink" title="15.6.3 实例方法"></a>15.6.3 实例方法</h5><p><a href="https://ngrx.io/guide/entity/adapter#adapter-collection-methods" target="_blank" rel="noopener">https://ngrx.io/guide/entity/adapter#adapter-collection-methods</a></p>
<h5 id="15-6-4-选择器-1"><a href="#15-6-4-选择器-1" class="headerlink" title="15.6.4 选择器"></a>15.6.4 选择器</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// selectTotal 获取数据条数</span></span><br><span class="line"><span class="comment">// selectAll 获取所有数据 以数组形式呈现</span></span><br><span class="line"><span class="comment">// selectEntities 获取实体集合 以字典形式呈现</span></span><br><span class="line"><span class="comment">// selectIds 获取id集合, 以数组形式呈现</span></span><br><span class="line"><span class="keyword">const</span> &#123; selectIds, selectEntities, selectAll, selectTotal &#125; = adapter.getSelectors();</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> selectTodo = createFeatureSelector&lt;AppState, State&gt;(todoFeatureKey)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> selectTodos = createSelector(selectTodo, selectAll)</span><br></pre></td></tr></table></figure>

<h3 id="34-将路由状态同步到Store中-1"><a href="#34-将路由状态同步到Store中-1" class="headerlink" title="34.将路由状态同步到Store中"></a>34.将路由状态同步到Store中</h3><ol>
<li><p>引入模块</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; StoreRouterConnectingModule &#125; <span class="keyword">from</span> <span class="string">"@ngrx/router-store"</span></span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  imports: [</span><br><span class="line">    StoreRouterConnectingModule.forRoot()</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将路由状态集成到 Store</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> fromRouter <span class="keyword">from</span> <span class="string">"@ngrx/router-store"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> interface AppState &#123;</span><br><span class="line">  router: fromRouter.RouterReducerState</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> reducers: ActionReducerMap&lt;AppState&gt; = &#123;</span><br><span class="line">  router: fromRouter.routerReducer</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<blockquote>
<p>创建获取路由状态的 Selector</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// router.selectors.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; createFeatureSelector &#125; <span class="keyword">from</span> <span class="string">"@ngrx/store"</span></span><br><span class="line"><span class="keyword">import</span> &#123; AppState &#125; <span class="keyword">from</span> <span class="string">".."</span></span><br><span class="line"><span class="keyword">import</span> &#123; RouterReducerState, getSelectors &#125; <span class="keyword">from</span> <span class="string">"@ngrx/router-store"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> selectRouter = createFeatureSelector&lt;AppState, RouterReducerState&gt;(</span><br><span class="line">  <span class="string">"router"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123;</span><br><span class="line">  <span class="comment">// 获取和当前路由相关的信息 (路由参数、路由配置等)</span></span><br><span class="line">  selectCurrentRoute,</span><br><span class="line">  <span class="comment">// 获取地址栏中 # 号后面的内容</span></span><br><span class="line">  selectFragment,</span><br><span class="line">  <span class="comment">// 获取路由查询参数</span></span><br><span class="line">  selectQueryParams,</span><br><span class="line">  <span class="comment">// 获取具体的某一个查询参数 selectQueryParam('name')</span></span><br><span class="line">  selectQueryParam,</span><br><span class="line">  <span class="comment">// 获取动态路由参数</span></span><br><span class="line">  selectRouteParams,</span><br><span class="line"> 	<span class="comment">// 获取某一个具体的动态路由参数 selectRouteParam('name')</span></span><br><span class="line">  selectRouteParam,</span><br><span class="line">  <span class="comment">// 获取路由自定义数据</span></span><br><span class="line">  selectRouteData,</span><br><span class="line">  <span class="comment">// 获取路由的实际访问地址</span></span><br><span class="line">  selectUrl</span><br><span class="line">&#125; = getSelectors(selectRouter)</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// home.component.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; select, Store &#125; <span class="keyword">from</span> <span class="string">"@ngrx/store"</span></span><br><span class="line"><span class="keyword">import</span> &#123; AppState &#125; <span class="keyword">from</span> <span class="string">"src/app/store"</span></span><br><span class="line"><span class="keyword">import</span> &#123; selectQueryParams &#125; <span class="keyword">from</span> <span class="string">"src/app/store/selectors/router.selectors"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AboutComponent</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(private store: Store&lt;AppState&gt;) &#123;</span><br><span class="line">    <span class="keyword">this</span>.store.pipe(select(selectQueryParams)).subscribe(<span class="built_in">console</span>.log)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="35-和状态相关的概念-1"><a href="#35-和状态相关的概念-1" class="headerlink" title="35.和状态相关的概念"></a>35.和状态相关的概念</h3><blockquote>
<p>什么是状态</p>
</blockquote>
<p>状态表示的是要进行运动的元素在运动的不同时期所呈现的样式。</p>
<blockquote>
<p>状态的种类</p>
</blockquote>
<p>在 Angular 中，有三种类型的状态，分别为：<code>void</code>、<code>*</code>、<code>custom</code></p>
<p>void：当元素在内存中创建好但尚未被添加到 DOM 中或将元素从 DOM 中删除时会发生此状态</p>
<p>*：元素被插入到 DOM 树之后的状态，或者是已经在DOM树中的元素的状态，也叫默认状态</p>
<p>custom：自定义状态，元素默认就在页面之中，从一个状态运动到另一个状态，比如面板的折叠和展开。</p>
<blockquote>
<p>为todo案例添加进场动画和出场动画</p>
</blockquote>
<ul>
<li>进场动画是指元素被创建后以动画的形式出现在用户面前，进场动画的状态用 <code>void =&gt; *</code> 表示，别名为 <code>:enter</code></li>
<li>出场动画是指元素在被删除前执行的一段告别动画，出场动画的状态用 <code>* =&gt; void</code>，别名为 <code>:leave</code></li>
</ul>
<blockquote>
<p>快速上手</p>
</blockquote>
<ol>
<li><p>在使用动画功能之前，需要引入动画模块，即 <code>BrowserAnimationsModule</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BrowserAnimationsModule &#125; <span class="keyword">from</span> <span class="string">"@angular/platform-browser/animations"</span></span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  imports: [BrowserAnimationsModule],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>默认代码解析，todo 之删除任务和添加任务</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在 index.html 文件中引入 bootstrap.min.css --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Todos<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> (<span class="attr">keyup.enter</span>)=<span class="string">"addItem(input)"</span> #<span class="attr">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"add todos"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"list-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> (<span class="attr">click</span>)=<span class="string">"removeItem(i)"</span> *<span class="attr">ngFor</span>=<span class="string">"let item of todos; let i = index"</span> <span class="attr">class</span>=<span class="string">"list-group-item"</span>&gt;</span></span><br><span class="line">      &#123;&#123; item &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-root"</span>,</span><br><span class="line">  templateUrl: <span class="string">"./app.component.html"</span>,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  <span class="comment">// todo 列表</span></span><br><span class="line">  todos: string[] = [<span class="string">"Learn Angular"</span>, <span class="string">"Learn RxJS"</span>, <span class="string">"Learn NgRx"</span>]</span><br><span class="line">	<span class="comment">// 添加 todo</span></span><br><span class="line">  addItem(input: HTMLInputElement) &#123;</span><br><span class="line">    <span class="keyword">this</span>.todos.push(input.value)</span><br><span class="line">    input.value = <span class="string">""</span></span><br><span class="line">  &#125;</span><br><span class="line">	<span class="comment">// 删除 todo</span></span><br><span class="line">  removeItem(index: number) &#123;</span><br><span class="line">    <span class="keyword">this</span>.todos.splice(index, <span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<ol>
<li>trigger 方法用于创建动画，指定动画名称</li>
<li>transition 方法用于指定动画的运动状态，出场动画或者入场动画，或者自定义状态动画。</li>
<li>style 方法用于设置元素在不同的状态下所对应的样式</li>
<li>animate 方法用于设置运动参数，比如动画运动时间，延迟事件，运动形式</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@Component(&#123;</span><br><span class="line">  animations: [</span><br><span class="line">    <span class="comment">// 创建动画, 动画名称为 slide</span></span><br><span class="line">    trigger(<span class="string">"slide"</span>, [</span><br><span class="line">      <span class="comment">// 指定入场动画 注意: 字符串两边不能有空格, 箭头两边可以有也可以没有空格</span></span><br><span class="line">      <span class="comment">// void =&gt; * 可以替换为 :enter</span></span><br><span class="line">      transition(<span class="string">"void =&gt; *"</span>, [</span><br><span class="line">        <span class="comment">// 指定元素未入场前的样式</span></span><br><span class="line">        style(&#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">"translateY(40px)"</span> &#125;),</span><br><span class="line">        <span class="comment">// 指定元素入场后的样式及运动参数</span></span><br><span class="line">        animate(<span class="number">250</span>, style(&#123; <span class="attr">opacity</span>: <span class="number">1</span>, <span class="attr">transform</span>: <span class="string">"translateY(0)"</span> &#125;))</span><br><span class="line">      ]),</span><br><span class="line">      <span class="comment">// 指定出场动画</span></span><br><span class="line">      <span class="comment">// * =&gt; void 可以替换为 :leave</span></span><br><span class="line">      transition(<span class="string">"* =&gt; void"</span>, [</span><br><span class="line">        <span class="comment">// 指定元素出场后的样式和运动参数</span></span><br><span class="line">        animate(<span class="number">600</span>, style(&#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span> &#125;))</span><br><span class="line">      ])</span><br><span class="line">    ])</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> @<span class="attr">slide</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="37-创建动画时的两个注意事项-1"><a href="#37-创建动画时的两个注意事项-1" class="headerlink" title="37.创建动画时的两个注意事项"></a>37.创建动画时的两个注意事项</h3><p>   注意：入场动画中可以不指定元素的默认状态，Angular 会将 void 状态清空作为默认状态</p>
   <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">   trigger(<span class="string">"slide"</span>, [</span><br><span class="line">     transition(<span class="string">":enter"</span>, [</span><br><span class="line">       style(&#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">"translateY(40px)"</span> &#125;),</span><br><span class="line">       animate(<span class="number">250</span>)</span><br><span class="line">     ]),</span><br><span class="line">     transition(<span class="string">":leave"</span>, [</span><br><span class="line">    		animate(<span class="number">600</span>, style(&#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span> &#125;))</span><br><span class="line">     ])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<p>   注意：要设置动画的运动参数，需要将 animate 方法的一个参数更改为字符串类型</p>
   <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 动画执行总时间 延迟时间 (可选) 运动形式 (可选)</span></span><br><span class="line">animate(<span class="string">"600ms 1s ease-out"</span>, style(&#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span> &#125;))</span><br></pre></td></tr></table></figure>

<h3 id="38-定义关键帧动画-1"><a href="#38-定义关键帧动画-1" class="headerlink" title="38.定义关键帧动画"></a>38.定义关键帧动画</h3><p>关键帧动画使用 <code>keyframes</code> 方法定义</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">transition(<span class="string">":leave"</span>, [</span><br><span class="line">  animate(</span><br><span class="line">    <span class="number">600</span>,</span><br><span class="line">    keyframes([</span><br><span class="line">      style(&#123; <span class="attr">offset</span>: <span class="number">0.3</span>, <span class="attr">transform</span>: <span class="string">"translateX(-80px)"</span> &#125;),</span><br><span class="line">      style(&#123; <span class="attr">offset</span>: <span class="number">1</span>, <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span> &#125;)</span><br><span class="line">    ])</span><br><span class="line">  )</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<h3 id="39-指定动画的回调函数-1"><a href="#39-指定动画的回调函数-1" class="headerlink" title="39.指定动画的回调函数"></a>39.指定动画的回调函数</h3><p>Angular 提供了和动画相关的两个回调函数，分别为动画开始执行时和动画执行完成后</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> @<span class="attr">slide</span> (@<span class="attr">slide.start</span>)=<span class="string">"start($event)"</span> (@<span class="attr">slide.done</span>)=<span class="string">"done($event)"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; AnimationEvent &#125; <span class="keyword">from</span> <span class="string">"@angular/animations"</span></span><br><span class="line"></span><br><span class="line">start(event: AnimationEvent) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(event)</span><br><span class="line">&#125;</span><br><span class="line">done(event: AnimationEvent) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(event)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="40-创建可重用动画-1"><a href="#40-创建可重用动画-1" class="headerlink" title="40.创建可重用动画"></a>40.创建可重用动画</h3><ol>
<li><p>将动画的定义放置在单独的文件中，方便多组件调用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; animate, keyframes, style, transition, trigger &#125; <span class="keyword">from</span> <span class="string">"@angular/animations"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> slide = trigger(<span class="string">"slide"</span>, [</span><br><span class="line">  transition(<span class="string">":enter"</span>, [</span><br><span class="line">    style(&#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">"translateY(40px)"</span> &#125;),</span><br><span class="line">    animate(<span class="number">250</span>)</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">":leave"</span>, [</span><br><span class="line">    animate(</span><br><span class="line">      <span class="number">600</span>,</span><br><span class="line">      keyframes([</span><br><span class="line">        style(&#123; <span class="attr">offset</span>: <span class="number">0.3</span>, <span class="attr">transform</span>: <span class="string">"translateX(-80px)"</span> &#125;),</span><br><span class="line">        style(&#123; <span class="attr">offset</span>: <span class="number">1</span>, <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span> &#125;)</span><br><span class="line">      ])</span><br><span class="line">    )</span><br><span class="line">  ])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; slide &#125; <span class="keyword">from</span> <span class="string">"./animations"</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  animations: [slide]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>抽取具体的动画定义，方便多动画调用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;animate, animation, keyframes, style, transition, trigger, useAnimation&#125; <span class="keyword">from</span> <span class="string">"@angular/animations"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> slideInUp = animation([</span><br><span class="line">  style(&#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">"translateY(40px)"</span> &#125;),</span><br><span class="line">  animate(<span class="number">250</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> slideOutLeft = animation([</span><br><span class="line">  animate(</span><br><span class="line">    <span class="number">600</span>,</span><br><span class="line">    keyframes([</span><br><span class="line">      style(&#123; <span class="attr">offset</span>: <span class="number">0.3</span>, <span class="attr">transform</span>: <span class="string">"translateX(-80px)"</span> &#125;),</span><br><span class="line">      style(&#123; <span class="attr">offset</span>: <span class="number">1</span>, <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span> &#125;)</span><br><span class="line">    ])</span><br><span class="line">  )</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> slide = trigger(<span class="string">"slide"</span>, [</span><br><span class="line">  transition(<span class="string">":enter"</span>, useAnimation(slideInUp)),</span><br><span class="line">  transition(<span class="string">":leave"</span>, useAnimation(slideOutLeft))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
</li>
<li><p>调用动画时传递运动总时间，延迟时间，运动形式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> slideInUp = animation(</span><br><span class="line">  [</span><br><span class="line">    style(&#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">transform</span>: <span class="string">"translateY(40px)"</span> &#125;),</span><br><span class="line">    animate(<span class="string">"&#123;&#123; duration &#125;&#125; &#123;&#123; delay &#125;&#125; &#123;&#123; easing &#125;&#125;"</span>)</span><br><span class="line">  ],</span><br><span class="line">  &#123;</span><br><span class="line">    params: &#123;</span><br><span class="line">      duration: <span class="string">"400ms"</span>,</span><br><span class="line">      delay: <span class="string">"0s"</span>,</span><br><span class="line">      easing: <span class="string">"ease-out"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">transition(<span class="string">":enter"</span>, useAnimation(slideInUp, &#123;<span class="attr">params</span>: &#123;<span class="attr">delay</span>: <span class="string">"1s"</span>&#125;&#125;))</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="41-query方法的使用-1"><a href="#41-query方法的使用-1" class="headerlink" title="41.query方法的使用"></a>41.query方法的使用</h3><p>Angular 中提供了 <code>query</code> 方法查找元素并为元素创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; slide &#125; <span class="keyword">from</span> <span class="string">"./animations"</span></span><br><span class="line"></span><br><span class="line">animations: [</span><br><span class="line">  slide,</span><br><span class="line">  trigger(<span class="string">"todoAnimations"</span>, [</span><br><span class="line">    transition(<span class="string">":enter"</span>, [</span><br><span class="line">      query(<span class="string">"h2"</span>, [</span><br><span class="line">        style(&#123; <span class="attr">transform</span>: <span class="string">"translateY(-30px)"</span> &#125;),</span><br><span class="line">        animate(<span class="number">300</span>)</span><br><span class="line">      ]),</span><br><span class="line">      <span class="comment">// 查询子级动画 使其执行</span></span><br><span class="line">      query(<span class="string">"@slide"</span>, animateChild())</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span> @<span class="attr">todoAnimations</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Todos<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"list-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">slide</span></span></span><br><span class="line"><span class="tag">      (<span class="attr">click</span>)=<span class="string">"removeItem(i)"</span></span></span><br><span class="line"><span class="tag">      *<span class="attr">ngFor</span>=<span class="string">"let item of todos; let i = index"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"list-group-item"</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      &#123;&#123; item &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="42-group方法的使用-1"><a href="#42-group方法的使用-1" class="headerlink" title="42.group方法的使用"></a>42.group方法的使用</h3><p>默认情况下，父级动画和子级动画按照顺序执行，先执行父级动画，再执行子级动画，可以使用  <code>group</code> 方法让其并行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"todoAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">":enter"</span>, [</span><br><span class="line">    group([</span><br><span class="line">      query(<span class="string">"h2"</span>, [</span><br><span class="line">        style(&#123; <span class="attr">transform</span>: <span class="string">"translateY(-30px)"</span> &#125;),</span><br><span class="line">        animate(<span class="number">300</span>)</span><br><span class="line">      ]),</span><br><span class="line">      query(<span class="string">"@slide"</span>, animateChild())</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<h3 id="43-使用stagger方法实现交错动画-1"><a href="#43-使用stagger方法实现交错动画-1" class="headerlink" title="43.使用stagger方法实现交错动画"></a>43.使用stagger方法实现交错动画</h3><p>Angular 提供了 stagger 方法，在多个元素同时执行同一个动画时，让每个元素动画的执行依次延迟。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">transition(<span class="string">":enter"</span>, [</span><br><span class="line">  group([</span><br><span class="line">    query(<span class="string">"h2"</span>, [</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateY(-30px)"</span> &#125;),</span><br><span class="line">      animate(<span class="number">300</span>)</span><br><span class="line">    ]),</span><br><span class="line">    query(<span class="string">"@slide"</span>, stagger(<span class="number">200</span>, animateChild()))</span><br><span class="line">  ])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<p>注意：stagger 方法只能在 query 方法内部使用</p>
<h3 id="44-创建自定义状态动画-1"><a href="#44-创建自定义状态动画-1" class="headerlink" title="44.创建自定义状态动画"></a>44.创建自定义状态动画</h3><p>Angular 提供了 <code>state</code> 方法用于定义状态。</p>
<ol>
<li><p>默认代码解析</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-default"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-heading"</span> (<span class="attr">click</span>)=<span class="string">"toggle()"</span>&gt;</span></span><br><span class="line">      一套框架, 多种平台, 移动端 &amp; 桌面端</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        使用简单的声明式模板，快速实现各种特性。使用自定义组件和大量现有组件，扩展模板语言。在几乎所有的</span><br><span class="line">        IDE 中获得针对 Angular</span><br><span class="line">        的即时帮助和反馈。所有这一切，都是为了帮助你编写漂亮的应用，而不是绞尽脑汁的让代码“能用”。</span><br><span class="line">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        从原型到全球部署，Angular 都能带给你支撑 Google</span><br><span class="line">        大型应用的那些高延展性基础设施与技术。</span><br><span class="line">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        通过 Web Worker 和服务端渲染，达到在如今(以及未来）的 Web</span><br><span class="line">        平台上所能达到的最高速度。 Angular 让你有效掌控可伸缩性。基于</span><br><span class="line">        RxJS、Immutable.js 和其它推送模型，能适应海量数据需求。</span><br><span class="line">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        学会用 Angular</span><br><span class="line">        构建应用，然后把这些代码和能力复用在多种多种不同平台的应用上 ——</span><br><span class="line">        Web、移动 Web、移动应用、原生应用和桌面原生应用。</span><br><span class="line">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.container</span> &#123;</span></span><br><span class="line">    margin-top: 100px;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.panel-heading</span> &#123;</span></span><br><span class="line">    cursor: pointer;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-root"</span>,</span><br><span class="line">  templateUrl: <span class="string">"./app.component.html"</span>,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  isExpended: boolean = <span class="literal">false</span></span><br><span class="line">  toggle() &#123;</span><br><span class="line">    <span class="keyword">this</span>.isExpended = !<span class="keyword">this</span>.isExpended</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"expandCollapse"</span>, [</span><br><span class="line">  <span class="comment">// 使用 state 方法定义折叠状态元素对应的样式</span></span><br><span class="line">  state(</span><br><span class="line">    <span class="string">"collapsed"</span>,</span><br><span class="line">    style(&#123;</span><br><span class="line">      height: <span class="number">0</span>,</span><br><span class="line">      overflow: <span class="string">"hidden"</span>,</span><br><span class="line">      paddingTop: <span class="number">0</span>,</span><br><span class="line">      paddingBottom: <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// 使用 state 方法定义展开状态元素对应的样式</span></span><br><span class="line">  state(<span class="string">"expanded"</span>, style(&#123; <span class="attr">height</span>: <span class="string">"*"</span>, <span class="attr">overflow</span>: <span class="string">"auto"</span> &#125;)),</span><br><span class="line">  <span class="comment">// 定义展开动画</span></span><br><span class="line">  transition(<span class="string">"collapsed =&gt; expanded"</span>, animate(<span class="string">"400ms ease-out"</span>)),</span><br><span class="line">  <span class="comment">// 定义折叠动画</span></span><br><span class="line">  transition(<span class="string">"expanded =&gt; collapsed"</span>, animate(<span class="string">"400ms ease-in"</span>))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> [@<span class="attr">expandCollapse</span>]=<span class="string">"isExpended ? 'expanded' : 'collapsed'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="45-实现路由动画-8"><a href="#45-实现路由动画-8" class="headerlink" title="45.实现路由动画"></a>45.实现路由动画</h3><ol>
<li><p>为路由添加状态标识，此标识即为路由执行动画时的自定义状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    pathMatch: <span class="string">"full"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"one"</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"two"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"news"</span>,</span><br><span class="line">    component: NewsComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"three"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过路由插座对象获取路由状态标识，并将标识传递给动画的调用者，让动画执行当前要执行的状态是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"routerContainer"</span> [@<span class="attr">routerAnimations</span>]=<span class="string">"prepareRoute(outlet)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> #<span class="attr">outlet</span>=<span class="string">"outlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  prepareRoute(outlet: RouterOutlet) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      outlet &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData.animation</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 routerContainer 设置为相对定位，将它的直接一级子元素设置成绝对定位</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* styles.css */</span></span><br><span class="line"><span class="selector-class">.routerContainer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.routerContainer</span> &gt; * &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"routerAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">"one =&gt; two, one =&gt; three, two =&gt; three"</span>, [</span><br><span class="line">    query(<span class="string">":enter"</span>, style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(-100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">"three =&gt; two, three =&gt; one, two =&gt; one"</span>, [</span><br><span class="line">    query(</span><br><span class="line">      <span class="string">":enter"</span>,</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(-100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    ),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br><span class="line"><span class="string">``</span><span class="string">`     .container &#123;</span></span><br><span class="line"><span class="string">    margin-top: 100px;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  .panel-heading &#123;</span></span><br><span class="line"><span class="string">    cursor: pointer;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&lt;/style&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-root"</span>,</span><br><span class="line">  templateUrl: <span class="string">"./app.component.html"</span>,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  isExpended: boolean = <span class="literal">false</span></span><br><span class="line">  toggle() &#123;</span><br><span class="line">    <span class="keyword">this</span>.isExpended = !<span class="keyword">this</span>.isExpended</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"expandCollapse"</span>, [</span><br><span class="line">  <span class="comment">// 使用 state 方法定义折叠状态元素对应的样式</span></span><br><span class="line">  state(</span><br><span class="line">    <span class="string">"collapsed"</span>,</span><br><span class="line">    style(&#123;</span><br><span class="line">      height: <span class="number">0</span>,</span><br><span class="line">      overflow: <span class="string">"hidden"</span>,</span><br><span class="line">      paddingTop: <span class="number">0</span>,</span><br><span class="line">      paddingBottom: <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// 使用 state 方法定义展开状态元素对应的样式</span></span><br><span class="line">  state(<span class="string">"expanded"</span>, style(&#123; <span class="attr">height</span>: <span class="string">"*"</span>, <span class="attr">overflow</span>: <span class="string">"auto"</span> &#125;)),</span><br><span class="line">  <span class="comment">// 定义展开动画</span></span><br><span class="line">  transition(<span class="string">"collapsed =&gt; expanded"</span>, animate(<span class="string">"400ms ease-out"</span>)),</span><br><span class="line">  <span class="comment">// 定义折叠动画</span></span><br><span class="line">  transition(<span class="string">"expanded =&gt; collapsed"</span>, animate(<span class="string">"400ms ease-in"</span>))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> [@<span class="attr">expandCollapse</span>]=<span class="string">"isExpended ? 'expanded' : 'collapsed'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="45-实现路由动画-9"><a href="#45-实现路由动画-9" class="headerlink" title="45.实现路由动画"></a>45.实现路由动画</h3><ol>
<li><p>为路由添加状态标识，此标识即为路由执行动画时的自定义状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    pathMatch: <span class="string">"full"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"one"</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"two"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"news"</span>,</span><br><span class="line">    component: NewsComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"three"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过路由插座对象获取路由状态标识，并将标识传递给动画的调用者，让动画执行当前要执行的状态是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"routerContainer"</span> [@<span class="attr">routerAnimations</span>]=<span class="string">"prepareRoute(outlet)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> #<span class="attr">outlet</span>=<span class="string">"outlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  prepareRoute(outlet: RouterOutlet) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      outlet &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData.animation</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 routerContainer 设置为相对定位，将它的直接一级子元素设置成绝对定位</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* styles.css */</span></span><br><span class="line"><span class="selector-class">.routerContainer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.routerContainer</span> &gt; * &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"routerAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">"one =&gt; two, one =&gt; three, two =&gt; three"</span>, [</span><br><span class="line">    query(<span class="string">":enter"</span>, style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(-100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">"three =&gt; two, three =&gt; one, two =&gt; one"</span>, [</span><br><span class="line">    query(</span><br><span class="line">      <span class="string">":enter"</span>,</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(-100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    ),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<p>  .container {</p>
<pre><code>margin-top: 100px;</code></pre><p>  }<br>  .panel-heading {</p>
<pre><code>cursor: pointer;</code></pre><p>  }<br></style></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#96;&#96;&#96;javascript</span><br><span class="line">import &#123; Component &#125; from &quot;@angular&#x2F;core&quot;</span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: &quot;app-root&quot;,</span><br><span class="line">  templateUrl: &quot;.&#x2F;app.component.html&quot;,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line">export class AppComponent &#123;</span><br><span class="line">  isExpended: boolean &#x3D; false</span><br><span class="line">  toggle() &#123;</span><br><span class="line">    this.isExpended &#x3D; !this.isExpended</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"expandCollapse"</span>, [</span><br><span class="line">  <span class="comment">// 使用 state 方法定义折叠状态元素对应的样式</span></span><br><span class="line">  state(</span><br><span class="line">    <span class="string">"collapsed"</span>,</span><br><span class="line">    style(&#123;</span><br><span class="line">      height: <span class="number">0</span>,</span><br><span class="line">      overflow: <span class="string">"hidden"</span>,</span><br><span class="line">      paddingTop: <span class="number">0</span>,</span><br><span class="line">      paddingBottom: <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// 使用 state 方法定义展开状态元素对应的样式</span></span><br><span class="line">  state(<span class="string">"expanded"</span>, style(&#123; <span class="attr">height</span>: <span class="string">"*"</span>, <span class="attr">overflow</span>: <span class="string">"auto"</span> &#125;)),</span><br><span class="line">  <span class="comment">// 定义展开动画</span></span><br><span class="line">  transition(<span class="string">"collapsed =&gt; expanded"</span>, animate(<span class="string">"400ms ease-out"</span>)),</span><br><span class="line">  <span class="comment">// 定义折叠动画</span></span><br><span class="line">  transition(<span class="string">"expanded =&gt; collapsed"</span>, animate(<span class="string">"400ms ease-in"</span>))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> [@<span class="attr">expandCollapse</span>]=<span class="string">"isExpended ? 'expanded' : 'collapsed'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="45-实现路由动画-10"><a href="#45-实现路由动画-10" class="headerlink" title="45.实现路由动画"></a>45.实现路由动画</h3><ol>
<li><p>为路由添加状态标识，此标识即为路由执行动画时的自定义状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    pathMatch: <span class="string">"full"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"one"</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"two"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"news"</span>,</span><br><span class="line">    component: NewsComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"three"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过路由插座对象获取路由状态标识，并将标识传递给动画的调用者，让动画执行当前要执行的状态是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"routerContainer"</span> [@<span class="attr">routerAnimations</span>]=<span class="string">"prepareRoute(outlet)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> #<span class="attr">outlet</span>=<span class="string">"outlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  prepareRoute(outlet: RouterOutlet) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      outlet &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData.animation</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 routerContainer 设置为相对定位，将它的直接一级子元素设置成绝对定位</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* styles.css */</span></span><br><span class="line"><span class="selector-class">.routerContainer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.routerContainer</span> &gt; * &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"routerAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">"one =&gt; two, one =&gt; three, two =&gt; three"</span>, [</span><br><span class="line">    query(<span class="string">":enter"</span>, style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(-100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">"three =&gt; two, three =&gt; one, two =&gt; one"</span>, [</span><br><span class="line">    query(</span><br><span class="line">      <span class="string">":enter"</span>,</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(-100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    ),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br><span class="line"><span class="string">``</span><span class="string">`     .container &#123;</span></span><br><span class="line"><span class="string">    margin-top: 100px;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  .panel-heading &#123;</span></span><br><span class="line"><span class="string">    cursor: pointer;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&lt;/style&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-root"</span>,</span><br><span class="line">  templateUrl: <span class="string">"./app.component.html"</span>,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  isExpended: boolean = <span class="literal">false</span></span><br><span class="line">  toggle() &#123;</span><br><span class="line">    <span class="keyword">this</span>.isExpended = !<span class="keyword">this</span>.isExpended</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"expandCollapse"</span>, [</span><br><span class="line">  <span class="comment">// 使用 state 方法定义折叠状态元素对应的样式</span></span><br><span class="line">  state(</span><br><span class="line">    <span class="string">"collapsed"</span>,</span><br><span class="line">    style(&#123;</span><br><span class="line">      height: <span class="number">0</span>,</span><br><span class="line">      overflow: <span class="string">"hidden"</span>,</span><br><span class="line">      paddingTop: <span class="number">0</span>,</span><br><span class="line">      paddingBottom: <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// 使用 state 方法定义展开状态元素对应的样式</span></span><br><span class="line">  state(<span class="string">"expanded"</span>, style(&#123; <span class="attr">height</span>: <span class="string">"*"</span>, <span class="attr">overflow</span>: <span class="string">"auto"</span> &#125;)),</span><br><span class="line">  <span class="comment">// 定义展开动画</span></span><br><span class="line">  transition(<span class="string">"collapsed =&gt; expanded"</span>, animate(<span class="string">"400ms ease-out"</span>)),</span><br><span class="line">  <span class="comment">// 定义折叠动画</span></span><br><span class="line">  transition(<span class="string">"expanded =&gt; collapsed"</span>, animate(<span class="string">"400ms ease-in"</span>))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> [@<span class="attr">expandCollapse</span>]=<span class="string">"isExpended ? 'expanded' : 'collapsed'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="45-实现路由动画-11"><a href="#45-实现路由动画-11" class="headerlink" title="45.实现路由动画"></a>45.实现路由动画</h3><ol>
<li><p>为路由添加状态标识，此标识即为路由执行动画时的自定义状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    pathMatch: <span class="string">"full"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"one"</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"two"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"news"</span>,</span><br><span class="line">    component: NewsComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"three"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过路由插座对象获取路由状态标识，并将标识传递给动画的调用者，让动画执行当前要执行的状态是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"routerContainer"</span> [@<span class="attr">routerAnimations</span>]=<span class="string">"prepareRoute(outlet)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> #<span class="attr">outlet</span>=<span class="string">"outlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  prepareRoute(outlet: RouterOutlet) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      outlet &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData.animation</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 routerContainer 设置为相对定位，将它的直接一级子元素设置成绝对定位</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* styles.css */</span></span><br><span class="line"><span class="selector-class">.routerContainer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.routerContainer</span> &gt; * &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"routerAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">"one =&gt; two, one =&gt; three, two =&gt; three"</span>, [</span><br><span class="line">    query(<span class="string">":enter"</span>, style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(-100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">"three =&gt; two, three =&gt; one, two =&gt; one"</span>, [</span><br><span class="line">    query(</span><br><span class="line">      <span class="string">":enter"</span>,</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(-100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    ),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<p>  .container {</p>
<pre><code>margin-top: 100px;</code></pre><p>  }<br>  .panel-heading {</p>
<pre><code>cursor: pointer;</code></pre><p>  }<br></style></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#96;&#96;&#96;javascript</span><br><span class="line">import &#123; Component &#125; from &quot;@angular&#x2F;core&quot;</span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: &quot;app-root&quot;,</span><br><span class="line">  templateUrl: &quot;.&#x2F;app.component.html&quot;,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line">export class AppComponent &#123;</span><br><span class="line">  isExpended: boolean &#x3D; false</span><br><span class="line">  toggle() &#123;</span><br><span class="line">    this.isExpended &#x3D; !this.isExpended</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"expandCollapse"</span>, [</span><br><span class="line">  <span class="comment">// 使用 state 方法定义折叠状态元素对应的样式</span></span><br><span class="line">  state(</span><br><span class="line">    <span class="string">"collapsed"</span>,</span><br><span class="line">    style(&#123;</span><br><span class="line">      height: <span class="number">0</span>,</span><br><span class="line">      overflow: <span class="string">"hidden"</span>,</span><br><span class="line">      paddingTop: <span class="number">0</span>,</span><br><span class="line">      paddingBottom: <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// 使用 state 方法定义展开状态元素对应的样式</span></span><br><span class="line">  state(<span class="string">"expanded"</span>, style(&#123; <span class="attr">height</span>: <span class="string">"*"</span>, <span class="attr">overflow</span>: <span class="string">"auto"</span> &#125;)),</span><br><span class="line">  <span class="comment">// 定义展开动画</span></span><br><span class="line">  transition(<span class="string">"collapsed =&gt; expanded"</span>, animate(<span class="string">"400ms ease-out"</span>)),</span><br><span class="line">  <span class="comment">// 定义折叠动画</span></span><br><span class="line">  transition(<span class="string">"expanded =&gt; collapsed"</span>, animate(<span class="string">"400ms ease-in"</span>))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> [@<span class="attr">expandCollapse</span>]=<span class="string">"isExpended ? 'expanded' : 'collapsed'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="45-实现路由动画-12"><a href="#45-实现路由动画-12" class="headerlink" title="45.实现路由动画"></a>45.实现路由动画</h3><ol>
<li><p>为路由添加状态标识，此标识即为路由执行动画时的自定义状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    pathMatch: <span class="string">"full"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"one"</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"two"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"news"</span>,</span><br><span class="line">    component: NewsComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"three"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过路由插座对象获取路由状态标识，并将标识传递给动画的调用者，让动画执行当前要执行的状态是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"routerContainer"</span> [@<span class="attr">routerAnimations</span>]=<span class="string">"prepareRoute(outlet)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> #<span class="attr">outlet</span>=<span class="string">"outlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  prepareRoute(outlet: RouterOutlet) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      outlet &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData.animation</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 routerContainer 设置为相对定位，将它的直接一级子元素设置成绝对定位</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* styles.css */</span></span><br><span class="line"><span class="selector-class">.routerContainer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.routerContainer</span> &gt; * &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"routerAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">"one =&gt; two, one =&gt; three, two =&gt; three"</span>, [</span><br><span class="line">    query(<span class="string">":enter"</span>, style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(-100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">"three =&gt; two, three =&gt; one, two =&gt; one"</span>, [</span><br><span class="line">    query(</span><br><span class="line">      <span class="string">":enter"</span>,</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(-100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    ),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br><span class="line"><span class="string">``</span><span class="string">`     .container &#123;</span></span><br><span class="line"><span class="string">    margin-top: 100px;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  .panel-heading &#123;</span></span><br><span class="line"><span class="string">    cursor: pointer;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&lt;/style&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-root"</span>,</span><br><span class="line">  templateUrl: <span class="string">"./app.component.html"</span>,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  isExpended: boolean = <span class="literal">false</span></span><br><span class="line">  toggle() &#123;</span><br><span class="line">    <span class="keyword">this</span>.isExpended = !<span class="keyword">this</span>.isExpended</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"expandCollapse"</span>, [</span><br><span class="line">  <span class="comment">// 使用 state 方法定义折叠状态元素对应的样式</span></span><br><span class="line">  state(</span><br><span class="line">    <span class="string">"collapsed"</span>,</span><br><span class="line">    style(&#123;</span><br><span class="line">      height: <span class="number">0</span>,</span><br><span class="line">      overflow: <span class="string">"hidden"</span>,</span><br><span class="line">      paddingTop: <span class="number">0</span>,</span><br><span class="line">      paddingBottom: <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// 使用 state 方法定义展开状态元素对应的样式</span></span><br><span class="line">  state(<span class="string">"expanded"</span>, style(&#123; <span class="attr">height</span>: <span class="string">"*"</span>, <span class="attr">overflow</span>: <span class="string">"auto"</span> &#125;)),</span><br><span class="line">  <span class="comment">// 定义展开动画</span></span><br><span class="line">  transition(<span class="string">"collapsed =&gt; expanded"</span>, animate(<span class="string">"400ms ease-out"</span>)),</span><br><span class="line">  <span class="comment">// 定义折叠动画</span></span><br><span class="line">  transition(<span class="string">"expanded =&gt; collapsed"</span>, animate(<span class="string">"400ms ease-in"</span>))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> [@<span class="attr">expandCollapse</span>]=<span class="string">"isExpended ? 'expanded' : 'collapsed'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="45-实现路由动画-13"><a href="#45-实现路由动画-13" class="headerlink" title="45.实现路由动画"></a>45.实现路由动画</h3><ol>
<li><p>为路由添加状态标识，此标识即为路由执行动画时的自定义状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    pathMatch: <span class="string">"full"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"one"</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"two"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"news"</span>,</span><br><span class="line">    component: NewsComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"three"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过路由插座对象获取路由状态标识，并将标识传递给动画的调用者，让动画执行当前要执行的状态是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"routerContainer"</span> [@<span class="attr">routerAnimations</span>]=<span class="string">"prepareRoute(outlet)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> #<span class="attr">outlet</span>=<span class="string">"outlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  prepareRoute(outlet: RouterOutlet) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      outlet &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData.animation</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 routerContainer 设置为相对定位，将它的直接一级子元素设置成绝对定位</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* styles.css */</span></span><br><span class="line"><span class="selector-class">.routerContainer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.routerContainer</span> &gt; * &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"routerAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">"one =&gt; two, one =&gt; three, two =&gt; three"</span>, [</span><br><span class="line">    query(<span class="string">":enter"</span>, style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(-100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">"three =&gt; two, three =&gt; one, two =&gt; one"</span>, [</span><br><span class="line">    query(</span><br><span class="line">      <span class="string">":enter"</span>,</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(-100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    ),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<p>  .container {</p>
<pre><code>margin-top: 100px;</code></pre><p>  }<br>  .panel-heading {</p>
<pre><code>cursor: pointer;</code></pre><p>  }<br></style></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#96;&#96;&#96;javascript</span><br><span class="line">import &#123; Component &#125; from &quot;@angular&#x2F;core&quot;</span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: &quot;app-root&quot;,</span><br><span class="line">  templateUrl: &quot;.&#x2F;app.component.html&quot;,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line">export class AppComponent &#123;</span><br><span class="line">  isExpended: boolean &#x3D; false</span><br><span class="line">  toggle() &#123;</span><br><span class="line">    this.isExpended &#x3D; !this.isExpended</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"expandCollapse"</span>, [</span><br><span class="line">  <span class="comment">// 使用 state 方法定义折叠状态元素对应的样式</span></span><br><span class="line">  state(</span><br><span class="line">    <span class="string">"collapsed"</span>,</span><br><span class="line">    style(&#123;</span><br><span class="line">      height: <span class="number">0</span>,</span><br><span class="line">      overflow: <span class="string">"hidden"</span>,</span><br><span class="line">      paddingTop: <span class="number">0</span>,</span><br><span class="line">      paddingBottom: <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// 使用 state 方法定义展开状态元素对应的样式</span></span><br><span class="line">  state(<span class="string">"expanded"</span>, style(&#123; <span class="attr">height</span>: <span class="string">"*"</span>, <span class="attr">overflow</span>: <span class="string">"auto"</span> &#125;)),</span><br><span class="line">  <span class="comment">// 定义展开动画</span></span><br><span class="line">  transition(<span class="string">"collapsed =&gt; expanded"</span>, animate(<span class="string">"400ms ease-out"</span>)),</span><br><span class="line">  <span class="comment">// 定义折叠动画</span></span><br><span class="line">  transition(<span class="string">"expanded =&gt; collapsed"</span>, animate(<span class="string">"400ms ease-in"</span>))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> [@<span class="attr">expandCollapse</span>]=<span class="string">"isExpended ? 'expanded' : 'collapsed'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="45-实现路由动画-14"><a href="#45-实现路由动画-14" class="headerlink" title="45.实现路由动画"></a>45.实现路由动画</h3><ol>
<li><p>为路由添加状态标识，此标识即为路由执行动画时的自定义状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    pathMatch: <span class="string">"full"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"one"</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"two"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"news"</span>,</span><br><span class="line">    component: NewsComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"three"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过路由插座对象获取路由状态标识，并将标识传递给动画的调用者，让动画执行当前要执行的状态是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"routerContainer"</span> [@<span class="attr">routerAnimations</span>]=<span class="string">"prepareRoute(outlet)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> #<span class="attr">outlet</span>=<span class="string">"outlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  prepareRoute(outlet: RouterOutlet) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      outlet &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData.animation</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 routerContainer 设置为相对定位，将它的直接一级子元素设置成绝对定位</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* styles.css */</span></span><br><span class="line"><span class="selector-class">.routerContainer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.routerContainer</span> &gt; * &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"routerAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">"one =&gt; two, one =&gt; three, two =&gt; three"</span>, [</span><br><span class="line">    query(<span class="string">":enter"</span>, style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(-100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">"three =&gt; two, three =&gt; one, two =&gt; one"</span>, [</span><br><span class="line">    query(</span><br><span class="line">      <span class="string">":enter"</span>,</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(-100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    ),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br><span class="line"><span class="string">``</span><span class="string">`     .container &#123;</span></span><br><span class="line"><span class="string">    margin-top: 100px;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  .panel-heading &#123;</span></span><br><span class="line"><span class="string">    cursor: pointer;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&lt;/style&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">"@angular/core"</span></span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: <span class="string">"app-root"</span>,</span><br><span class="line">  templateUrl: <span class="string">"./app.component.html"</span>,</span><br><span class="line">  styles: []</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  isExpended: boolean = <span class="literal">false</span></span><br><span class="line">  toggle() &#123;</span><br><span class="line">    <span class="keyword">this</span>.isExpended = !<span class="keyword">this</span>.isExpended</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"expandCollapse"</span>, [</span><br><span class="line">  <span class="comment">// 使用 state 方法定义折叠状态元素对应的样式</span></span><br><span class="line">  state(</span><br><span class="line">    <span class="string">"collapsed"</span>,</span><br><span class="line">    style(&#123;</span><br><span class="line">      height: <span class="number">0</span>,</span><br><span class="line">      overflow: <span class="string">"hidden"</span>,</span><br><span class="line">      paddingTop: <span class="number">0</span>,</span><br><span class="line">      paddingBottom: <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// 使用 state 方法定义展开状态元素对应的样式</span></span><br><span class="line">  state(<span class="string">"expanded"</span>, style(&#123; <span class="attr">height</span>: <span class="string">"*"</span>, <span class="attr">overflow</span>: <span class="string">"auto"</span> &#125;)),</span><br><span class="line">  <span class="comment">// 定义展开动画</span></span><br><span class="line">  transition(<span class="string">"collapsed =&gt; expanded"</span>, animate(<span class="string">"400ms ease-out"</span>)),</span><br><span class="line">  <span class="comment">// 定义折叠动画</span></span><br><span class="line">  transition(<span class="string">"expanded =&gt; collapsed"</span>, animate(<span class="string">"400ms ease-in"</span>))</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> [@<span class="attr">expandCollapse</span>]=<span class="string">"isExpended ? 'expanded' : 'collapsed'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="45-实现路由动画-15"><a href="#45-实现路由动画-15" class="headerlink" title="45.实现路由动画"></a>45.实现路由动画</h3><ol>
<li><p>为路由添加状态标识，此标识即为路由执行动画时的自定义状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">""</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    pathMatch: <span class="string">"full"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"one"</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"about"</span>,</span><br><span class="line">    component: AboutComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"two"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">"news"</span>,</span><br><span class="line">    component: NewsComponent,</span><br><span class="line">    data: &#123;</span><br><span class="line">      animation: <span class="string">"three"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过路由插座对象获取路由状态标识，并将标识传递给动画的调用者，让动画执行当前要执行的状态是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"routerContainer"</span> [@<span class="attr">routerAnimations</span>]=<span class="string">"prepareRoute(outlet)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-outlet</span> #<span class="attr">outlet</span>=<span class="string">"outlet"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterOutlet &#125; <span class="keyword">from</span> <span class="string">"@angular/router"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">  prepareRoute(outlet: RouterOutlet) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      outlet &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData &amp;&amp;</span><br><span class="line">      outlet.activatedRouteData.animation</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 routerContainer 设置为相对定位，将它的直接一级子元素设置成绝对定位</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* styles.css */</span></span><br><span class="line"><span class="selector-class">.routerContainer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.routerContainer</span> &gt; * &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">trigger(<span class="string">"routerAnimations"</span>, [</span><br><span class="line">  transition(<span class="string">"one =&gt; two, one =&gt; three, two =&gt; three"</span>, [</span><br><span class="line">    query(<span class="string">":enter"</span>, style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(-100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ]),</span><br><span class="line">  transition(<span class="string">"three =&gt; two, three =&gt; one, two =&gt; one"</span>, [</span><br><span class="line">    query(</span><br><span class="line">      <span class="string">":enter"</span>,</span><br><span class="line">      style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(-100%)"</span>, <span class="attr">opacity</span>: <span class="number">0</span> &#125;)</span><br><span class="line">    ),</span><br><span class="line">    group([</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":enter"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-in"</span>,</span><br><span class="line">          style(&#123; <span class="attr">transform</span>: <span class="string">"translateX(0)"</span>, <span class="attr">opacity</span>: <span class="number">1</span> &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      query(</span><br><span class="line">        <span class="string">":leave"</span>,</span><br><span class="line">        animate(</span><br><span class="line">          <span class="string">"0.4s ease-out"</span>,</span><br><span class="line">          style(&#123;</span><br><span class="line">            transform: <span class="string">"translateX(100%)"</span>,</span><br><span class="line">            opacity: <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">    ])</span><br><span class="line">  ])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/JavaScipt/" rel="tag"># JavaScipt</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/04/11/42/" rel="next" title="学习笔记 ----- 【React 框架原理与实战】React + Redux + Ant Design + TypeScript 实战">
                <i class="fa fa-chevron-left"></i> 学习笔记 ----- 【React 框架原理与实战】React + Redux + Ant Design + TypeScript 实战
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/07/20/44/" rel="prev" title="表达一些观点">
                表达一些观点 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="FY" />
            
              <p class="site-author-name" itemprop="name">FY</p>
              <p class="site-description motion-element" itemprop="description">Just Be Yourself</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">48</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/xuanfeiyu" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Part-4-·-React-框架原理与实战"><span class="nav-number">1.</span> <span class="nav-text">Part 4 · React 框架原理与实战</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#模块六-·-Angular-企业实战开发"><span class="nav-number">1.1.</span> <span class="nav-text">模块六 · Angular 企业实战开发</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#任务一：Angular-基础"><span class="nav-number">1.2.</span> <span class="nav-text">任务一：Angular 基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Angular-框架介绍"><span class="nav-number">1.2.1.</span> <span class="nav-text">1.Angular 框架介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Angular架构-模块"><span class="nav-number">1.2.2.</span> <span class="nav-text">2.Angular架构-模块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-Angular架构-组件"><span class="nav-number">1.2.3.</span> <span class="nav-text">3.Angular架构-组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-Angular架构-服务"><span class="nav-number">1.2.4.</span> <span class="nav-text">4.Angular架构-服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-Angular架构-总结"><span class="nav-number">1.2.5.</span> <span class="nav-text">5.Angular架构-总结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-使用AngularCLI创建应用"><span class="nav-number">1.2.6.</span> <span class="nav-text">6.使用AngularCLI创建应用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-Angular应用默认代码解析及应用启动过程"><span class="nav-number">1.2.7.</span> <span class="nav-text">7.Angular应用默认代码解析及应用启动过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-共享模块"><span class="nav-number">1.2.8.</span> <span class="nav-text">8.共享模块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-数据绑定"><span class="nav-number">1.2.9.</span> <span class="nav-text">9.数据绑定</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-DOM对象的属性绑定和HTML标记的属性绑定"><span class="nav-number">1.2.10.</span> <span class="nav-text">10.DOM对象的属性绑定和HTML标记的属性绑定</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11-动态为元素添加类名及行内样式"><span class="nav-number">1.2.11.</span> <span class="nav-text">11.动态为元素添加类名及行内样式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-事件绑定"><span class="nav-number">1.2.12.</span> <span class="nav-text">12.事件绑定</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-获取原生-DOM-对象"><span class="nav-number">1.2.13.</span> <span class="nav-text">13.获取原生 DOM 对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#14-双向数据绑定"><span class="nav-number">1.2.14.</span> <span class="nav-text">14.双向数据绑定</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-内容投影"><span class="nav-number">1.2.15.</span> <span class="nav-text">15.内容投影</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#16-数据绑定的容错处理"><span class="nav-number">1.2.16.</span> <span class="nav-text">16.数据绑定的容错处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#17-引入全局样式的三种方式"><span class="nav-number">1.2.17.</span> <span class="nav-text">17.引入全局样式的三种方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#18-指令介绍及结构指令ngIf的两种使用方式"><span class="nav-number">1.2.18.</span> <span class="nav-text">18.指令介绍及结构指令ngIf的两种使用方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#19-属性指令hidden"><span class="nav-number">1.2.19.</span> <span class="nav-text">19.属性指令hidden</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#20-结构指令ngFor的使用方式"><span class="nav-number">1.2.20.</span> <span class="nav-text">20.结构指令ngFor的使用方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#21-自定义指令用法"><span class="nav-number">1.2.21.</span> <span class="nav-text">21.自定义指令用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#任务二：Angular-深入学习"><span class="nav-number">1.3.</span> <span class="nav-text">任务二：Angular 深入学习</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-管道"><span class="nav-number">1.3.1.</span> <span class="nav-text">1.管道</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-自定义管道"><span class="nav-number">1.3.2.</span> <span class="nav-text">2.自定义管道</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-组件通讯之向组件内部传递数据"><span class="nav-number">1.3.3.</span> <span class="nav-text">3.组件通讯之向组件内部传递数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-组件通讯之组件向外部传递数据"><span class="nav-number">1.3.4.</span> <span class="nav-text">4.组件通讯之组件向外部传递数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-生命周期函数之挂载阶段"><span class="nav-number">1.3.5.</span> <span class="nav-text">5.生命周期函数之挂载阶段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-生命周期函数之更新阶段"><span class="nav-number">1.3.6.</span> <span class="nav-text">6.生命周期函数之更新阶段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-组件生命周期函数之卸载阶段"><span class="nav-number">1.3.7.</span> <span class="nav-text">7.组件生命周期函数之卸载阶段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-理解什么是依赖注入"><span class="nav-number">1.3.8.</span> <span class="nav-text">8.理解什么是依赖注入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-Injector-的创建和使用"><span class="nav-number">1.3.9.</span> <span class="nav-text">9.Injector 的创建和使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-Provider-的使用"><span class="nav-number">1.3.10.</span> <span class="nav-text">10.Provider 的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11-服务的创建与注入"><span class="nav-number">1.3.11.</span> <span class="nav-text">11.服务的创建与注入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-服务的作用域"><span class="nav-number">1.3.12.</span> <span class="nav-text">12.服务的作用域</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-模板驱动表单用法-删-dirty"><span class="nav-number">1.3.13.</span> <span class="nav-text">13.模板驱动表单用法 (删 dirty)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#11-1-模板驱动"><span class="nav-number">1.3.13.1.</span> <span class="nav-text">11.1 模板驱动</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#11-1-1-概述"><span class="nav-number">1.3.13.1.1.</span> <span class="nav-text">11.1.1 概述</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#11-1-2-快速上手"><span class="nav-number">1.3.13.1.2.</span> <span class="nav-text">11.1.2 快速上手</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#14-模板驱动表单中的表单分组"><span class="nav-number">1.3.14.</span> <span class="nav-text">14.模板驱动表单中的表单分组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-模板驱动型表单的验证方式"><span class="nav-number">1.3.15.</span> <span class="nav-text">15.模板驱动型表单的验证方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#16-模型驱动表单的基本用法"><span class="nav-number">1.3.16.</span> <span class="nav-text">16.模型驱动表单的基本用法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#11-2-2-快速上手"><span class="nav-number">1.3.16.0.1.</span> <span class="nav-text">11.2.2 快速上手</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#18-使用formArray动态创建表单"><span class="nav-number">1.3.17.</span> <span class="nav-text">18.使用formArray动态创建表单</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#19-模型驱动表单内置验证规则的使用"><span class="nav-number">1.3.18.</span> <span class="nav-text">19.模型驱动表单内置验证规则的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#20-模型驱动表单同步类型的自定义验证器（一）"><span class="nav-number">1.3.19.</span> <span class="nav-text">20.模型驱动表单同步类型的自定义验证器（一）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#21-模型驱动表单异步类型的自定义验证器（二）"><span class="nav-number">1.3.20.</span> <span class="nav-text">21.模型驱动表单异步类型的自定义验证器（二）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#22-FormBuild-创建模型表单的快捷方式"><span class="nav-number">1.3.21.</span> <span class="nav-text">22.FormBuild 创建模型表单的快捷方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#23-模型驱动表单练习之复选框"><span class="nav-number">1.3.22.</span> <span class="nav-text">23.模型驱动表单练习之复选框</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#24-模型驱动表单练习之单选框"><span class="nav-number">1.3.23.</span> <span class="nav-text">24.模型驱动表单练习之单选框</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#25-模型驱动表单常用方法介绍"><span class="nav-number">1.3.24.</span> <span class="nav-text">25.模型驱动表单常用方法介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#26-路由的基本使用"><span class="nav-number">1.3.25.</span> <span class="nav-text">26.路由的基本使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#27-路由传递参数的两种方式"><span class="nav-number">1.3.26.</span> <span class="nav-text">27.路由传递参数的两种方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#28-定义子孙级路由"><span class="nav-number">1.3.27.</span> <span class="nav-text">28.定义子孙级路由</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#29-路由命名插座"><span class="nav-number">1.3.28.</span> <span class="nav-text">29.路由命名插座</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#30-导航路由"><span class="nav-number">1.3.29.</span> <span class="nav-text">30.导航路由</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#31-创建路由模块独立路由规则"><span class="nav-number">1.3.30.</span> <span class="nav-text">31.创建路由模块独立路由规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#32-实现路由模块懒加载"><span class="nav-number">1.3.31.</span> <span class="nav-text">32.实现路由模块懒加载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#33-路由守卫-CanActivate"><span class="nav-number">1.3.32.</span> <span class="nav-text">33.路由守卫 CanActivate</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#34-路由守卫-CanActiveChild"><span class="nav-number">1.3.33.</span> <span class="nav-text">34.路由守卫 CanActiveChild</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#35-路由守卫-CanDeactivate"><span class="nav-number">1.3.34.</span> <span class="nav-text">35.路由守卫 CanDeactivate</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#36-路由守卫-Resolve"><span class="nav-number">1.3.35.</span> <span class="nav-text">36.路由守卫 Resolve</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#任务三：Angular-高级"><span class="nav-number">1.4.</span> <span class="nav-text">任务三：Angular 高级</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-RxJS快速入门"><span class="nav-number">1.4.1.</span> <span class="nav-text">1.RxJS快速入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-可观察对象特性介绍"><span class="nav-number">1.4.2.</span> <span class="nav-text">2.可观察对象特性介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-使用Subject构造函数创建可观察对象"><span class="nav-number">1.4.3.</span> <span class="nav-text">3.使用Subject构造函数创建可观察对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-使用BehaviorSubject创建可观察对象"><span class="nav-number">1.4.4.</span> <span class="nav-text">4.使用BehaviorSubject创建可观察对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-使用ReplaySubject创建可观察对象"><span class="nav-number">1.4.5.</span> <span class="nav-text">5.使用ReplaySubject创建可观察对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-数据流、操作符介绍"><span class="nav-number">1.4.6.</span> <span class="nav-text">6.数据流、操作符介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-辅助方法from"><span class="nav-number">1.4.7.</span> <span class="nav-text">7.辅助方法from</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-辅助方法forkJoin"><span class="nav-number">1.4.8.</span> <span class="nav-text">8.辅助方法forkJoin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-辅助方法fromEvent和操作符pluck"><span class="nav-number">1.4.9.</span> <span class="nav-text">9.辅助方法fromEvent和操作符pluck</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-辅助方法interval和操作符switchMap"><span class="nav-number">1.4.10.</span> <span class="nav-text">10.辅助方法interval和操作符switchMap</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11-操作符take、takeWhile、takeUntil"><span class="nav-number">1.4.11.</span> <span class="nav-text">11.操作符take、takeWhile、takeUntil</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-操作符节流和防抖"><span class="nav-number">1.4.12.</span> <span class="nav-text">12.操作符节流和防抖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-辅助方法of和操作符distinctUntilChanged"><span class="nav-number">1.4.13.</span> <span class="nav-text">13.辅助方法of和操作符distinctUntilChanged</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#14-RxJS案例之元素拖拽"><span class="nav-number">1.4.14.</span> <span class="nav-text">14.RxJS案例之元素拖拽</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-搜索案例"><span class="nav-number">1.4.15.</span> <span class="nav-text">15.搜索案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#16-案例之串联请求的发送"><span class="nav-number">1.4.16.</span> <span class="nav-text">16.案例之串联请求的发送</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#17-HttpClientModule的基本使用"><span class="nav-number">1.4.17.</span> <span class="nav-text">17.HttpClientModule的基本使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-快速开始"><span class="nav-number">1.4.17.1.</span> <span class="nav-text">1. 快速开始</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-请求方法"><span class="nav-number">1.4.17.2.</span> <span class="nav-text">2. 请求方法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#18-HttpParams类的使用"><span class="nav-number">1.4.18.</span> <span class="nav-text">18.HttpParams类的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#19-HttpHeaders类的使用"><span class="nav-number">1.4.19.</span> <span class="nav-text">19.HttpHeaders类的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#20-设置响应体"><span class="nav-number">1.4.20.</span> <span class="nav-text">20.设置响应体</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#21-拦截器的使用-一"><span class="nav-number">1.4.21.</span> <span class="nav-text">21.拦截器的使用(一)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#22-拦截器的使用-二"><span class="nav-number">1.4.22.</span> <span class="nav-text">22.拦截器的使用(二)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#23-配置AngularProxy"><span class="nav-number">1.4.23.</span> <span class="nav-text">23.配置AngularProxy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#24-NgRx概述"><span class="nav-number">1.4.24.</span> <span class="nav-text">24.NgRx概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#25-NgRx基本使用"><span class="nav-number">1.4.25.</span> <span class="nav-text">25.NgRx基本使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#26-selector的用法"><span class="nav-number">1.4.26.</span> <span class="nav-text">26.selector的用法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#27-Action传递参数"><span class="nav-number">1.4.27.</span> <span class="nav-text">27.Action传递参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#28-metaReducer机制介绍"><span class="nav-number">1.4.28.</span> <span class="nav-text">28.metaReducer机制介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#29-使用Effect接收Action执行副作用"><span class="nav-number">1.4.29.</span> <span class="nav-text">29.使用Effect接收Action执行副作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#30-ngrx案例todo之添加任务"><span class="nav-number">1.4.30.</span> <span class="nav-text">30.ngrx案例todo之添加任务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#31-案例todo之展示任务"><span class="nav-number">1.4.31.</span> <span class="nav-text">31.案例todo之展示任务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#32-案例todo之删除任务"><span class="nav-number">1.4.32.</span> <span class="nav-text">32.案例todo之删除任务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#33-在todo案例中加入Entity简化实体操作"><span class="nav-number">1.4.33.</span> <span class="nav-text">33.在todo案例中加入Entity简化实体操作</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#15-6-3-实例方法"><span class="nav-number">1.4.33.0.1.</span> <span class="nav-text">15.6.3 实例方法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#15-6-4-选择器"><span class="nav-number">1.4.33.0.2.</span> <span class="nav-text">15.6.4 选择器</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#34-将路由状态同步到Store中"><span class="nav-number">1.4.34.</span> <span class="nav-text">34.将路由状态同步到Store中</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#35-和状态相关的概念"><span class="nav-number">1.4.35.</span> <span class="nav-text">35.和状态相关的概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#37-创建动画时的两个注意事项"><span class="nav-number">1.4.36.</span> <span class="nav-text">37.创建动画时的两个注意事项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#38-定义关键帧动画"><span class="nav-number">1.4.37.</span> <span class="nav-text">38.定义关键帧动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#39-指定动画的回调函数"><span class="nav-number">1.4.38.</span> <span class="nav-text">39.指定动画的回调函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#40-创建可重用动画"><span class="nav-number">1.4.39.</span> <span class="nav-text">40.创建可重用动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#41-query方法的使用"><span class="nav-number">1.4.40.</span> <span class="nav-text">41.query方法的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#42-group方法的使用"><span class="nav-number">1.4.41.</span> <span class="nav-text">42.group方法的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#43-使用stagger方法实现交错动画"><span class="nav-number">1.4.42.</span> <span class="nav-text">43.使用stagger方法实现交错动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#44-创建自定义状态动画"><span class="nav-number">1.4.43.</span> <span class="nav-text">44.创建自定义状态动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-实现路由动画"><span class="nav-number">1.4.44.</span> <span class="nav-text">45.实现路由动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-实现路由动画-1"><span class="nav-number">1.4.45.</span> <span class="nav-text">45.实现路由动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-实现路由动画-2"><span class="nav-number">1.4.46.</span> <span class="nav-text">45.实现路由动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-实现路由动画-3"><span class="nav-number">1.4.47.</span> <span class="nav-text">45.实现路由动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-实现路由动画-4"><span class="nav-number">1.4.48.</span> <span class="nav-text">45.实现路由动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-实现路由动画-5"><span class="nav-number">1.4.49.</span> <span class="nav-text">45.实现路由动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-实现路由动画-6"><span class="nav-number">1.4.50.</span> <span class="nav-text">45.实现路由动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-实现路由动画-7"><span class="nav-number">1.4.51.</span> <span class="nav-text">45.实现路由动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-搜索案例-1"><span class="nav-number">1.4.52.</span> <span class="nav-text">15.搜索案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#16-案例之串联请求的发送-1"><span class="nav-number">1.4.53.</span> <span class="nav-text">16.案例之串联请求的发送</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#17-HttpClientModule的基本使用-1"><span class="nav-number">1.4.54.</span> <span class="nav-text">17.HttpClientModule的基本使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-快速开始-1"><span class="nav-number">1.4.54.1.</span> <span class="nav-text">1. 快速开始</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-请求方法-1"><span class="nav-number">1.4.54.2.</span> <span class="nav-text">2. 请求方法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#18-HttpParams类的使用-1"><span class="nav-number">1.4.55.</span> <span class="nav-text">18.HttpParams类的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#19-HttpHeaders类的使用-1"><span class="nav-number">1.4.56.</span> <span class="nav-text">19.HttpHeaders类的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#20-设置响应体-1"><span class="nav-number">1.4.57.</span> <span class="nav-text">20.设置响应体</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#21-拦截器的使用-一-1"><span class="nav-number">1.4.58.</span> <span class="nav-text">21.拦截器的使用(一)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#22-拦截器的使用-二-1"><span class="nav-number">1.4.59.</span> <span class="nav-text">22.拦截器的使用(二)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#23-配置AngularProxy-1"><span class="nav-number">1.4.60.</span> <span class="nav-text">23.配置AngularProxy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#24-NgRx概述-1"><span class="nav-number">1.4.61.</span> <span class="nav-text">24.NgRx概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#25-NgRx基本使用-1"><span class="nav-number">1.4.62.</span> <span class="nav-text">25.NgRx基本使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#26-selector的用法-1"><span class="nav-number">1.4.63.</span> <span class="nav-text">26.selector的用法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#27-Action传递参数-1"><span class="nav-number">1.4.64.</span> <span class="nav-text">27.Action传递参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#28-metaReducer机制介绍-1"><span class="nav-number">1.4.65.</span> <span class="nav-text">28.metaReducer机制介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#29-使用Effect接收Action执行副作用-1"><span class="nav-number">1.4.66.</span> <span class="nav-text">29.使用Effect接收Action执行副作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#30-ngrx案例todo之添加任务-1"><span class="nav-number">1.4.67.</span> <span class="nav-text">30.ngrx案例todo之添加任务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#31-案例todo之展示任务-1"><span class="nav-number">1.4.68.</span> <span class="nav-text">31.案例todo之展示任务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#32-案例todo之删除任务-1"><span class="nav-number">1.4.69.</span> <span class="nav-text">32.案例todo之删除任务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#33-在todo案例中加入Entity简化实体操作-1"><span class="nav-number">1.4.70.</span> <span class="nav-text">33.在todo案例中加入Entity简化实体操作</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#15-6-3-实例方法-1"><span class="nav-number">1.4.70.0.1.</span> <span class="nav-text">15.6.3 实例方法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#15-6-4-选择器-1"><span class="nav-number">1.4.70.0.2.</span> <span class="nav-text">15.6.4 选择器</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#34-将路由状态同步到Store中-1"><span class="nav-number">1.4.71.</span> <span class="nav-text">34.将路由状态同步到Store中</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#35-和状态相关的概念-1"><span class="nav-number">1.4.72.</span> <span class="nav-text">35.和状态相关的概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#37-创建动画时的两个注意事项-1"><span class="nav-number">1.4.73.</span> <span class="nav-text">37.创建动画时的两个注意事项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#38-定义关键帧动画-1"><span class="nav-number">1.4.74.</span> <span class="nav-text">38.定义关键帧动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#39-指定动画的回调函数-1"><span class="nav-number">1.4.75.</span> <span class="nav-text">39.指定动画的回调函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#40-创建可重用动画-1"><span class="nav-number">1.4.76.</span> <span class="nav-text">40.创建可重用动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#41-query方法的使用-1"><span class="nav-number">1.4.77.</span> <span class="nav-text">41.query方法的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#42-group方法的使用-1"><span class="nav-number">1.4.78.</span> <span class="nav-text">42.group方法的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#43-使用stagger方法实现交错动画-1"><span class="nav-number">1.4.79.</span> <span class="nav-text">43.使用stagger方法实现交错动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#44-创建自定义状态动画-1"><span class="nav-number">1.4.80.</span> <span class="nav-text">44.创建自定义状态动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-实现路由动画-8"><span class="nav-number">1.4.81.</span> <span class="nav-text">45.实现路由动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-实现路由动画-9"><span class="nav-number">1.4.82.</span> <span class="nav-text">45.实现路由动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-实现路由动画-10"><span class="nav-number">1.4.83.</span> <span class="nav-text">45.实现路由动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-实现路由动画-11"><span class="nav-number">1.4.84.</span> <span class="nav-text">45.实现路由动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-实现路由动画-12"><span class="nav-number">1.4.85.</span> <span class="nav-text">45.实现路由动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-实现路由动画-13"><span class="nav-number">1.4.86.</span> <span class="nav-text">45.实现路由动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-实现路由动画-14"><span class="nav-number">1.4.87.</span> <span class="nav-text">45.实现路由动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#45-实现路由动画-15"><span class="nav-number">1.4.88.</span> <span class="nav-text">45.实现路由动画</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">FY</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
